<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Jennifer Luz Lopes">

<title>Modelagem para seleção de genótipos superiores</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="modelagem_experimental_explicacoes_files/libs/clipboard/clipboard.min.js"></script>
<script src="modelagem_experimental_explicacoes_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="modelagem_experimental_explicacoes_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="modelagem_experimental_explicacoes_files/libs/quarto-html/popper.min.js"></script>
<script src="modelagem_experimental_explicacoes_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="modelagem_experimental_explicacoes_files/libs/quarto-html/anchor.min.js"></script>
<link href="modelagem_experimental_explicacoes_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="modelagem_experimental_explicacoes_files/libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="modelagem_experimental_explicacoes_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="modelagem_experimental_explicacoes_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="modelagem_experimental_explicacoes_files/libs/bootstrap/bootstrap-6e5ff12f349f7d7ee99023e5a7f49be9.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<style>html{ scroll-behavior: smooth; }</style>
<link href="modelagem_experimental_explicacoes_files/libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">

<script src="modelagem_experimental_explicacoes_files/libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>

<link href="modelagem_experimental_explicacoes_files/libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">

<script src="modelagem_experimental_explicacoes_files/libs/datatables-binding-0.33/datatables.js"></script>

<script src="modelagem_experimental_explicacoes_files/libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>

<link href="modelagem_experimental_explicacoes_files/libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">

<link href="modelagem_experimental_explicacoes_files/libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">

<script src="modelagem_experimental_explicacoes_files/libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>

<link href="modelagem_experimental_explicacoes_files/libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">

<script src="modelagem_experimental_explicacoes_files/libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>


  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="estilo.css">
</head>

<body class="quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-full">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Sumário</h2>
   
  <ul>
  <li><a href="#instalação-e-carregamento-dos-pacotes" id="toc-instalação-e-carregamento-dos-pacotes" class="nav-link active" data-scroll-target="#instalação-e-carregamento-dos-pacotes"><span class="header-section-number">1</span> Instalação e carregamento dos pacotes</a></li>
  <li><a href="#como-gerar-um-token-de-acesso-pessoal-no-github" id="toc-como-gerar-um-token-de-acesso-pessoal-no-github" class="nav-link" data-scroll-target="#como-gerar-um-token-de-acesso-pessoal-no-github"><span class="header-section-number">2</span> Como gerar um token de acesso pessoal no GitHub</a></li>
  <li><a href="#função-coleta_dados_github" id="toc-função-coleta_dados_github" class="nav-link" data-scroll-target="#função-coleta_dados_github"><span class="header-section-number">3</span> Função coleta_dados_github()</a></li>
  <li><a href="#importação-dos-dados-via-api-do-github" id="toc-importação-dos-dados-via-api-do-github" class="nav-link" data-scroll-target="#importação-dos-dados-via-api-do-github"><span class="header-section-number">4</span> Importação dos dados via API do GitHub</a>
  <ul class="collapse">
  <li><a href="#para-repositórios-públicos" id="toc-para-repositórios-públicos" class="nav-link" data-scroll-target="#para-repositórios-públicos"><span class="header-section-number">4.1</span> Para repositórios públicos</a></li>
  </ul></li>
  <li><a href="#delineamento-alpha-lattice" id="toc-delineamento-alpha-lattice" class="nav-link" data-scroll-target="#delineamento-alpha-lattice"><span class="header-section-number">5</span> <strong>Delineamento Alpha-Lattice</strong></a></li>
  <li><a href="#sobre-os-dados-experimentais---simulados" id="toc-sobre-os-dados-experimentais---simulados" class="nav-link" data-scroll-target="#sobre-os-dados-experimentais---simulados"><span class="header-section-number">6</span> Sobre os dados experimentais - Simulados</a></li>
  <li><a href="#ajuste-das-variáveis" id="toc-ajuste-das-variáveis" class="nav-link" data-scroll-target="#ajuste-das-variáveis"><span class="header-section-number">7</span> Ajuste das variáveis</a></li>
  <li><a href="#sobre-o-experimento" id="toc-sobre-o-experimento" class="nav-link" data-scroll-target="#sobre-o-experimento"><span class="header-section-number">8</span> Sobre o experimento</a></li>
  <li><a href="#croqui-experimental" id="toc-croqui-experimental" class="nav-link" data-scroll-target="#croqui-experimental"><span class="header-section-number">9</span> Croqui experimental</a></li>
  <li><a href="#análise-descritiva" id="toc-análise-descritiva" class="nav-link" data-scroll-target="#análise-descritiva"><span class="header-section-number">10</span> Análise descritiva</a></li>
  <li><a href="#modelagem-estatística" id="toc-modelagem-estatística" class="nav-link" data-scroll-target="#modelagem-estatística"><span class="header-section-number">11</span> Modelagem estatística</a>
  <ul class="collapse">
  <li><a href="#modelo-2-genótipo-como-efeito-aleatório---blups" id="toc-modelo-2-genótipo-como-efeito-aleatório---blups" class="nav-link" data-scroll-target="#modelo-2-genótipo-como-efeito-aleatório---blups"><span class="header-section-number">11.1</span> Modelo 2: Genótipo como efeito aleatório - BLUPs</a></li>
  </ul></li>
  <li><a href="#estimativas-dos-blues-e-blups" id="toc-estimativas-dos-blues-e-blups" class="nav-link" data-scroll-target="#estimativas-dos-blues-e-blups"><span class="header-section-number">12</span> Estimativas dos BLUEs E BLUPs</a>
  <ul class="collapse">
  <li><a href="#estimativas-dos-blues---efeito-fixo" id="toc-estimativas-dos-blues---efeito-fixo" class="nav-link" data-scroll-target="#estimativas-dos-blues---efeito-fixo"><span class="header-section-number">12.1</span> Estimativas dos BLUEs - Efeito fixo</a></li>
  <li><a href="#estimativas-dos-blups---efeito-aleatório" id="toc-estimativas-dos-blups---efeito-aleatório" class="nav-link" data-scroll-target="#estimativas-dos-blups---efeito-aleatório"><span class="header-section-number">12.2</span> Estimativas dos BLUPs - Efeito aleatório</a></li>
  </ul></li>
  <li><a href="#herdabilidade" id="toc-herdabilidade" class="nav-link" data-scroll-target="#herdabilidade"><span class="header-section-number">13</span> Herdabilidade</a></li>
  <li><a href="#agrupamento-hierárquico---upgma" id="toc-agrupamento-hierárquico---upgma" class="nav-link" data-scroll-target="#agrupamento-hierárquico---upgma"><span class="header-section-number">14</span> Agrupamento hierárquico - UPGMA</a>
  <ul class="collapse">
  <li><a href="#correlação-cofenética" id="toc-correlação-cofenética" class="nav-link" data-scroll-target="#correlação-cofenética"><span class="header-section-number">14.1</span> Correlação cofenética</a></li>
  </ul></li>
  <li><a href="#considerações-finais" id="toc-considerações-finais" class="nav-link" data-scroll-target="#considerações-finais"><span class="header-section-number">15</span> Considerações finais</a></li>
  </ul>
</nav>
</div>
<main class="content column-page-left" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Modelagem para seleção de genótipos superiores</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
<p class="subtitle lead">Delineamento Experimental Alpha-Lattice</p>
</div>



<div class="quarto-title-meta column-page-left">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Jennifer Luz Lopes </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Mensagem inicial
</div>
</div>
<div class="callout-body-container callout-body">
<p>Este projeto utiliza dados experimentais simulados, desenvolvidos com o objetivo de reproduzir fielmente a complexidade de um ensaio real de melhoramento genético.<br>
</p>
<p>Foram aplicadas técnicas de estatística experimental, modelagem mista (BLUP/REML) e análises multivariadas para identificar genótipos superiores com base em critérios de desempenho.<br>
</p>
<p>A simulação permitiu validar todo o fluxo de análise, do delineamento ao ranqueamento final, consolidando um cenário realista de tomada de decisão em programas de melhoramento.</p>
</div>
</div>
<section id="instalação-e-carregamento-dos-pacotes" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="instalação-e-carregamento-dos-pacotes"><span class="header-section-number">1</span> Instalação e carregamento dos pacotes</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">"pacman"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) <span class="fu">install.packages</span>(<span class="st">"pacman"</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  broom,          <span class="co"># Organiza resultados de modelos em formato tidy</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  broom.mixed,    <span class="co"># Versão do broom para modelos mistos</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  desplot,        <span class="co"># Visualiza delineamentos experimentais</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  emmeans,        <span class="co"># Médias ajustadas e comparações múltiplas</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  ggpubr,         <span class="co"># Gráficos estatísticos prontos com ggplot2</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  lme4,           <span class="co"># Modelos lineares mistos</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  lmerTest,       <span class="co"># P-valores para modelos lmer()</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  multcomp,       <span class="co"># Testes múltiplos (Tukey, Dunnett)</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  multcompView,   <span class="co"># Letras de agrupamento (a, b, c)</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  plotly,         <span class="co"># Gráficos interativos</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  tidyverse,      <span class="co"># Conjunto para manipulação e visualização de dados</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>  writexl,        <span class="co"># Exporta dados para Excel</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  metan,          <span class="co"># Análises agronômicas e genéticas (BLUP, MGIDI)</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  httr2,          <span class="co"># Consumo de APIs modernas</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>  readr,          <span class="co"># Leitura rápida de CSV e textos</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>  readxl,         <span class="co"># Importação de planilhas Excel</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>  base64enc,       <span class="co"># Codificação Base64 (arquivos e APIs)</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>  viridis,</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>  DT, </span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>  tidyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="como-gerar-um-token-de-acesso-pessoal-no-github" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="como-gerar-um-token-de-acesso-pessoal-no-github"><span class="header-section-number">2</span> Como gerar um token de acesso pessoal no GitHub</h2>
<p>O Personal Access Token (PAT) é uma credencial que substitui sua senha ao usar a API, CLI ou comandos Git via HTTPS. Ele garante autenticação segura e controle sobre o que pode ser acessado.</p>
<p><strong>Etapas para gerar o token:</strong></p>
<ol type="1">
<li><p>Acesse sua conta GitHub. Entre em github.com com seu usuário e senha.</p></li>
<li><p>Abra as configurações do desenvolvedor. No canto superior direito, clique na sua foto de perfil - Settings - Developer Settings - Personal access tokens.</p></li>
<li><p>Crie um novo token. Clique em Generate new token (ou Create new token (fine-grained), se disponível).</p></li>
<li><p>Defina as informações básicas.</p></li>
<li><p>Dê um nome descritivo ao token (ex: token_api_portfolio);</p></li>
<li><p>Escolha uma data de expiração adequada (por exemplo, 90 dias);</p></li>
<li><p>Selecione apenas os escopos (permissões) necessários - por exemplo, marque repo para acesso a repositórios.</p></li>
<li><p>Gere o token. Clique em Generate token para criar. Importante: copie o valor imediatamente ele não será mostrado novamente.</p></li>
<li><p>Armazene o token com segurança. Guarde em local seguro, por exemplo, em um gerenciador de senhas ou em variáveis de ambiente como <code>Sys.setenv(GITHUB_TOKEN="...")</code>.</p></li>
</ol>
<p><strong>Use o token em suas integrações. Esse token pode ser usado para:</strong></p>
<ul>
<li><p>Autenticação em APIs, ex: <strong><code>httr2::req_auth_bearer_token()</code></strong>;</p></li>
<li><p>Operações Git via HTTPS (push/pull);</p></li>
<li><p>Execuções automatizadas em pipelines e scripts.</p></li>
</ul>
</section>
<section id="função-coleta_dados_github" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="função-coleta_dados_github"><span class="header-section-number">3</span> Função coleta_dados_github()</h2>
<p>Criei a função <strong><code>coleta_dados_github()</code></strong> para automatizar a leitura de arquivos diretamente de um repositório GitHub, sem necessidade de download manual. Ela utiliza o pacote <strong><code>httr2</code></strong><a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> para realizar a requisição HTTP à <strong>API do GitHub</strong><a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>, montando a URL de acesso a partir do nome do repositório, caminho do arquivo e branch especificados.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Importante
</div>
</div>
<div class="callout-body-container callout-body">
<p>Você precisa acessar o GitHub e gerar um <strong>Token de Acesso Pessoal (PAT -Personal Access Token)</strong>.</p>
</div>
</div>
<p>Caso o repositório exija autenticação, o token pessoal do GitHub é aplicado automaticamente via <strong><code>req_auth_bearer_token()</code></strong>.</p>
<p>Após a conexão, a função valida o status da resposta e decodifica o conteúdo retornado, que vem em formato <strong><code>Base64</code></strong> padrão usado pela API para transmitir arquivos binários.</p>
<p>O arquivo é temporariamente salvo e, em seguida, lido conforme sua extensão: arquivos .csv são importados com <strong><code>readr::read_csv()</code></strong> e planilhas .xlsx com <strong><code>readxl::read_excel()</code></strong>.</p>
<p>Ao final, a função retorna um data frame limpo e pronto para análise, exibindo mensagens informativas sobre o número de linhas e colunas carregadas. Essa estrutura modular permite integração direta entre o GitHub e o pipeline experimental.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>coleta_dados_github <span class="ot">&lt;-</span> <span class="cf">function</span>(repo, path, <span class="at">branch =</span> <span class="st">"main"</span>, <span class="at">token =</span> <span class="fu">Sys.getenv</span>(<span class="st">"GITHUB_TOKEN"</span>)) {</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(httr2)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(readr)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(readxl)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(base64enc)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(glue)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Mensagem de debug</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">message</span>(<span class="fu">glue</span>(<span class="st">"Conectando ao repositório {repo}, arquivo: {path}"</span>))</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Monta a URL da API</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  url <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"https://api.github.com/repos/"</span>, repo, <span class="st">"/contents/"</span>, path, <span class="st">"?ref="</span>, branch)</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Requisição</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>  req <span class="ot">&lt;-</span> <span class="fu">request</span>(url)</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">nzchar</span>(token)) {</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>    req <span class="ot">&lt;-</span> <span class="fu">req_auth_bearer_token</span>(req, token)</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Executa a requisição</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>  resp <span class="ot">&lt;-</span> <span class="fu">req_perform</span>(req)</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Se falhar, mostra status</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">resp_status</span>(resp) <span class="sc">&gt;=</span> <span class="dv">300</span>) {</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="fu">glue</span>(<span class="st">"Falha ao acessar GitHub: HTTP {resp_status(resp)}. Verifique o token, repo e caminho."</span>))</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>  obj <span class="ot">&lt;-</span> <span class="fu">resp_body_json</span>(resp)</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.null</span>(obj<span class="sc">$</span>content)) {</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">"Conteúdo vazio verifique se o caminho aponta para um arquivo, não para uma pasta."</span>)</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Decodifica o arquivo em base64</span></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>  raw <span class="ot">&lt;-</span> <span class="fu">base64decode</span>(obj<span class="sc">$</span>content)</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>  ext <span class="ot">&lt;-</span> tools<span class="sc">::</span><span class="fu">file_ext</span>(path)</span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>  tmp <span class="ot">&lt;-</span> <span class="fu">tempfile</span>(<span class="at">fileext =</span> <span class="fu">paste0</span>(<span class="st">"."</span>, ext))</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">writeBin</span>(raw, tmp)</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Lê conforme o tipo</span></span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (ext <span class="sc">==</span> <span class="st">"csv"</span>) {</span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>    dados <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(tmp, <span class="at">show_col_types =</span> <span class="cn">FALSE</span>)</span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (ext <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"xlsx"</span>, <span class="st">"xls"</span>)) {</span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>    dados <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(tmp)</span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">"Formato não suportado: use .csv, .xlsx ou .xls"</span>)</span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">message</span>(<span class="fu">glue</span>(<span class="st">"Dados carregados com sucesso ({nrow(dados)} linhas, {ncol(dados)} colunas)."</span>))</span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(dados)</span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="importação-dos-dados-via-api-do-github" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="importação-dos-dados-via-api-do-github"><span class="header-section-number">4</span> Importação dos dados via API do GitHub</h2>
<section id="para-repositórios-públicos" class="level3" data-number="4.1">
<h3 data-number="4.1" class="anchored" data-anchor-id="para-repositórios-públicos"><span class="header-section-number">4.1</span> Para repositórios públicos</h3>
<p>Nesta etapa, foi realizada a importação automatizada dos dados diretamente do GitHub, garantindo reprodutibilidade e versionamento do experimento. A função <strong><code>coleta_dados_github()</code></strong> foi desenvolvida previamente e armazenada no <strong>diretório funcoes/</strong>, sendo responsável por estabelecer a conexão com o repositório público, localizar o arquivo especificado e fazer o download temporário antes de ler o conteúdo com o pacote <strong><code>readxl</code></strong>.</p>
<p>Essa abordagem elimina a necessidade de armazenar arquivos localmente e permite atualizar os dados sempre que o repositório for modificado. Em seguida, a função <strong><code>glimpse()</code></strong> é utilizada para inspecionar rapidamente a estrutura do dataset, verificando nomes, tipos e exemplos das variáveis que serão analisadas nos próximos blocos.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Carrega a função de coleta de dados (salva em funcoes/coleta_dados_github.R)</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"meu_projeto/funcoes/coleta_dados_github.R"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Coleta dos dados direto do repositório público</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>dados <span class="ot">&lt;-</span> <span class="fu">coleta_dados_github</span>(</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">repo =</span> <span class="st">"JenniferLopes/portfolio_experimentacao_agricola"</span>,</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">path =</span> <span class="st">"meu_projeto/dados/alpha_lattice.xlsx"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualiza estrutura do dataset</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(dados)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 72
Columns: 6
$ rep       &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …
$ inc.bloco &lt;dbl&gt; 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 4, 5, 5, 5, 5, …
$ gen       &lt;chr&gt; "G11", "G04", "G05", "G22", "G21", "G10", "G20", "G02", "G23…
$ prod      &lt;dbl&gt; 41172, 44461, 58757, 45784, 4654, 41736, 40141, 4335, 42323,…
$ row       &lt;dbl&gt; 4, 3, 2, 1, 4, 3, 2, 1, 4, 3, 2, 1, 4, 3, 2, 1, 4, 3, 2, 1, …
$ col       &lt;dbl&gt; 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 4, 5, 5, 5, 5, …</code></pre>
</div>
</div>
</section>
</section>
<section id="delineamento-alpha-lattice" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="delineamento-alpha-lattice"><span class="header-section-number">5</span> <strong>Delineamento Alpha-Lattice</strong></h2>
<p>O delineamento <strong><code>Alpha-Lattice</code></strong><a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a> é uma variação do látice incompleto balanceado desenvolvido para experimentos com grande número de tratamentos (genótipos) e número limitado de repetições.</p>
<ul>
<li><p>Ele organiza os tratamentos em blocos incompletos de tamanho fixo, distribuídos aleatoriamente dentro de cada repetição, de forma que cada par de tratamentos ocorra juntos em um número balanceado (ou quase balanceado) de blocos.</p></li>
<li><p>Essa estrutura reduz a variabilidade dentro dos blocos e aumenta a precisão experimental, especialmente quando há heterogeneidade no campo.</p></li>
</ul>
<p>O modelo estatístico para o delineamento Alpha-Lattice inclui efeitos de tratamentos (genótipos), repetições e blocos dentro das repetições, permitindo ajustar as diferenças ambientais por meio de modelos lineares mistos (REML/BLUP).</p>
<p>Por isso, ele é amplamente utilizado em programas de melhoramento genético de plantas, onde se avaliam dezenas ou centenas de linhagens experimentais. Além de aumentar a eficiência da comparação entre genótipos, o delineamento Alpha-Lattice viabiliza o uso de componentes de variância e herdabilidade, fornecendo base sólida para a seleção genotípica mais precisa.</p>
</section>
<section id="sobre-os-dados-experimentais---simulados" class="level2" data-number="6">
<h2 data-number="6" class="anchored" data-anchor-id="sobre-os-dados-experimentais---simulados"><span class="header-section-number">6</span> Sobre os dados experimentais - Simulados</h2>
<p>Os dados analisados neste experimento correspondem a um ensaio de avaliação de genótipos conduzido sob delineamento em blocos incompletos do tipo Alpha-Lattice, com o objetivo de estimar parâmetros genéticos e identificar materiais superiores em termos de produtividade.</p>
<ul>
<li><p>O conjunto de dados contém informações de:</p></li>
<li><p>produção por parcela (prod);</p></li>
<li><p>genótipos avaliados (gen);</p></li>
<li><p>repetições (rep);</p></li>
<li><p>blocos incompletos (inc.bloco);</p></li>
<li><p>Além das coordenadas de campo utilizadas para a construção do croqui experimental, col (clouna) e row (linha);</p></li>
<li><p>Cada repetição foi subdividida em blocos menores, chamados de subblocos para reduzir o efeito da variabilidade ambiental e aumentar a precisão das comparações entre genótipos.</p></li>
</ul>
</section>
<section id="ajuste-das-variáveis" class="level2" data-number="7">
<h2 data-number="7" class="anchored" data-anchor-id="ajuste-das-variáveis"><span class="header-section-number">7</span> Ajuste das variáveis</h2>
<p>Neste passo, realizei o ajuste das variáveis categóricas do conjunto de dados para garantir que o modelo estatístico reconheça corretamente os fatores experimentais.</p>
<ul>
<li><p>As colunas correspondentes a genótipos (gen), repetições (rep) e blocos incompletos (inc.bloco) são convertidas para o tipo factor, utilizando a função <strong><code>mutate()</code></strong> do <strong><code>dplyr</code></strong>.</p></li>
<li><p>Essa conversão é essencial em análises de experimentação agrícola, pois esses efeitos representam níveis de tratamento e estruturas hierárquicas que devem ser tratadas como variáveis qualitativas, e não numéricas.</p></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>dados <span class="ot">&lt;-</span> dados <span class="sc">%&gt;%</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">gen =</span> <span class="fu">as.factor</span>(gen),</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">rep =</span> <span class="fu">as.factor</span>(rep),</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">inc.bloco =</span> <span class="fu">as.factor</span>(inc.bloco))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="sobre-o-experimento" class="level2" data-number="8">
<h2 data-number="8" class="anchored" data-anchor-id="sobre-o-experimento"><span class="header-section-number">8</span> Sobre o experimento</h2>
<p>Foram avaliados, 24 genótipos, em 3 repetições, com 6 blocos incompletos.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>resumo <span class="ot">&lt;-</span> dados <span class="sc">%&gt;%</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_genotipos   =</span> <span class="fu">n_distinct</span>(gen),</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_repeticoes  =</span> <span class="fu">n_distinct</span>(rep),</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_blocos_inc  =</span> <span class="fu">n_distinct</span>(inc.bloco))</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(resumo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 3
  n_genotipos n_repeticoes n_blocos_inc
        &lt;int&gt;        &lt;int&gt;        &lt;int&gt;
1          24            3            6</code></pre>
</div>
</div>
</section>
<section id="croqui-experimental" class="level2" data-number="9">
<h2 data-number="9" class="anchored" data-anchor-id="croqui-experimental"><span class="header-section-number">9</span> Croqui experimental</h2>
<p>O croqui do experimento, foi representado graficamente no delineamento alpha-lattice. Para isso, utilizei o pacote <strong><code>ggplot2</code></strong>, mapeando as coordenadas de campo onde cada célula <strong><code>geom_tile()</code></strong> representa uma unidade experimental e é identificada pelo respectivo genótipo (label = gen).</p>
<ul>
<li>A coloração das parcelas foi definida pela variável inc.bloco, permitindo destacar visualmente os blocos incompletos. Em seguida, apliquei <strong><code>facet_wrap(~ rep)</code></strong> para separar as repetições em painéis distintos, o que facilita a inspeção da uniformidade entre blocos dentro de cada repetição.</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>dados <span class="ot">&lt;-</span> dados <span class="sc">%&gt;%</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">inc.bloco =</span> <span class="fu">as.factor</span>(inc.bloco))</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>croqui <span class="ot">&lt;-</span> dados <span class="sc">%&gt;%</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> col, <span class="at">y =</span> row, <span class="at">fill =</span> inc.bloco)) <span class="sc">+</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> gen), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">"C"</span>, <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> rep, <span class="at">scales =</span> <span class="st">"free_x"</span>) <span class="sc">+</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Croqui de Campo - Portfólio Experimental"</span>,</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Colunas"</span>,</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Linhas"</span>,</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Bloco incompleto"</span>, </span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"Jennifer Lopes."</span>)</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(croqui)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelagem_experimental_explicacoes_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="análise-descritiva" class="level2" data-number="10">
<h2 data-number="10" class="anchored" data-anchor-id="análise-descritiva"><span class="header-section-number">10</span> Análise descritiva</h2>
<p>Foi realizada à análise descritiva da variável produtividade (prod), utilizando a função <strong><code>desc_stat()</code></strong> do pacote <strong><code>metan</code></strong><a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>.</p>
<ul>
<li><p>Essa função permite gerar estatísticas resumo como média, mediana, desvio-padrão, coeficiente de variação e amplitude e, quando <strong><code>hist = TRUE</code></strong>, apresenta o histograma da distribuição dos dados.</p></li>
<li><p>O argumento <strong><code>stats = "main"</code></strong> foi utilizado para focar nos indicadores principais, garantindo uma leitura rápida e objetiva das medidas de tendência central e dispersão.</p></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">#|warning: false</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>descritiva <span class="ot">&lt;-</span> dados <span class="sc">%&gt;%</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  metan<span class="sc">::</span><span class="fu">desc_stat</span>(prod, <span class="at">hist =</span> <span class="cn">TRUE</span>, <span class="at">stats =</span> <span class="st">"main"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelagem_experimental_explicacoes_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>O histograma gerado pela função <strong><code>desc_stat()</code></strong> representa a distribuição dos valores observados de produtividade (prod) entre os genótipos avaliados.</p>
<ul>
<li><p>Observa-se uma concentração predominante de parcelas com produtividade entre 35.000 e 50.000 kg/ha, indicando que a maior parte dos genótipos apresenta desempenho médio a alto.</p></li>
<li><p>Há também um pequeno grupo com valores muito baixos, próximos de zero, que provavelmente correspondem a falhas de campo ou perdas experimentais.</p></li>
<li><p>Essa dispersão assimétrica sugere a presença de heterogeneidade entre genótipos e blocos, reforçando a necessidade do uso de modelos mistos (<strong><code>REML/BLUP</code></strong>) nas etapas seguintes, para separar o componente genético do ambiental e obter estimativas mais precisas dos efeitos.</p></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(descritiva)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-066c81de0598f21c2a85" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-066c81de0598f21c2a85">{"x":{"filter":"none","vertical":false,"data":[["1"],["prod"],[36.7224],[58757],[39772.1667],[43138],[3342],[14605.2905],[1721.25],[3432.075],[72]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>variable<\/th>\n      <th>cv<\/th>\n      <th>max<\/th>\n      <th>mean<\/th>\n      <th>median<\/th>\n      <th>min<\/th>\n      <th>sd.amo<\/th>\n      <th>se<\/th>\n      <th>ci.t<\/th>\n      <th>n.valid<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[2,3,4,5,6,7,8,9,10]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"variable","targets":1},{"name":"cv","targets":2},{"name":"max","targets":3},{"name":"mean","targets":4},{"name":"median","targets":5},{"name":"min","targets":6},{"name":"sd.amo","targets":7},{"name":"se","targets":8},{"name":"ci.t","targets":9},{"name":"n.valid","targets":10}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<ul>
<li><p>A tabela de estatísticas descritivas resume o comportamento da variável de produtividade (prod) no experimento. Ao interpretar os resultados, é possível observar que a média foi de aproximadamente 39.772 kg/ha, enquanto a mediana foi de 43.138 kg/ha, indicando uma leve assimetria negativa ou seja, há algumas parcelas com produtividade mais baixa que puxam a média para baixo.</p></li>
<li><p>O valor máximo (58.757 kg/ha) representa o melhor desempenho entre os genótipos avaliados, e o mínimo (3.342 kg/ha) confirma a presença de valores muito baixos observados no histograma, possivelmente relacionados a falhas de campo.</p></li>
<li><p>O desvio-padrão (14.605) e o coeficiente de variação (36,7%) refletem alta variabilidade experimental, o que é esperado em populações ainda segregantes.</p></li>
<li><p>Já o erro padrão da média (1.721) e o intervalo de confiança (±3.432) indicam boa precisão das estimativas, considerando o número de observações válidas (n = 72).</p></li>
</ul>
</section>
<section id="modelagem-estatística" class="level2" data-number="11">
<h2 data-number="11" class="anchored" data-anchor-id="modelagem-estatística"><span class="header-section-number">11</span> Modelagem estatística</h2>
<p>Nesta etapa, ajustei dois modelos lineares mistos para avaliar a produtividade dos genótipos no delineamento alpha-lattice, explorando duas abordagens distintas:</p>
<ul>
<li>Efeito fixo e efeito aleatório. Essa comparação é essencial para compreender o comportamento da variável de interesse sob diferentes pressupostos de inferência e para decidir qual estratégia oferece estimativas mais adequadas ao objetivo experimental.</li>
</ul>
<section id="modelo-1---genótipo-como-efeito-fixo-blues" class="level4" data-number="11.0.1">
<h4 data-number="11.0.1" class="anchored" data-anchor-id="modelo-1---genótipo-como-efeito-fixo-blues"><span class="header-section-number">11.0.1</span> Modelo 1 - Genótipo como efeito fixo (BLUEs)</h4>
<p>Essa abordagem gera as Estimativas Lineares Não Viesadas (BLUEs), que representam as médias ajustadas dos genótipos após o controle dos efeitos de repetição e blocos incompletos. Esse tipo de modelagem é apropriado quando o interesse está em comparar diretamente os genótipos avaliados no experimento, sem extrapolar conclusões para um conjunto maior de materiais genéticos. Utilizei a função <code>anova()</code> com o método <code>Kenward–Roger</code><a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a> para obter o teste de significância dos efeitos fixos. Além disso, avaliei os resíduos e a sua normalidade, a fim de verificar o atendimento aos pressupostos do modelo.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>mod.fg <span class="ot">&lt;-</span> <span class="fu">lmer</span>(prod <span class="sc">~</span> gen <span class="sc">+</span> rep <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> rep<span class="sc">:</span>inc.bloco), <span class="at">data =</span> dados)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>O modelo matemático foi especificado da seguinte forma:</strong></p>
<p><span class="math inline">\(yijk​=μ+gi​+rj​+bk(j)​+εijk\)</span></p>
<table class="caption-top table">
<colgroup>
<col style="width: 27%">
<col style="width: 72%">
</colgroup>
<thead>
<tr class="header">
<th>Componentes</th>
<th>Descrição</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(y_{ijk}\)</span></td>
<td>Observação do rendimento do genótipo (<em>i</em>) na repetição (<em>j</em>) e bloco incompleto (<em>k</em>)</td>
</tr>
<tr class="even">
<td><span class="math inline">\(u\)</span></td>
<td>Média geral do experimento</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(g_i\)</span></td>
<td>Efeito fixo do genótipo <span class="math inline">\(i = 1, 2, \ldots, G\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(r_j\)</span></td>
<td>Efeito fixo da repetição <span class="math inline">\(j = 1, 2, \ldots,R\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(b_{k(j)}\)</span></td>
<td>Efeito aleatório do bloco incompleto (<em>k</em>) dentro da repetição (j), assumindo <span class="math inline">\(b_{k(j)} \sim N(0, \sigma_b^2)\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(\varepsilon_{ijk}\)</span></td>
<td>Erro aleatório, assumindo <span class="math inline">\(\varepsilon_{ijk} \sim N(0, \sigma_e^2)\)</span> e independentes entre si</td>
</tr>
</tbody>
</table>
</section>
<section id="diagnóstico-de-resíduos" class="level4" data-number="11.0.2">
<h4 data-number="11.0.2" class="anchored" data-anchor-id="diagnóstico-de-resíduos"><span class="header-section-number">11.0.2</span> Diagnóstico de resíduos</h4>
<p>O gráfico Resíduos x Ajustados do modelo fixo (BLUE) mostra a dispersão dos resíduos em relação aos valores ajustados pelo modelo.</p>
<ul>
<li><p>Ao analisar o gráfico, foi possível observar uma distribuição aleatória dos pontos ao redor da linha zero, sem tendência clara, o que indica que o modelo não apresenta viés sistemático na predição da produtividade.</p></li>
<li><p>No entanto, é possível verificar também, uma maior variabilidade dos resíduos em níveis intermediários e altos de produtividade, sugerindo heterocedasticidade leve, isto é, variação desigual do erro entre os níveis de resposta.</p></li>
<li><p>Apesar disso, os resíduos permanecem majoritariamente centrados em torno de zero, o que é desejável em um modelo bem ajustado.</p></li>
<li><p>Em experimentos agrícolas, pequenas variações são esperadas devido a fatores ambientais e do campo experimental, mas o padrão geral indica que o modelo fixo se ajusta adequadamente aos dados observados.</p></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">resid</span>(mod.fg) <span class="sc">~</span> <span class="fu">fitted</span>(mod.fg),</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Resíduos vs Ajustados - Modelo Fixo (BLUE)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelagem_experimental_explicacoes_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>No gráfico Q-Q Plot do modelo fixo, foi avaliada a normalidade dos resíduos, comparando os quantis observados (eixo y) com os quantis teóricos da distribuição normal (eixo x).</p>
<ul>
<li><p>Visualmente, observei que a maioria dos pontos segue próxima da linha diagonal, indicando que os resíduos apresentam comportamento aproximadamente normal.</p></li>
<li><p>Apenas pequenas deformações nas extremidades (caudas) sugerem uma leve assimetria, o que é comum em dados de produtividade agrícola, especialmente em populações ainda segregantes.</p></li>
<li><p>Essa análise é importante porque a suposição de normalidade dos erros garante a validade dos testes F e das estimativas de variância no modelo.</p></li>
<li><p>Apesar das pequenas discrepâncias nas caudas, o ajuste é considerado adequado para fins de inferência, não comprometendo a interpretação dos efeitos fixos e a obtenção das médias ajustadas (BLUEs).</p></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(mod.fg)); <span class="fu">qqline</span>(<span class="fu">resid</span>(mod.fg))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelagem_experimental_explicacoes_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="anova-para-efeitos-fixos" class="level4" data-number="11.0.3">
<h4 data-number="11.0.3" class="anchored" data-anchor-id="anova-para-efeitos-fixos"><span class="header-section-number">11.0.3</span> ANOVA para efeitos fixos</h4>
<p>Em seguida, foi realizada à análise de variância (ANOVA) para o modelo com genótipos tratados como efeitos fixos, utilizando o método Kenward-Roger para o cálculo dos graus de liberdade (ddf = Kenward-Roger).</p>
<ul>
<li><p>Essa abordagem é mais apropriada em experimentos com número limitado de repetições e estruturas desbalanceadas, pois ajusta a variância dos erros e fornece testes F mais precisos.</p></li>
<li><p>O objetivo aqui, foi avaliar a significância dos efeitos de genótipo, repetição e blocos incompletos sobre a produtividade.</p></li>
<li><p>Quando o efeito de genótipo é significativo, isso indica que existe variabilidade real entre os materiais avaliados, justificando o prosseguimento da análise com comparações múltiplas e estimativas médias ajustadas (BLUEs).</p></li>
<li><p>Além disso, essa etapa permite confirmar se a estrutura do delineamento (blocos incompletos dentro de repetições) foi eficiente em controlar a heterogeneidade experimental, garantindo que as diferenças observadas entre genótipos sejam atribuídas majoritariamente a causas genéticas e não ao ruído ambiental.</p></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>anova_fg <span class="ot">&lt;-</span> <span class="fu">anova</span>(mod.fg, <span class="at">ddf =</span> <span class="st">"Kenward-Roger"</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>anova_fg</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Type III Analysis of Variance Table with Kenward-Roger's method
        Sum Sq   Mean Sq NumDF  DenDF F value  Pr(&gt;F)  
gen 5951733732 258771032    23 38.024  1.9325 0.03499 *
rep 1007639474 503819737     2  8.142  3.7693 0.06938 .
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>A tabela da ANOVA com o método de <strong>Kenward-Roger</strong> apresenta os testes de significância para os efeitos fixos incluídos no modelo.</p>
<ul>
<li><p>Ao interpretar os resultados, foi possível observar que o efeito de genótipo foi significativo (F=1,93; p=0,03598), indicando que existe variabilidade estatisticamente detectável entre os genótipos avaliados quanto à produtividade.</p></li>
<li><p>Esse resultado confirma que as diferenças observadas não se devem apenas ao acaso, mas refletem diferenças genéticas reais entre os materiais testados.</p></li>
<li><p>Por outro lado, o efeito de repetição (F=0,02; p=0,88126) não foi significativo, o que sugere que as condições experimentais entre as repetições foram homogêneas, sem variações no ambiente.</p></li>
</ul>
<blockquote class="blockquote">
<p>A significância do fator genótipo valida o uso do modelo misto na sequência da análise, permitindo estimar as médias ajustadas (BLUEs) e, posteriormente, comparar o desempenho dos materiais.</p>
</blockquote>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Importante
</div>
</div>
<div class="callout-body-container callout-body">
<p>A ANOVA Tipo III foi utilizada porque o modelo ajustado não é completamente ortogonal ou seja, os efeitos dos fatores (genótipos, repetições e blocos) não são totalmente independentes. Nesse tipo de modelo, cada termo deve ser avaliado ajustando-se para os demais fatores presentes.</p>
</div>
</div>
</section>
<section id="modelo-2-genótipo-como-efeito-aleatório---blups" class="level3" data-number="11.1">
<h3 data-number="11.1" class="anchored" data-anchor-id="modelo-2-genótipo-como-efeito-aleatório---blups"><span class="header-section-number">11.1</span> Modelo 2: Genótipo como efeito aleatório - BLUPs</h3>
<p>Neste segundo modelo, considerei o genótipo como efeito aleatório, o que transforma a natureza da inferência do modelo.</p>
<ul>
<li><p>Essa modelagem tem como objetivo predizer o valor genético dos genótipos ou seja, estimar seus BLUPs (Best Linear Unbiased Predictors).</p></li>
<li><p>Enquanto o modelo fixo fornece médias ajustadas (BLUEs) apenas para os genótipos testados, este modelo permite inferir sobre uma população maior, tratando os genótipos como uma amostra aleatória dentro do programa de melhoramento.</p></li>
<li><p>Essa abordagem é mais realista no contexto do melhoramento genético vegetal, pois considera a variabilidade genética como um componente da variância total e reduz o impacto de observações extremas.</p></li>
<li><p>Além disso, ao estimar simultaneamente as variâncias genética <span class="math inline">\(σg2\)</span>, de bloco <span class="math inline">\(σb2​\)</span> e residual <span class="math inline">\(σr2\)</span>, o modelo fornece base para calcular parâmetros genéticos, como herdabilidade e acurácia seletiva fundamentais para a etapa de seleção de linhagens promissoras.</p></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>mod.rg <span class="ot">&lt;-</span> <span class="fu">lmer</span>(prod <span class="sc">~</span> rep <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> gen) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> rep<span class="sc">:</span>inc.bloco), <span class="at">data =</span> dados)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>O modelo matemático foi especificado da seguinte forma:</strong></p>
<p><span class="math inline">\(yijk​=μ+rj​+gi​+bk(j)​+εijk\)</span>​</p>
<table class="caption-top table">
<colgroup>
<col style="width: 23%">
<col style="width: 30%">
<col style="width: 23%">
<col style="width: 23%">
</colgroup>
<thead>
<tr class="header">
<th>Símbolo</th>
<th>Descrição</th>
<th>Tipo de efeito</th>
<th>Distribuição assumida</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(y_{ijk}\)</span></td>
<td>Valor observado do rendimento do genótipo (<em>i</em>) na repetição (<em>j</em>) e bloco (<em>k</em>)</td>
<td>-</td>
<td>-</td>
</tr>
<tr class="even">
<td><span class="math inline">\(u\)</span></td>
<td>Média geral do experimento</td>
<td>Fixo</td>
<td>-</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(r_j\)</span></td>
<td>Efeito da repetição (<em>j</em>)</td>
<td>Fixo</td>
<td>-</td>
</tr>
<tr class="even">
<td><span class="math inline">\(g_i\)</span></td>
<td>Efeito do genótipo (<em>i)</em></td>
<td>Aleatório</td>
<td><span class="math inline">\(g_i \sim N(0, \sigma^2_g)\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(b_{k(j)}\)</span></td>
<td>Efeito do bloco incompleto (<em>k</em>) dentro da repetição (<em>j</em>)</td>
<td>Aleatório</td>
<td><span class="math inline">\(b_{k(j)} \sim N(0, \sigma^2_b)\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(\varepsilon_{ijk}\)</span></td>
<td>Erro aleatório associado à observação</td>
<td>Aleatório</td>
<td><span class="math inline">\(\varepsilon_{ijk} \sim N(0, \sigma^2_e)\)</span></td>
</tr>
</tbody>
</table>
<section id="diagnóstico-dos-resíduos" class="level4" data-number="11.1.1">
<h4 data-number="11.1.1" class="anchored" data-anchor-id="diagnóstico-dos-resíduos"><span class="header-section-number">11.1.1</span> Diagnóstico dos resíduos</h4>
<p>Ao analisar o gráfico Resíduos x Ajustados do modelo aleatório (BLUP), foi possível verificar o comportamento dos erros em relação aos valores preditos.</p>
<ul>
<li><p>Os pontos se distribuem de forma predominantemente aleatória ao redor da linha zero, sem formação de padrões evidentes, o que indica que o modelo apresenta homocedasticidade, ou seja, variância constante dos resíduos ao longo da faixa de produtividades ajustadas.</p></li>
<li><p>Entretanto, alguns pontos mais dispersos na extremidade inferior referentes a parcelas com produtividade muito baixa o que é comum em ensaios de campo, onde variações ambientais e falhas experimentais podem gerar resíduos extremos.<br>
Mesmo assim, a tendência geral mostra que o modelo aleatório ajustou bem a estrutura dos dados, capturando os efeitos genéticos e de bloco de forma eficiente.</p></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">resid</span>(mod.rg) <span class="sc">~</span> <span class="fu">fitted</span>(mod.rg), <span class="at">main =</span> <span class="st">"Resíduos vs Ajustados - Modelo Aleatório (BLUP)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelagem_experimental_explicacoes_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>No gráfico Q-Q Plot do modelo aleatório (BLUP), foi avaliado se os resíduos seguem a distribuição normal teórica, um dos pressupostos fundamentais do modelo misto.</p>
<ul>
<li><p>A maioria dos pontos se alinha bem à linha diagonal, o que indica que a distribuição dos resíduos é aproximadamente normal. Apenas pequenas deformações nas extremidades (caudas) podem ser observadas, refletindo a presença de alguns valores atípicos comportamento comum em experimentos agrícolas devido à variabilidade natural entre parcelas.</p></li>
<li><p>Essa proximidade entre os quantis observados e teóricos confirma que o ajuste do modelo é adequado e que as inferências obtidas (como os componentes de variância e os BLUPs) são estatisticamente válidas.</p></li>
<li><p>O modelo aleatório apresentou boa aderência à normalidade e homogeneidade de variâncias, reforçando sua consistência para estimar parâmetros genéticos e predizer o desempenho dos genótipos.</p></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(mod.rg)); <span class="fu">qqline</span>(<span class="fu">resid</span>(mod.rg))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelagem_experimental_explicacoes_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Pessoal, vou reforçar uma questão que pode surgir:</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>A suposição de normalidade dos resíduos é verificada para avaliar o ajuste e a robustez do modelo, mas não é um pressuposto estritamente necessário para a validade das estimativas obtidas via REML/BLUP. O modelo misto suporta pequenas violações de normalidade, desde que a estrutura de variâncias e covariâncias seja corretamente especificada e os resíduos sejam independentes e homocedásticos.</p>
</div>
</div>
</section>
<section id="teste-de-significância-dos-componentes-de-variância" class="level4" data-number="11.1.2">
<h4 data-number="11.1.2" class="anchored" data-anchor-id="teste-de-significância-dos-componentes-de-variância"><span class="header-section-number">11.1.2</span> Teste de significância dos componentes de variância</h4>
<p>Nesta etapa, foi realizado o teste de significância dos componentes de variância por meio da função <strong><code>ranova()</code></strong><a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a>, que avalia se os efeitos aleatórios incluídos no modelo contribuem de forma significativa para explicar a variabilidade observada na produtividade.</p>
<ul>
<li><p>O procedimento compara o modelo completo com versões reduzidas (sem cada efeito aleatório), utilizando testes de <strong>razão de verossimilhança (Likelihood Ratio Test)</strong><a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a>.</p></li>
<li><p>Quando o resultado indica que o componente de variância associado ao genótipo é significativo, isso confirma que existe variabilidade genética expressiva na população avaliada, o que justifica a aplicação do modelo misto e a obtenção dos BLUPs para seleção dos melhores materiais.</p></li>
<li><p>Da mesma forma, a significância do componente de bloco dentro de repetição indica que o delineamento alpha-lattice foi eficiente em captar variações ambientais locais, contribuindo para a redução do erro residual e o aumento da precisão experimental.</p></li>
<li><p>A <code>ranova()</code> permite validar estatisticamente a estrutura hierárquica do modelo e assegurar que cada efeito aleatório considerado genótipos, blocos e erro, desempenha papel relevante na explicação da variância total, garantindo um modelo parcimonioso e biologicamente coerente com o delineamento do experimento.</p></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>ranova_rg <span class="ot">&lt;-</span> <span class="fu">ranova</span>(mod.rg)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>ranova_rg</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>ANOVA-like table for random-effects: Single term deletions

Model:
prod ~ rep + (1 | gen) + (1 | rep:inc.bloco)
                    npar  logLik    AIC    LRT Df Pr(&gt;Chisq)  
&lt;none&gt;                 6 -759.47 1530.9                       
(1 | gen)              5 -761.61 1533.2 4.2679  1    0.03884 *
(1 | rep:inc.bloco)    5 -759.69 1529.4 0.4393  1    0.50745  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(ranova_rg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-d463c5b03048b0ce7bb7" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-d463c5b03048b0ce7bb7">{"x":{"filter":"none","vertical":false,"data":[["&lt;none&gt;","(1 | gen)","(1 | rep:inc.bloco)"],[6,5,5],[-759.4710770628622,-761.6050293458329,-759.6907392671565],[1530.942154125724,1533.210058691666,1529.381478534313],[null,4.267904565941535,0.4393244085886181],[null,1,1],[null,0.03883879704791443,0.5074487149062581]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>npar<\/th>\n      <th>logLik<\/th>\n      <th>AIC<\/th>\n      <th>LRT<\/th>\n      <th>Df<\/th>\n      <th>Pr(&gt;Chisq)<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"npar","targets":1},{"name":"logLik","targets":2},{"name":"AIC","targets":3},{"name":"LRT","targets":4},{"name":"Df","targets":5},{"name":"Pr(>Chisq)","targets":6}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>A análise de variância dos componentes aleatórios, obtida por meio da função <code>ranova()</code>, permite avaliar a contribuição de cada termo aleatório do modelo para o ajuste global, com base no teste da razão de verossimilhança (LRT).</p>
<p><strong>No modelo ajustado</strong></p>
<p><span class="math inline">\(prod∼rep+(1∣gen)+(1∣rep:inc.bloco)\)</span></p>
<ul>
<li><p>Observou-se que o efeito aleatório de genótipos foi significativo (p = 0.0388), indicando que há variação genética entre os genótipos avaliados, justificando sua manutenção no modelo.</p></li>
<li><p>Por outro lado, o termo blocos incompletos dentro de repetição (<code>rep:inc.bloco</code>) não apresentou significância estatística (p = 0.5074), sugerindo que essa fonte de variação <strong>não</strong> contribui de forma relevante para explicar o rendimento.</p></li>
<li><p>Nesse caso, a simplificação do modelo, removendo esse termo, resulta em uma estrutura mais parcimoniosa, com melhor ajuste (AIC = 1529.4) e menor complexidade, sem perda de qualidade na predição.</p></li>
</ul>
</section>
<section id="comparação-entre-modelos-aic-e-loglik" class="level4" data-number="11.1.3">
<h4 data-number="11.1.3" class="anchored" data-anchor-id="comparação-entre-modelos-aic-e-loglik"><span class="header-section-number">11.1.3</span> Comparação entre modelos (AIC e LogLik)</h4>
<p>Por fim, comparei o desempenho dos dois modelos o de efeito fixo (BLUE) e o de efeito aleatório (BLUP) utilizando os critérios AIC (Akaike Information Criterion)<a href="#fn8" class="footnote-ref" id="fnref8" role="doc-noteref"><sup>8</sup></a> e logLik (logaritmo da verossimilhança).</p>
<ul>
<li><p>Esses indicadores permitem avaliar a qualidade de ajuste e a parcimônia dos modelos, isto é, o equilíbrio entre complexidade e capacidade explicativa.</p></li>
<li><p>O AIC é uma medida em que valores menores indicam melhor ajuste, enquanto o logLik reflete a verossimilhança do modelo quanto maior, melhor a adequação aos dados observados.</p></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>aic_comp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Modelo =</span> <span class="fu">c</span>(<span class="st">"Efeito Fixo (BLUE)"</span>, <span class="st">"Efeito Aleatório (BLUP)"</span>),</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">AIC =</span> <span class="fu">c</span>(<span class="fu">AIC</span>(mod.fg), <span class="fu">AIC</span>(mod.rg)),</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">logLik =</span> <span class="fu">c</span>(<span class="fu">logLik</span>(mod.fg), <span class="fu">logLik</span>(mod.rg)))</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(aic_comp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                   Modelo      AIC    logLik
1      Efeito Fixo (BLUE) 1082.702 -513.3511
2 Efeito Aleatório (BLUP) 1530.942 -759.4711</code></pre>
</div>
</div>
<p>A comparação entre os modelos de efeitos fixos (BLUE) e aleatórios (BLUP) foi realizada com base nos critérios Akaike Information Criterion (AIC) e Log-Likelihood (logLik), que medem a qualidade do ajuste do modelo aos dados.</p>
<ul>
<li><p>O modelo com efeitos fixos apresentou um AIC de 1106.276 e logLik = -526.1379, enquanto o modelo com efeitos aleatórios resultou em AIC de 1554.834 e logLik = -772.4170.</p></li>
<li><p>Como valores menores de AIC indicam melhor ajuste e maior parcimônia, conclui-se que o modelo com genótipos tratados como efeitos fixos fornece um ajuste mais adequado para os dados avaliados neste experimento. Isso sugere que a variação entre genótipos foi suficientemente explicada como efeito fixo, sem necessidade de tratá-los como uma amostra aleatória de uma população maior.</p></li>
<li><p>Por outro lado, o modelo com genótipos como efeitos aleatórios (BLUP), embora essencial em contextos de predição genética e seleção em larga escala, apresentou maior penalização no AIC, refletindo maior complexidade sem ganho proporcional de ajuste para este conjunto de dados específico.</p></li>
</ul>
</section>
</section>
</section>
<section id="estimativas-dos-blues-e-blups" class="level2" data-number="12">
<h2 data-number="12" class="anchored" data-anchor-id="estimativas-dos-blues-e-blups"><span class="header-section-number">12</span> Estimativas dos BLUEs E BLUPs</h2>
<section id="estimativas-dos-blues---efeito-fixo" class="level3" data-number="12.1">
<h3 data-number="12.1" class="anchored" data-anchor-id="estimativas-dos-blues---efeito-fixo"><span class="header-section-number">12.1</span> Estimativas dos BLUEs - Efeito fixo</h3>
<p>Nesta etapa, obtive as estimativas BLUEs (Best Linear Unbiased Estimates), correspondentes às médias ajustadas dos genótipos considerando o modelo com efeitos fixos.</p>
<ul>
<li>Utilizei a função <code>emmeans()</code> do pacote <code>emmeans</code><a href="#fn9" class="footnote-ref" id="fnref9" role="doc-noteref"><sup>9</sup></a>, que calcula as médias marginais ajustadas após o controle dos efeitos de repetição e blocos incompletos.</li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Dica
</div>
</div>
<div class="callout-body-container callout-body">
<p>Foi lançada uma nova versão do pacote 29/10/2025. Confira <a href="https://rvlenth.github.io/emmeans/news/index.html"><strong>aqui</strong></a>, as novas funções!</p>
</div>
</div>
<p><strong>Em seguida, converti o resultado para data frame e selecionei as colunas principais:</strong></p>
<ul>
<li><p><code>gen</code>: identificação dos genótipos;</p></li>
<li><p><code>BLUE</code>: média ajustada estimada;</p></li>
<li><p><code>IC_inferior</code> e <code>IC_superior</code>: limites inferior e superior do intervalo de confiança (95%) para cada genótipo.</p></li>
<li><p>Essas estimativas representam o desempenho fenotípico médio dos genótipos, já corrigido pelas variações ambientais controladas no modelo.</p></li>
<li><p>O uso das BLUEs é apropriado quando o objetivo é comparar diretamente os materiais testados no experimento, fornecendo uma base para a classificação e agrupamento dos genótipos com base nas médias ajustadas de produtividade.</p></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>BLUEs <span class="ot">&lt;-</span> emmeans<span class="sc">::</span><span class="fu">emmeans</span>(mod.fg, <span class="sc">~</span> gen) <span class="sc">%&gt;%</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(gen, <span class="at">BLUE =</span> emmean, <span class="at">IC_inferior =</span> lower.CL, <span class="at">IC_superior =</span> upper.CL)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(BLUEs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-10fd279895b27f445a27" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-10fd279895b27f445a27">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24"],["G01","G02","G03","G04","G05","G06","G07","G08","G09","G10","G11","G12","G13","G14","G15","G16","G17","G18","G19","G20","G21","G22","G23","G24"],[51401.5539976853,20831.83584322427,24114.4520010253,31127.86399468413,49862.29502113721,48195.39902603131,40996.49092079704,44694.03598295247,36980.25817511476,43339.91163599859,41902.95359065419,31312.70104288231,18228.23846285845,45917.58826401556,49268.35618753515,47680.92645383204,46422.27683338303,44722.40404518506,49341.66145620843,38819.45013142029,20831.78970508904,45867.85590479807,40219.49749907546,42452.20382441271],[36810.44627215533,6240.728117694358,9523.34427549539,16536.75626915421,35268.71608556522,33601.82009045933,26405.38319526712,30102.92825742255,22386.67923954278,28748.80391046868,27311.84586512427,16721.59331735239,3634.659527286465,31324.00932844358,34674.77725196317,33089.81872830213,31828.69789781105,30131.29631965514,34748.08252063645,24225.87119584831,6238.210769517051,31274.27696922609,25625.91856350348,27861.09609888279],[65992.66172321526,35422.94356875419,38705.55972655522,45718.97172021405,64455.8739567092,62788.9779616033,55587.59864632696,59285.14370848238,51573.83711068674,57931.01936152851,56494.0613161841,45903.80876841222,32821.81739843043,60511.16719958755,63861.93512310713,62272.03417936196,61015.85576895501,59313.51177071498,63935.2403917804,53413.02906699228,35425.36864066103,60461.43484037006,54813.07643464745,57043.31154994263]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>gen<\/th>\n      <th>BLUE<\/th>\n      <th>IC_inferior<\/th>\n      <th>IC_superior<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[2,3,4]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"gen","targets":1},{"name":"BLUE","targets":2},{"name":"IC_inferior","targets":3},{"name":"IC_superior","targets":4}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="estimativas-dos-blups---efeito-aleatório" class="level3" data-number="12.2">
<h3 data-number="12.2" class="anchored" data-anchor-id="estimativas-dos-blups---efeito-aleatório"><span class="header-section-number">12.2</span> Estimativas dos BLUPs - Efeito aleatório</h3>
<p>Nesta etapa, estimei os BLUPs (Best Linear Unbiased Predictors) a partir do modelo em que o genótipo foi considerado como efeito aleatório.</p>
<ul>
<li><p>Primeiro, extraí a média geral <span class="math inline">\(u\)</span> do modelo por meio da função <code>fixef(mod.rg)[1]</code>, que representa o intercepto fixo, isto é, o valor médio da produtividade ajustado para todos os efeitos incluídos.</p></li>
<li><p>Em seguida, utilizei a função <code>ranef()</code> para obter os efeitos aleatórios preditos de cada genótipo, os quais representam os desvios individuais em relação à média geral do experimento.</p></li>
<li><p>Esses valores correspondem às diferenças genéticas ajustadas, considerando os efeitos de repetição e de blocos incompletos dentro de cada repetição.</p></li>
</ul>
<p>O BLUP de cada genótipo foi calculado somando a média geral ao efeito aleatório estimado:</p>
<p><span class="math inline">\(BLUPj=μ+gj\)</span></p>
<p><strong>onde:</strong></p>
<p><span class="math inline">\(u\)</span> : é a média geral ajustada do modelo;</p>
<p><span class="math inline">\(\hat{g}_j\)</span> é o valor predito para o efeito aleatório do genótipo <em>j</em>.</p>
<ul>
<li>Para cada genótipo, também foram calculados intervalos de confiança de 95%, baseados no erro-padrão associado à predição individual. As colunas finais da tabela de resultados incluem:</li>
</ul>
<!-- -->
<ul>
<li><p>gen - identificação do genótipo</p></li>
<li><p>BLUP - valor genético predito ajustado;</p></li>
<li><p>IC_inferior e IC_superior - limites inferior e superior do intervalo de confiança.</p></li>
<li><p>Essas estimativas representam o desempenho genético ajustado dos materiais avaliados, já descontando a influência ambiental e dos blocos.</p></li>
<li><p>Diferentemente dos BLUEs, os BLUPs permitem predizer o valor genético de genótipos não observados diretamente, sendo, portanto, uma abordagem mais apropriada para a seleção em programas de melhoramento genético de plantas.</p></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>mu_manual <span class="ot">&lt;-</span> <span class="fu">fixef</span>(mod.rg)[<span class="dv">1</span>]</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>BLUPs <span class="ot">&lt;-</span> <span class="fu">augment</span>(<span class="fu">ranef</span>(mod.rg)) <span class="sc">%&gt;%</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(grp <span class="sc">==</span> <span class="st">"gen"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(<span class="at">gen =</span> level,</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">BLUP =</span> mu_manual <span class="sc">+</span> estimate,</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">IC_inferior =</span> BLUP <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> std.error,</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">IC_superior =</span> BLUP <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> std.error)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(BLUPs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-4d57938dee6bdbbb3277" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-4d57938dee6bdbbb3277">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24"],["G13","G21","G02","G03","G04","G12","G09","G20","G07","G23","G11","G24","G10","G18","G08","G14","G22","G17","G16","G06","G19","G15","G05","G01"],[26006.0077319847,27223.32122118213,27269.81625033347,28772.65084780521,32216.92472153421,32857.0966694836,35366.21876298595,36668.26292263348,37343.95766077066,37356.43302589647,38106.55532569488,38406.0881523367,39174.54696420601,39613.27265641548,39718.19730354406,39948.88485064326,40416.66703298823,40454.5402020833,40925.84535504637,41196.33059085052,41856.27113795799,41935.23468067336,42262.76732124948,42724.10861170154],[16190.75845083472,17408.07194003215,17454.56696918349,18957.40156665523,22401.69583986439,23041.86778781378,25550.96948183597,26853.0136414835,27528.72877910084,27541.18374474649,28291.3060445449,28590.83887118672,29359.31808253619,29798.04377474566,29902.96842187424,30133.63556949328,30601.43815131841,30639.29092093332,31110.61647337655,31381.1017091807,32041.04225628816,32120.00579900354,32447.53843957966,32908.85933055155],[35821.25701313467,37038.57050233211,37085.06553148344,38587.90012895518,42032.15360320403,42672.32555115342,45181.46804413594,46483.51220378347,47159.18654244048,47171.68230704645,47921.80460684486,48221.33743348668,48989.77584587583,49428.5015380853,49533.42618521388,49764.13413179324,50231.89591465805,50269.78948323328,50741.07423671619,51011.55947252034,51671.50001962781,51750.46356234318,52077.9962029193,52539.35789285152]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>gen<\/th>\n      <th>BLUP<\/th>\n      <th>IC_inferior<\/th>\n      <th>IC_superior<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[2,3,4]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"gen","targets":1},{"name":"BLUP","targets":2},{"name":"IC_inferior","targets":3},{"name":"IC_superior","targets":4}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<section id="comparação-entre-blue-x-blup" class="level4" data-number="12.2.1">
<h4 data-number="12.2.1" class="anchored" data-anchor-id="comparação-entre-blue-x-blup"><span class="header-section-number">12.2.1</span> Comparação entre BLUE x BLUP</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Junta as estimativas dos dois modelos pelo identificador gen</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>comparacao <span class="ot">&lt;-</span> <span class="fu">full_join</span>(BLUEs, BLUPs, <span class="at">by =</span> <span class="st">"gen"</span>, <span class="at">suffix =</span> <span class="fu">c</span>(<span class="st">"_BLUE"</span>, <span class="st">"_BLUP"</span>))</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>comparacao_long <span class="ot">&lt;-</span> comparacao <span class="sc">%&gt;%</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">c</span>(BLUE, BLUP),</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"Tipo"</span>,</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"Estimativa"</span>)</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Ordena os genótipos pela média BLUP</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>ordem_gen <span class="ot">&lt;-</span> comparacao <span class="sc">%&gt;%</span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(BLUP) <span class="sc">%&gt;%</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(gen)</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>comparacao_long<span class="sc">$</span>gen <span class="ot">&lt;-</span> <span class="fu">factor</span>(comparacao_long<span class="sc">$</span>gen, </span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>                              <span class="at">levels =</span> ordem_gen)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(comparacao_long, <span class="fu">aes</span>(<span class="at">x =</span> gen, <span class="at">y =</span> Estimativa, <span class="at">fill =</span> Tipo)) <span class="sc">+</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.8</span>), <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymin =</span> <span class="fu">ifelse</span>(Tipo <span class="sc">==</span> <span class="st">"BLUE"</span>, IC_inferior_BLUE, </span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>                  IC_inferior_BLUP),</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymax =</span> <span class="fu">ifelse</span>(Tipo <span class="sc">==</span> <span class="st">"BLUE"</span>, IC_superior_BLUE,</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>                  IC_superior_BLUP)), </span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.8</span>), <span class="at">width =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Comparação entre BLUEs e BLUPs por Genótipo"</span>,</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Genótipos"</span>,</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Estimativas de produção"</span>,</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Modelo"</span>) <span class="sc">+</span></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelagem_experimental_explicacoes_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Neste gráfico, comparei as estimativas BLUEs e BLUPs obtidas para cada genótipo, representando a produtividade ajustada segundo as duas modelagens estatísticas.</p>
<ul>
<li><p>Os genótipos estão ordenados pela média BLUP, permitindo visualizar a progressão do desempenho genético predito.</p></li>
<li><p>As barras vermelhas correspondem aos BLUEs, provenientes do modelo com efeito fixo de genótipo, enquanto as barras azuis representam os BLUPs, obtidas do modelo com efeito aleatório de genótipo.</p></li>
<li><p>Ao observar o gráfico, percebo que os BLUEs apresentam maior amplitude e maior variação entre genótipos, refletindo diretamente os valores médios observados no experimento portanto, mais sensíveis à variação fenotípica e ao erro experimental.</p></li>
<li><p>Já os BLUPs mostram comportamento mais suavizado e estável, pois incorporam a estrutura de variâncias do modelo misto, corrigindo a influência ambiental e priorizando a informação genética predita.</p></li>
</ul>
<p><strong>Essa diferença é esperada:</strong></p>
<ul>
<li><p>Os BLUEs são estimativas descritivas, adequadas para comparar os genótipos avaliados dentro do experimento específico;</p></li>
<li><p>Os BLUPs são preditivos, permitindo inferir sobre o valor genético e realizar seleção com base em mérito genético.</p></li>
<li><p>O gráfico evidencia que, embora ambos os métodos estimem o mesmo fenômeno (produtividade ajustada), eles respondem a objetivos distintos:</p>
<ul>
<li>Os BLUEs detalham o comportamento experimental observado, enquanto os BLUPs fornecem uma visão mais generalizada e essencial em contextos de melhoramento genético e seleção de linhagens promissoras.</li>
</ul></li>
</ul>
</section>
<section id="blups-preditos" class="level4" data-number="12.2.2">
<h4 data-number="12.2.2" class="anchored" data-anchor-id="blups-preditos"><span class="header-section-number">12.2.2</span> BLUPs preditos</h4>
<p>Nesta visualização, apresento as estimativas BLUPs (Best Linear Unbiased Predictors) para os genótipos avaliados, já ajustadas pelos efeitos ambientais e de blocos.</p>
<ul>
<li><p>Os genótipos estão ordenados do menor para o maior valor predito, permitindo observar claramente o gradiente de desempenho genético na população.</p></li>
<li><p>As barras representam a produtividade ajustada (kg/ha), enquanto as linhas verticais indicam os intervalos de confiança (95%), evidenciando a precisão das estimativas individuais.</p></li>
<li><p>Genótipos com BLUPs mais altos estão acima da média geral <span class="math inline">\(μ\)</span>, sendo candidatos preferenciais à seleção, pois apresentam maior mérito genético estimado.</p></li>
<li><p>Por outro lado, genótipos com BLUPs mais baixos situam-se abaixo da média, refletindo desempenho inferior após o ajuste dos efeitos ambientais.</p></li>
<li><p>Enquanto análises clássicas (como médias de tratamento) descrevem o desempenho observado, o modelo misto e os BLUPs revelam o potencial genético verdadeiro dos genótipos, tornando-se a principal abordagem de seleção em programas de melhoramento vegetal.</p></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ordena os genótipos pela estimativa BLUP</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>BLUPs <span class="ot">&lt;-</span> BLUPs <span class="sc">%&gt;%</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(BLUP) <span class="sc">%&gt;%</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gen =</span> <span class="fu">factor</span>(gen, <span class="at">levels =</span> gen))</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>media_geral <span class="ot">&lt;-</span> <span class="fu">fixef</span>(mod.rg)[<span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co">#|wwarning: false</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="co">#|mmessage: false</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(BLUPs, <span class="fu">aes</span>(<span class="at">x =</span> gen, <span class="at">y =</span> BLUP)) <span class="sc">+</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"#2ca9b7"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> IC_inferior, <span class="at">ymax =</span> IC_superior), <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> media_geral, </span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"#E85D04"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Estimativas BLUPs por Genótipo"</span>,</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Linha tracejada indica a média geral ajustada (μ)"</span>,</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Genótipos"</span>,</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Produtividade (kg/ha)"</span>) <span class="sc">+</span></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelagem_experimental_explicacoes_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="herdabilidade" class="level2" data-number="13">
<h2 data-number="13" class="anchored" data-anchor-id="herdabilidade"><span class="header-section-number">13</span> Herdabilidade</h2>
<p>Nesta etapa, estimei a herdabilidade em sentido amplo <span class="math inline">\(H^2\)</span> com base nas variâncias obtidas do modelo misto com genótipos como efeito aleatório.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>vcomps <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">VarCorr</span>(mod.rg))</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>vc.g <span class="ot">&lt;-</span> vcomps[vcomps<span class="sc">$</span>grp <span class="sc">==</span> <span class="st">"gen"</span>, <span class="st">"vcov"</span>]</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>vc.e <span class="ot">&lt;-</span> vcomps[vcomps<span class="sc">$</span>grp <span class="sc">==</span> <span class="st">"Residual"</span>, <span class="st">"vcov"</span>]</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>nreps <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>hc <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(vc.g <span class="sc">/</span> (vc.g <span class="sc">+</span> vc.e <span class="sc">/</span> nreps))  <span class="co"># &lt;- garante tipo numérico</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"Herdabilidade estimada: {round(hc, 3)}"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Herdabilidade estimada: 0.534</code></pre>
</div>
</div>
<p>Estimei <span class="math inline">\(H^2\)</span> (sentido amplo) a partir dos componentes de variância do modelo misto com genótipos como efeito aleatório. Extraí <span class="math inline">\(σ^2g\)</span> (genótipos) e <span class="math inline">\(σ^2e\)</span>​ (resíduo) via <code>VarCorr()</code>, e calculei <span class="math inline">\(H^2\)</span> na base de médias por genótipo, considerando r repetições:</p>
<p><span class="math inline">\(H^2 = \frac{\sigma_g^2}{\sigma_g^2 + \frac{\sigma_e^2}{r}}\)</span></p>
</section>
<section id="agrupamento-hierárquico---upgma" class="level2" data-number="14">
<h2 data-number="14" class="anchored" data-anchor-id="agrupamento-hierárquico---upgma"><span class="header-section-number">14</span> Agrupamento hierárquico - UPGMA</h2>
<p>Nesta etapa, realizei o agrupamento hierárquico dos genótipos com base nas estimativas BLUPs de produtividade, utilizando o método UPGMA (Unweighted Pair Group Method with Arithmetic Mean) e a distância euclidiana como medida de dissimilaridade.</p>
<ul>
<li><p>O objetivo desse procedimento é avaliar o grau de similaridade genética entre os genótipos e identificar possíveis padrões de agrupamento entre materiais com desempenho produtivo semelhante.</p></li>
<li><p>Genótipos próximos no dendrograma apresentam valores genéticos preditos semelhantes, enquanto aqueles separados por maiores distâncias euclidianas diferem mais em seu potencial produtivo.</p></li>
<li><p>O dendrograma evidencia a formação de três grupos principais de genótipos, com base na similaridade de seus valores genéticos preditos.</p></li>
<li><p>O primeiro grupo reúne materiais com desempenho produtivo médio a baixo, enquanto o segundo concentra genótipos com resposta intermediária.</p></li>
<li><p>O terceiro grupo, mais distante, representa genótipos com maiores valores de BLUP, indicando superioridade genética e potencial para seleção em programas de melhoramento.</p></li>
<li><p>Essa estrutura de agrupamento pode ser explorada para selecionar genótipos contrastantes, direcionar cruzamentos futuros ou representar a diversidade entre linhagens avançadas.</p></li>
<li><p>O método UPGMA, ao utilizar as estimativas BLUPs, garante que o agrupamento seja baseado na performance genética ajustada e não apenas em médias fenotípicas -, o que torna a análise mais robusta e alinhada ao propósito do melhoramento genético quantitativo.</p></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>blup_values <span class="ot">&lt;-</span> BLUPs<span class="sc">$</span>BLUP</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(blup_values) <span class="ot">&lt;-</span> BLUPs<span class="sc">$</span>gen</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>dist_blups <span class="ot">&lt;-</span> <span class="fu">dist</span>(blup_values, <span class="at">method =</span> <span class="st">"euclidean"</span>)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>hc <span class="ot">&lt;-</span> <span class="fu">hclust</span>(dist_blups, <span class="at">method =</span> <span class="st">"average"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(hc, <span class="at">main =</span> <span class="st">"Dendrograma UPGMA - BLUPs"</span>,</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Genótipos"</span>, <span class="at">ylab =</span> <span class="st">"Distância Euclidiana"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelagem_experimental_explicacoes_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="correlação-cofenética" class="level3" data-number="14.1">
<h3 data-number="14.1" class="anchored" data-anchor-id="correlação-cofenética"><span class="header-section-number">14.1</span> Correlação cofenética</h3>
<p>Após a geração do dendrograma, eu avaliei a consistência do agrupamento UPGMA por meio da correlação cofenética, que mede o grau de concordância entre a matriz original de distâncias genéticas e a matriz de distâncias representada pelo dendrograma.</p>
<ul>
<li><p>A correlação cofenética obtida foi de 0,8943, o que indica excelente ajuste entre os dados originais e a representação hierárquica produzida pelo método UPGMA.</p></li>
<li><p>Valores próximos de 1 refletem alta fidelidade do dendrograma em representar as relações de similaridade entre os genótipos, garantindo confiabilidade na estrutura de agrupamento observada.</p></li>
<li><p>Esse resultado confirma que o método de agrupamento adotado foi estatisticamente adequado para os dados de BLUPs, permitindo interpretar os grupos formados como indicativos reais de proximidade genética e desempenho produtivo semelhante.</p></li>
<li><p>Assim, a análise de agrupamento, validada pela alta correlação cofenética, reforça a robustez da modelagem mista e a diversidade genética presente entre os genótipos avaliados.</p></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Correlação cofenética</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>cophenetic_dist <span class="ot">&lt;-</span> <span class="fu">cophenetic</span>(hc)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>correlation_cophenetic <span class="ot">&lt;-</span> <span class="fu">cor</span>(dist_blups, cophenetic_dist)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Correlação cofenética:"</span>, <span class="fu">round</span>(correlation_cophenetic, <span class="dv">4</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Correlação cofenética: 0.8781"</code></pre>
</div>
</div>
</section>
</section>
<section id="considerações-finais" class="level2" data-number="15">
<h2 data-number="15" class="anchored" data-anchor-id="considerações-finais"><span class="header-section-number">15</span> Considerações finais</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" href="">Pipeline</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false" href="">Modelagem</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false" href="">Recursos recomendados</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>O pipeline desenvolvido neste portfólio consolida um fluxo completo de análise experimental, desde a importação automatizada dos dados via API do GitHub até a modelagem estatística com delineamento alpha-lattice, integrando visualizações, estimativas genéticas e validação por agrupamento hierárquico.</p>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p>As análises realizadas demonstram a eficiência da modelagem mista aplicada ao delineamento alpha-lattice para a avaliação genética de genótipos.</p>
<ol type="1">
<li><p>O uso combinado dos modelos BLUE e BLUP permitiu distinguir de forma precisa os efeitos fixos e aleatórios, evidenciando a importância de controlar a variação proveniente de blocos incompletos e repetições.</p></li>
<li><p>A estimativa de herdabilidade indicou a proporção da variação total atribuída aos efeitos genéticos, confirmando a adequação do modelo e a confiabilidade dos parâmetros obtidos. Além disso, a análise de agrupamento via UPGMA reforçou a presença de variabilidade genética entre os materiais, o que é essencial para a continuidade do processo seletivo.</p></li>
<li><p>De modo geral, a modelagem adotada proporcionou predições mais acuradas do desempenho genético, favorecendo a seleção de genótipos superiores e garantindo reprodutibilidade e transparência nas etapas analíticas aspectos fundamentais em pipelines de programas de melhoramento genético e experimentação agrícola.</p></li>
</ol>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<table class="caption-top table">
<thead>
<tr class="header">
<th>Pacote | Recurso</th>
<th>Descrição</th>
<th>Link</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>{httr2}</strong></td>
<td>Pacote moderno para consumo de APIs REST no R. Permite autenticação, controle de headers e tratamento seguro de respostas HTTP.</td>
<td><a href="https://httr2.r-lib.org/articles/wrapping-apis.html">httr2.r-lib.org</a></td>
</tr>
<tr class="even">
<td><strong>GitHub API (REST)</strong></td>
<td>Interface oficial para acessar dados do GitHub (arquivos, repositórios, commits, issues) via requisições autenticadas.</td>
<td><a href="https://docs.github.com/rest/guides/getting-started-with-the-rest-api">docs.github.com/rest</a></td>
</tr>
<tr class="odd">
<td><strong>{gh}</strong></td>
<td>Cliente R oficial para a API do GitHub. Facilita automações e integrações entre R e repositórios GitHub.</td>
<td><a href="https://r-lib.github.io/gh/">r-lib.github.io/gh</a></td>
</tr>
<tr class="even">
<td><strong>{lme4}</strong></td>
<td>Base para ajuste de modelos lineares mistos (efeitos fixos e aleatórios) fundamental para estimar BLUPs.</td>
<td><a href="https://cran.r-project.org/package=lme4">cran.r-project.org/lme4</a></td>
</tr>
<tr class="odd">
<td><strong>{emmeans}</strong></td>
<td>Calcula médias ajustadas (BLUEs), intervalos de confiança e comparações múltiplas.</td>
<td><a href="https://emmeans.r-forge.r-project.org/">emmeans.r-forge.r-project.org</a></td>
</tr>
<tr class="even">
<td><strong>{metan}</strong></td>
<td>Ferramenta completa para análises agronômicas e genéticas (BLUP, MGIDI, herdabilidade, PCA, correlação).</td>
<td><a href="https://cran.r-project.org/package=metan">cran.r-project.org/metan</a></td>
</tr>
<tr class="odd">
<td><strong>{tidyverse}</strong></td>
<td>Coleção de pacotes para manipulação, visualização e comunicação de dados de forma coerente e reprodutível.</td>
<td><a href="https://www.tidyverse.org/">tidyverse.org</a></td>
</tr>
<tr class="even">
<td><strong>Quarto</strong></td>
<td>Sistema de publicação científica integrado ao RStudio, ideal para relatórios dinâmicos, artigos e portfólios.</td>
<td><a href="https://quarto.org/">quarto.org</a></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<!-- -->

</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>Pacote <a href="https://httr2.r-lib.org/"><strong><code>httr2</code></strong></a> utilizado para consumo de APIs, via requisição <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Guides/Overview?utm_source=chatgpt.com"><strong>HTTP</strong></a>.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Acesse a documentação de como consumir a <a href="https://docs.github.com/pt/rest/using-the-rest-api/getting-started-with-the-rest-api?apiVersion=2022-11-28"><strong>API do GitHub</strong></a>.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>A new class of resolvable incomplete block designs - <a href="https://academic.oup.com/biomet/article-abstract/63/1/83/237118?redirectedFrom=fulltext&amp;login=false"><strong>Artigo completo</strong></a>.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>Acesse a documentação do pacote <a href="https://cran.r-project.org/web/packages/metan/index.html"><strong>metan: Multi Environment Trials Analysis</strong></a>.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>Kenward-Roger: <a href="https://www.jstor.org/stable/2533558?origin=crossref"><strong>Artigo completo</strong></a>.<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>lmerTest Package: Tests in Linear Mixed Effects Models - <a href="https://www.jstatsoft.org/article/view/v082i13"><strong>Artigo completo</strong></a><strong>.</strong><a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn7"><p>Likelihood Ratio Tests in Linear Mixed Models with One Variance Component.- <a href="https://academic.oup.com/jrsssb/article-abstract/66/1/165/7098985?login=false"><strong>Artigo</strong></a>.<a href="#fnref7" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn8"><p>Critério de <a href="https://pt.wikipedia.org/wiki/Crit%C3%A9rio_de_informa%C3%A7%C3%A3o_de_Akaike"><strong>Akaike</strong></a>.<a href="#fnref8" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn9"><p>emmeans: Estimated Marginal Means, aka Least-Squares Means.- <a href="https://cran.r-project.org/web/packages/emmeans/index.html"><strong>Pacote</strong></a>.<a href="#fnref9" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb40" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Modelagem para seleção de genótipos superiores"</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="an">subtitle:</span><span class="co"> "Delineamento Experimental Alpha-Lattice"</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Jennifer Luz Lopes"</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-title: "Sumário"</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a><span class="co">    number-sections: true</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a><span class="co">    theme: flatly</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a><span class="co">    smooth-scroll: true</span></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a><span class="co">    css: "estilo.css"</span></span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a><span class="co">    page-layout: full</span></span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span></span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a><span class="co">  echo: true</span></span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a><span class="co">  warning: false</span></span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a><span class="co">  message: false</span></span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a>::: callout-important</span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a><span class="fu">## Mensagem inicial</span></span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-25"><a href="#cb40-25" aria-hidden="true" tabindex="-1"></a>Este projeto utiliza dados experimentais simulados, desenvolvidos com o objetivo de reproduzir fielmente a complexidade de um ensaio real de melhoramento genético.\</span>
<span id="cb40-26"><a href="#cb40-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-27"><a href="#cb40-27" aria-hidden="true" tabindex="-1"></a>Foram aplicadas técnicas de estatística experimental, modelagem mista (BLUP/REML) e análises multivariadas para identificar genótipos superiores com base em critérios de desempenho.\</span>
<span id="cb40-28"><a href="#cb40-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-29"><a href="#cb40-29" aria-hidden="true" tabindex="-1"></a>A simulação permitiu validar todo o fluxo de análise, do delineamento ao ranqueamento final, consolidando um cenário realista de tomada de decisão em programas de melhoramento.</span>
<span id="cb40-30"><a href="#cb40-30" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb40-31"><a href="#cb40-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-32"><a href="#cb40-32" aria-hidden="true" tabindex="-1"></a><span class="fu">## Instalação e carregamento dos pacotes</span></span>
<span id="cb40-33"><a href="#cb40-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-36"><a href="#cb40-36" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-37"><a href="#cb40-37" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">"pacman"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) <span class="fu">install.packages</span>(<span class="st">"pacman"</span>)</span>
<span id="cb40-38"><a href="#cb40-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-39"><a href="#cb40-39" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(</span>
<span id="cb40-40"><a href="#cb40-40" aria-hidden="true" tabindex="-1"></a>  broom,          <span class="co"># Organiza resultados de modelos em formato tidy</span></span>
<span id="cb40-41"><a href="#cb40-41" aria-hidden="true" tabindex="-1"></a>  broom.mixed,    <span class="co"># Versão do broom para modelos mistos</span></span>
<span id="cb40-42"><a href="#cb40-42" aria-hidden="true" tabindex="-1"></a>  desplot,        <span class="co"># Visualiza delineamentos experimentais</span></span>
<span id="cb40-43"><a href="#cb40-43" aria-hidden="true" tabindex="-1"></a>  emmeans,        <span class="co"># Médias ajustadas e comparações múltiplas</span></span>
<span id="cb40-44"><a href="#cb40-44" aria-hidden="true" tabindex="-1"></a>  ggpubr,         <span class="co"># Gráficos estatísticos prontos com ggplot2</span></span>
<span id="cb40-45"><a href="#cb40-45" aria-hidden="true" tabindex="-1"></a>  lme4,           <span class="co"># Modelos lineares mistos</span></span>
<span id="cb40-46"><a href="#cb40-46" aria-hidden="true" tabindex="-1"></a>  lmerTest,       <span class="co"># P-valores para modelos lmer()</span></span>
<span id="cb40-47"><a href="#cb40-47" aria-hidden="true" tabindex="-1"></a>  multcomp,       <span class="co"># Testes múltiplos (Tukey, Dunnett)</span></span>
<span id="cb40-48"><a href="#cb40-48" aria-hidden="true" tabindex="-1"></a>  multcompView,   <span class="co"># Letras de agrupamento (a, b, c)</span></span>
<span id="cb40-49"><a href="#cb40-49" aria-hidden="true" tabindex="-1"></a>  plotly,         <span class="co"># Gráficos interativos</span></span>
<span id="cb40-50"><a href="#cb40-50" aria-hidden="true" tabindex="-1"></a>  tidyverse,      <span class="co"># Conjunto para manipulação e visualização de dados</span></span>
<span id="cb40-51"><a href="#cb40-51" aria-hidden="true" tabindex="-1"></a>  writexl,        <span class="co"># Exporta dados para Excel</span></span>
<span id="cb40-52"><a href="#cb40-52" aria-hidden="true" tabindex="-1"></a>  metan,          <span class="co"># Análises agronômicas e genéticas (BLUP, MGIDI)</span></span>
<span id="cb40-53"><a href="#cb40-53" aria-hidden="true" tabindex="-1"></a>  httr2,          <span class="co"># Consumo de APIs modernas</span></span>
<span id="cb40-54"><a href="#cb40-54" aria-hidden="true" tabindex="-1"></a>  readr,          <span class="co"># Leitura rápida de CSV e textos</span></span>
<span id="cb40-55"><a href="#cb40-55" aria-hidden="true" tabindex="-1"></a>  readxl,         <span class="co"># Importação de planilhas Excel</span></span>
<span id="cb40-56"><a href="#cb40-56" aria-hidden="true" tabindex="-1"></a>  base64enc,       <span class="co"># Codificação Base64 (arquivos e APIs)</span></span>
<span id="cb40-57"><a href="#cb40-57" aria-hidden="true" tabindex="-1"></a>  viridis,</span>
<span id="cb40-58"><a href="#cb40-58" aria-hidden="true" tabindex="-1"></a>  DT, </span>
<span id="cb40-59"><a href="#cb40-59" aria-hidden="true" tabindex="-1"></a>  tidyr)</span>
<span id="cb40-60"><a href="#cb40-60" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-61"><a href="#cb40-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-62"><a href="#cb40-62" aria-hidden="true" tabindex="-1"></a><span class="fu">## Como gerar um token de acesso pessoal no GitHub</span></span>
<span id="cb40-63"><a href="#cb40-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-64"><a href="#cb40-64" aria-hidden="true" tabindex="-1"></a>O Personal Access Token (PAT) é uma credencial que substitui sua senha ao usar a API, CLI ou comandos Git via HTTPS. Ele garante autenticação segura e controle sobre o que pode ser acessado.</span>
<span id="cb40-65"><a href="#cb40-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-66"><a href="#cb40-66" aria-hidden="true" tabindex="-1"></a>**Etapas para gerar o token:**</span>
<span id="cb40-67"><a href="#cb40-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-68"><a href="#cb40-68" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Acesse sua conta GitHub. Entre em github.com com seu usuário e senha.</span>
<span id="cb40-69"><a href="#cb40-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-70"><a href="#cb40-70" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Abra as configurações do desenvolvedor. No canto superior direito, clique na sua foto de perfil - Settings - Developer Settings - Personal access tokens.</span>
<span id="cb40-71"><a href="#cb40-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-72"><a href="#cb40-72" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Crie um novo token. Clique em Generate new token (ou Create new token (fine-grained), se disponível).</span>
<span id="cb40-73"><a href="#cb40-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-74"><a href="#cb40-74" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>Defina as informações básicas.</span>
<span id="cb40-75"><a href="#cb40-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-76"><a href="#cb40-76" aria-hidden="true" tabindex="-1"></a><span class="ss">5.  </span>Dê um nome descritivo ao token (ex: token_api_portfolio);</span>
<span id="cb40-77"><a href="#cb40-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-78"><a href="#cb40-78" aria-hidden="true" tabindex="-1"></a><span class="ss">6.  </span>Escolha uma data de expiração adequada (por exemplo, 90 dias);</span>
<span id="cb40-79"><a href="#cb40-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-80"><a href="#cb40-80" aria-hidden="true" tabindex="-1"></a><span class="ss">7.  </span>Selecione apenas os escopos (permissões) necessários - por exemplo, marque repo para acesso a repositórios.</span>
<span id="cb40-81"><a href="#cb40-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-82"><a href="#cb40-82" aria-hidden="true" tabindex="-1"></a><span class="ss">8.  </span>Gere o token. Clique em Generate token para criar. Importante: copie o valor imediatamente ele não será mostrado novamente.</span>
<span id="cb40-83"><a href="#cb40-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-84"><a href="#cb40-84" aria-hidden="true" tabindex="-1"></a><span class="ss">9.  </span>Armazene o token com segurança. Guarde em local seguro, por exemplo, em um gerenciador de senhas ou em variáveis de ambiente como <span class="in">`Sys.setenv(GITHUB_TOKEN="...")`</span>.</span>
<span id="cb40-85"><a href="#cb40-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-86"><a href="#cb40-86" aria-hidden="true" tabindex="-1"></a>**Use o token em suas integrações. Esse token pode ser usado para:**</span>
<span id="cb40-87"><a href="#cb40-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-88"><a href="#cb40-88" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Autenticação em APIs, ex: **`httr2::req_auth_bearer_token()`**;</span>
<span id="cb40-89"><a href="#cb40-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-90"><a href="#cb40-90" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Operações Git via HTTPS (push/pull);</span>
<span id="cb40-91"><a href="#cb40-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-92"><a href="#cb40-92" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Execuções automatizadas em pipelines e scripts.</span>
<span id="cb40-93"><a href="#cb40-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-94"><a href="#cb40-94" aria-hidden="true" tabindex="-1"></a><span class="fu">## Função coleta_dados_github()</span></span>
<span id="cb40-95"><a href="#cb40-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-96"><a href="#cb40-96" aria-hidden="true" tabindex="-1"></a>Criei a função **`coleta_dados_github()`** para automatizar a leitura de arquivos diretamente de um repositório GitHub, sem necessidade de download manual. Ela utiliza o pacote **`httr2`**[^1] para realizar a requisição HTTP à **API do GitHub**<span class="ot">[^2]</span>, montando a URL de acesso a partir do nome do repositório, caminho do arquivo e branch especificados.</span>
<span id="cb40-97"><a href="#cb40-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-98"><a href="#cb40-98" aria-hidden="true" tabindex="-1"></a><span class="ot">[^1]: </span>Pacote <span class="co">[</span><span class="ot">**`httr2`**</span><span class="co">](https://httr2.r-lib.org/)</span> utilizado para consumo de APIs, via requisição <span class="co">[</span><span class="ot">**HTTP**</span><span class="co">](https://developer.mozilla.org/en-US/docs/Web/HTTP/Guides/Overview?utm_source=chatgpt.com)</span>.</span>
<span id="cb40-99"><a href="#cb40-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-100"><a href="#cb40-100" aria-hidden="true" tabindex="-1"></a><span class="ot">[^2]: </span>Acesse a documentação de como consumir a <span class="co">[</span><span class="ot">**API do GitHub**</span><span class="co">](https://docs.github.com/pt/rest/using-the-rest-api/getting-started-with-the-rest-api?apiVersion=2022-11-28)</span>.</span>
<span id="cb40-101"><a href="#cb40-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-102"><a href="#cb40-102" aria-hidden="true" tabindex="-1"></a>::: callout-important</span>
<span id="cb40-103"><a href="#cb40-103" aria-hidden="true" tabindex="-1"></a><span class="fu">## Importante</span></span>
<span id="cb40-104"><a href="#cb40-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-105"><a href="#cb40-105" aria-hidden="true" tabindex="-1"></a>Você precisa acessar o GitHub e gerar um **Token de Acesso Pessoal (PAT -Personal Access Token)**.</span>
<span id="cb40-106"><a href="#cb40-106" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb40-107"><a href="#cb40-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-108"><a href="#cb40-108" aria-hidden="true" tabindex="-1"></a>Caso o repositório exija autenticação, o token pessoal do GitHub é aplicado automaticamente via **`req_auth_bearer_token()`**.</span>
<span id="cb40-109"><a href="#cb40-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-110"><a href="#cb40-110" aria-hidden="true" tabindex="-1"></a>Após a conexão, a função valida o status da resposta e decodifica o conteúdo retornado, que vem em formato **`Base64`** padrão usado pela API para transmitir arquivos binários.</span>
<span id="cb40-111"><a href="#cb40-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-112"><a href="#cb40-112" aria-hidden="true" tabindex="-1"></a>O arquivo é temporariamente salvo e, em seguida, lido conforme sua extensão: arquivos .csv são importados com **`readr::read_csv()`** e planilhas .xlsx com **`readxl::read_excel()`**.</span>
<span id="cb40-113"><a href="#cb40-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-114"><a href="#cb40-114" aria-hidden="true" tabindex="-1"></a>Ao final, a função retorna um data frame limpo e pronto para análise, exibindo mensagens informativas sobre o número de linhas e colunas carregadas. Essa estrutura modular permite integração direta entre o GitHub e o pipeline experimental.</span>
<span id="cb40-115"><a href="#cb40-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-118"><a href="#cb40-118" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-119"><a href="#cb40-119" aria-hidden="true" tabindex="-1"></a>coleta_dados_github <span class="ot">&lt;-</span> <span class="cf">function</span>(repo, path, <span class="at">branch =</span> <span class="st">"main"</span>, <span class="at">token =</span> <span class="fu">Sys.getenv</span>(<span class="st">"GITHUB_TOKEN"</span>)) {</span>
<span id="cb40-120"><a href="#cb40-120" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(httr2)</span>
<span id="cb40-121"><a href="#cb40-121" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(readr)</span>
<span id="cb40-122"><a href="#cb40-122" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(readxl)</span>
<span id="cb40-123"><a href="#cb40-123" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(base64enc)</span>
<span id="cb40-124"><a href="#cb40-124" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(glue)</span>
<span id="cb40-125"><a href="#cb40-125" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-126"><a href="#cb40-126" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Mensagem de debug</span></span>
<span id="cb40-127"><a href="#cb40-127" aria-hidden="true" tabindex="-1"></a>  <span class="fu">message</span>(<span class="fu">glue</span>(<span class="st">"Conectando ao repositório {repo}, arquivo: {path}"</span>))</span>
<span id="cb40-128"><a href="#cb40-128" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-129"><a href="#cb40-129" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Monta a URL da API</span></span>
<span id="cb40-130"><a href="#cb40-130" aria-hidden="true" tabindex="-1"></a>  url <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"https://api.github.com/repos/"</span>, repo, <span class="st">"/contents/"</span>, path, <span class="st">"?ref="</span>, branch)</span>
<span id="cb40-131"><a href="#cb40-131" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-132"><a href="#cb40-132" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Requisição</span></span>
<span id="cb40-133"><a href="#cb40-133" aria-hidden="true" tabindex="-1"></a>  req <span class="ot">&lt;-</span> <span class="fu">request</span>(url)</span>
<span id="cb40-134"><a href="#cb40-134" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">nzchar</span>(token)) {</span>
<span id="cb40-135"><a href="#cb40-135" aria-hidden="true" tabindex="-1"></a>    req <span class="ot">&lt;-</span> <span class="fu">req_auth_bearer_token</span>(req, token)</span>
<span id="cb40-136"><a href="#cb40-136" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb40-137"><a href="#cb40-137" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-138"><a href="#cb40-138" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Executa a requisição</span></span>
<span id="cb40-139"><a href="#cb40-139" aria-hidden="true" tabindex="-1"></a>  resp <span class="ot">&lt;-</span> <span class="fu">req_perform</span>(req)</span>
<span id="cb40-140"><a href="#cb40-140" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-141"><a href="#cb40-141" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Se falhar, mostra status</span></span>
<span id="cb40-142"><a href="#cb40-142" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">resp_status</span>(resp) <span class="sc">&gt;=</span> <span class="dv">300</span>) {</span>
<span id="cb40-143"><a href="#cb40-143" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="fu">glue</span>(<span class="st">"Falha ao acessar GitHub: HTTP {resp_status(resp)}. Verifique o token, repo e caminho."</span>))</span>
<span id="cb40-144"><a href="#cb40-144" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb40-145"><a href="#cb40-145" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-146"><a href="#cb40-146" aria-hidden="true" tabindex="-1"></a>  obj <span class="ot">&lt;-</span> <span class="fu">resp_body_json</span>(resp)</span>
<span id="cb40-147"><a href="#cb40-147" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.null</span>(obj<span class="sc">$</span>content)) {</span>
<span id="cb40-148"><a href="#cb40-148" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">"Conteúdo vazio verifique se o caminho aponta para um arquivo, não para uma pasta."</span>)</span>
<span id="cb40-149"><a href="#cb40-149" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb40-150"><a href="#cb40-150" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-151"><a href="#cb40-151" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Decodifica o arquivo em base64</span></span>
<span id="cb40-152"><a href="#cb40-152" aria-hidden="true" tabindex="-1"></a>  raw <span class="ot">&lt;-</span> <span class="fu">base64decode</span>(obj<span class="sc">$</span>content)</span>
<span id="cb40-153"><a href="#cb40-153" aria-hidden="true" tabindex="-1"></a>  ext <span class="ot">&lt;-</span> tools<span class="sc">::</span><span class="fu">file_ext</span>(path)</span>
<span id="cb40-154"><a href="#cb40-154" aria-hidden="true" tabindex="-1"></a>  tmp <span class="ot">&lt;-</span> <span class="fu">tempfile</span>(<span class="at">fileext =</span> <span class="fu">paste0</span>(<span class="st">"."</span>, ext))</span>
<span id="cb40-155"><a href="#cb40-155" aria-hidden="true" tabindex="-1"></a>  <span class="fu">writeBin</span>(raw, tmp)</span>
<span id="cb40-156"><a href="#cb40-156" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-157"><a href="#cb40-157" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Lê conforme o tipo</span></span>
<span id="cb40-158"><a href="#cb40-158" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (ext <span class="sc">==</span> <span class="st">"csv"</span>) {</span>
<span id="cb40-159"><a href="#cb40-159" aria-hidden="true" tabindex="-1"></a>    dados <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(tmp, <span class="at">show_col_types =</span> <span class="cn">FALSE</span>)</span>
<span id="cb40-160"><a href="#cb40-160" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (ext <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"xlsx"</span>, <span class="st">"xls"</span>)) {</span>
<span id="cb40-161"><a href="#cb40-161" aria-hidden="true" tabindex="-1"></a>    dados <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(tmp)</span>
<span id="cb40-162"><a href="#cb40-162" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb40-163"><a href="#cb40-163" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">"Formato não suportado: use .csv, .xlsx ou .xls"</span>)</span>
<span id="cb40-164"><a href="#cb40-164" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb40-165"><a href="#cb40-165" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-166"><a href="#cb40-166" aria-hidden="true" tabindex="-1"></a>  <span class="fu">message</span>(<span class="fu">glue</span>(<span class="st">"Dados carregados com sucesso ({nrow(dados)} linhas, {ncol(dados)} colunas)."</span>))</span>
<span id="cb40-167"><a href="#cb40-167" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(dados)</span>
<span id="cb40-168"><a href="#cb40-168" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb40-169"><a href="#cb40-169" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-170"><a href="#cb40-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-171"><a href="#cb40-171" aria-hidden="true" tabindex="-1"></a><span class="fu">## Importação dos dados via API do GitHub</span></span>
<span id="cb40-172"><a href="#cb40-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-173"><a href="#cb40-173" aria-hidden="true" tabindex="-1"></a><span class="fu">### Para repositórios públicos</span></span>
<span id="cb40-174"><a href="#cb40-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-175"><a href="#cb40-175" aria-hidden="true" tabindex="-1"></a>Nesta etapa, foi realizada a importação automatizada dos dados diretamente do GitHub, garantindo reprodutibilidade e versionamento do experimento. A função **`coleta_dados_github()`** foi desenvolvida previamente e armazenada no **diretório funcoes/**, sendo responsável por estabelecer a conexão com o repositório público, localizar o arquivo especificado e fazer o download temporário antes de ler o conteúdo com o pacote **`readxl`**.</span>
<span id="cb40-176"><a href="#cb40-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-177"><a href="#cb40-177" aria-hidden="true" tabindex="-1"></a>Essa abordagem elimina a necessidade de armazenar arquivos localmente e permite atualizar os dados sempre que o repositório for modificado. Em seguida, a função **`glimpse()`** é utilizada para inspecionar rapidamente a estrutura do dataset, verificando nomes, tipos e exemplos das variáveis que serão analisadas nos próximos blocos.</span>
<span id="cb40-178"><a href="#cb40-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-181"><a href="#cb40-181" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-182"><a href="#cb40-182" aria-hidden="true" tabindex="-1"></a><span class="co"># Carrega a função de coleta de dados (salva em funcoes/coleta_dados_github.R)</span></span>
<span id="cb40-183"><a href="#cb40-183" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"meu_projeto/funcoes/coleta_dados_github.R"</span>)</span>
<span id="cb40-184"><a href="#cb40-184" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-185"><a href="#cb40-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-188"><a href="#cb40-188" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-189"><a href="#cb40-189" aria-hidden="true" tabindex="-1"></a><span class="co"># Coleta dos dados direto do repositório público</span></span>
<span id="cb40-190"><a href="#cb40-190" aria-hidden="true" tabindex="-1"></a>dados <span class="ot">&lt;-</span> <span class="fu">coleta_dados_github</span>(</span>
<span id="cb40-191"><a href="#cb40-191" aria-hidden="true" tabindex="-1"></a>  <span class="at">repo =</span> <span class="st">"JenniferLopes/portfolio_experimentacao_agricola"</span>,</span>
<span id="cb40-192"><a href="#cb40-192" aria-hidden="true" tabindex="-1"></a>  <span class="at">path =</span> <span class="st">"meu_projeto/dados/alpha_lattice.xlsx"</span>)</span>
<span id="cb40-193"><a href="#cb40-193" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-194"><a href="#cb40-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-197"><a href="#cb40-197" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-198"><a href="#cb40-198" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualiza estrutura do dataset</span></span>
<span id="cb40-199"><a href="#cb40-199" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(dados)</span>
<span id="cb40-200"><a href="#cb40-200" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-201"><a href="#cb40-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-202"><a href="#cb40-202" aria-hidden="true" tabindex="-1"></a><span class="fu">## **Delineamento Alpha-Lattice**</span></span>
<span id="cb40-203"><a href="#cb40-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-204"><a href="#cb40-204" aria-hidden="true" tabindex="-1"></a>O delineamento **`Alpha-Lattice`**<span class="ot">[^3]</span> é uma variação do látice incompleto balanceado desenvolvido para experimentos com grande número de tratamentos (genótipos) e número limitado de repetições.</span>
<span id="cb40-205"><a href="#cb40-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-206"><a href="#cb40-206" aria-hidden="true" tabindex="-1"></a><span class="ot">[^3]: </span>A new class of resolvable incomplete block designs - <span class="co">[</span><span class="ot">**Artigo completo**</span><span class="co">](https://academic.oup.com/biomet/article-abstract/63/1/83/237118?redirectedFrom=fulltext&amp;login=false)</span>.</span>
<span id="cb40-207"><a href="#cb40-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-208"><a href="#cb40-208" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Ele organiza os tratamentos em blocos incompletos de tamanho fixo, distribuídos aleatoriamente dentro de cada repetição, de forma que cada par de tratamentos ocorra juntos em um número balanceado (ou quase balanceado) de blocos.</span>
<span id="cb40-209"><a href="#cb40-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-210"><a href="#cb40-210" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Essa estrutura reduz a variabilidade dentro dos blocos e aumenta a precisão experimental, especialmente quando há heterogeneidade no campo.</span>
<span id="cb40-211"><a href="#cb40-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-212"><a href="#cb40-212" aria-hidden="true" tabindex="-1"></a>O modelo estatístico para o delineamento Alpha-Lattice inclui efeitos de tratamentos (genótipos), repetições e blocos dentro das repetições, permitindo ajustar as diferenças ambientais por meio de modelos lineares mistos (REML/BLUP).</span>
<span id="cb40-213"><a href="#cb40-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-214"><a href="#cb40-214" aria-hidden="true" tabindex="-1"></a>Por isso, ele é amplamente utilizado em programas de melhoramento genético de plantas, onde se avaliam dezenas ou centenas de linhagens experimentais. Além de aumentar a eficiência da comparação entre genótipos, o delineamento Alpha-Lattice viabiliza o uso de componentes de variância e herdabilidade, fornecendo base sólida para a seleção genotípica mais precisa.</span>
<span id="cb40-215"><a href="#cb40-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-216"><a href="#cb40-216" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sobre os dados experimentais - Simulados</span></span>
<span id="cb40-217"><a href="#cb40-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-218"><a href="#cb40-218" aria-hidden="true" tabindex="-1"></a>Os dados analisados neste experimento correspondem a um ensaio de avaliação de genótipos conduzido sob delineamento em blocos incompletos do tipo Alpha-Lattice, com o objetivo de estimar parâmetros genéticos e identificar materiais superiores em termos de produtividade.</span>
<span id="cb40-219"><a href="#cb40-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-220"><a href="#cb40-220" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>O conjunto de dados contém informações de:</span>
<span id="cb40-221"><a href="#cb40-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-222"><a href="#cb40-222" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>produção por parcela (prod);</span>
<span id="cb40-223"><a href="#cb40-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-224"><a href="#cb40-224" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>genótipos avaliados (gen);</span>
<span id="cb40-225"><a href="#cb40-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-226"><a href="#cb40-226" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>repetições (rep);</span>
<span id="cb40-227"><a href="#cb40-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-228"><a href="#cb40-228" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>blocos incompletos (inc.bloco);</span>
<span id="cb40-229"><a href="#cb40-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-230"><a href="#cb40-230" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Além das coordenadas de campo utilizadas para a construção do croqui experimental, col (clouna) e row (linha);</span>
<span id="cb40-231"><a href="#cb40-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-232"><a href="#cb40-232" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Cada repetição foi subdividida em blocos menores, chamados de subblocos para reduzir o efeito da variabilidade ambiental e aumentar a precisão das comparações entre genótipos.</span>
<span id="cb40-233"><a href="#cb40-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-234"><a href="#cb40-234" aria-hidden="true" tabindex="-1"></a><span class="fu">## Ajuste das variáveis</span></span>
<span id="cb40-235"><a href="#cb40-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-236"><a href="#cb40-236" aria-hidden="true" tabindex="-1"></a>Neste passo, realizei o ajuste das variáveis categóricas do conjunto de dados para garantir que o modelo estatístico reconheça corretamente os fatores experimentais.</span>
<span id="cb40-237"><a href="#cb40-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-238"><a href="#cb40-238" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>As colunas correspondentes a genótipos (gen), repetições (rep) e blocos incompletos (inc.bloco) são convertidas para o tipo factor, utilizando a função **`mutate()`** do **`dplyr`**.</span>
<span id="cb40-239"><a href="#cb40-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-240"><a href="#cb40-240" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Essa conversão é essencial em análises de experimentação agrícola, pois esses efeitos representam níveis de tratamento e estruturas hierárquicas que devem ser tratadas como variáveis qualitativas, e não numéricas.</span>
<span id="cb40-241"><a href="#cb40-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-244"><a href="#cb40-244" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-245"><a href="#cb40-245" aria-hidden="true" tabindex="-1"></a>dados <span class="ot">&lt;-</span> dados <span class="sc">%&gt;%</span></span>
<span id="cb40-246"><a href="#cb40-246" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb40-247"><a href="#cb40-247" aria-hidden="true" tabindex="-1"></a>    <span class="at">gen =</span> <span class="fu">as.factor</span>(gen),</span>
<span id="cb40-248"><a href="#cb40-248" aria-hidden="true" tabindex="-1"></a>    <span class="at">rep =</span> <span class="fu">as.factor</span>(rep),</span>
<span id="cb40-249"><a href="#cb40-249" aria-hidden="true" tabindex="-1"></a>    <span class="at">inc.bloco =</span> <span class="fu">as.factor</span>(inc.bloco))</span>
<span id="cb40-250"><a href="#cb40-250" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-251"><a href="#cb40-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-252"><a href="#cb40-252" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sobre o experimento</span></span>
<span id="cb40-253"><a href="#cb40-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-254"><a href="#cb40-254" aria-hidden="true" tabindex="-1"></a>Foram avaliados, 24 genótipos, em 3 repetições, com 6 blocos incompletos.</span>
<span id="cb40-255"><a href="#cb40-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-258"><a href="#cb40-258" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-259"><a href="#cb40-259" aria-hidden="true" tabindex="-1"></a>resumo <span class="ot">&lt;-</span> dados <span class="sc">%&gt;%</span></span>
<span id="cb40-260"><a href="#cb40-260" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb40-261"><a href="#cb40-261" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_genotipos   =</span> <span class="fu">n_distinct</span>(gen),</span>
<span id="cb40-262"><a href="#cb40-262" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_repeticoes  =</span> <span class="fu">n_distinct</span>(rep),</span>
<span id="cb40-263"><a href="#cb40-263" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_blocos_inc  =</span> <span class="fu">n_distinct</span>(inc.bloco))</span>
<span id="cb40-264"><a href="#cb40-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-265"><a href="#cb40-265" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(resumo)</span>
<span id="cb40-266"><a href="#cb40-266" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-267"><a href="#cb40-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-268"><a href="#cb40-268" aria-hidden="true" tabindex="-1"></a><span class="fu">## Croqui experimental</span></span>
<span id="cb40-269"><a href="#cb40-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-270"><a href="#cb40-270" aria-hidden="true" tabindex="-1"></a>O croqui do experimento, foi representado graficamente no delineamento alpha-lattice. Para isso, utilizei o pacote **`ggplot2`**, mapeando as coordenadas de campo onde cada célula **`geom_tile()`** representa uma unidade experimental e é identificada pelo respectivo genótipo (label = gen).</span>
<span id="cb40-271"><a href="#cb40-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-272"><a href="#cb40-272" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>A coloração das parcelas foi definida pela variável inc.bloco, permitindo destacar visualmente os blocos incompletos. Em seguida, apliquei **`facet_wrap(~ rep)`** para separar as repetições em painéis distintos, o que facilita a inspeção da uniformidade entre blocos dentro de cada repetição.</span>
<span id="cb40-273"><a href="#cb40-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-276"><a href="#cb40-276" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-277"><a href="#cb40-277" aria-hidden="true" tabindex="-1"></a>dados <span class="ot">&lt;-</span> dados <span class="sc">%&gt;%</span></span>
<span id="cb40-278"><a href="#cb40-278" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">inc.bloco =</span> <span class="fu">as.factor</span>(inc.bloco))</span>
<span id="cb40-279"><a href="#cb40-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-280"><a href="#cb40-280" aria-hidden="true" tabindex="-1"></a>croqui <span class="ot">&lt;-</span> dados <span class="sc">%&gt;%</span></span>
<span id="cb40-281"><a href="#cb40-281" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> col, <span class="at">y =</span> row, <span class="at">fill =</span> inc.bloco)) <span class="sc">+</span></span>
<span id="cb40-282"><a href="#cb40-282" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb40-283"><a href="#cb40-283" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> gen), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb40-284"><a href="#cb40-284" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">"C"</span>, <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb40-285"><a href="#cb40-285" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb40-286"><a href="#cb40-286" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> rep, <span class="at">scales =</span> <span class="st">"free_x"</span>) <span class="sc">+</span></span>
<span id="cb40-287"><a href="#cb40-287" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb40-288"><a href="#cb40-288" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Croqui de Campo - Portfólio Experimental"</span>,</span>
<span id="cb40-289"><a href="#cb40-289" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Colunas"</span>,</span>
<span id="cb40-290"><a href="#cb40-290" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Linhas"</span>,</span>
<span id="cb40-291"><a href="#cb40-291" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Bloco incompleto"</span>, </span>
<span id="cb40-292"><a href="#cb40-292" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"Jennifer Lopes."</span>)</span>
<span id="cb40-293"><a href="#cb40-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-294"><a href="#cb40-294" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(croqui)</span>
<span id="cb40-295"><a href="#cb40-295" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-296"><a href="#cb40-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-297"><a href="#cb40-297" aria-hidden="true" tabindex="-1"></a><span class="fu">## Análise descritiva</span></span>
<span id="cb40-298"><a href="#cb40-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-299"><a href="#cb40-299" aria-hidden="true" tabindex="-1"></a>Foi realizada à análise descritiva da variável produtividade (prod), utilizando a função **`desc_stat()`** do pacote **`metan`**<span class="ot">[^4]</span>.</span>
<span id="cb40-300"><a href="#cb40-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-301"><a href="#cb40-301" aria-hidden="true" tabindex="-1"></a><span class="ot">[^4]: </span>Acesse a documentação do pacote <span class="co">[</span><span class="ot">**metan: Multi Environment Trials Analysis**</span><span class="co">](https://cran.r-project.org/web/packages/metan/index.html)</span>.</span>
<span id="cb40-302"><a href="#cb40-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-303"><a href="#cb40-303" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Essa função permite gerar estatísticas resumo como média, mediana, desvio-padrão, coeficiente de variação e amplitude e, quando **`hist = TRUE`**, apresenta o histograma da distribuição dos dados.</span>
<span id="cb40-304"><a href="#cb40-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-305"><a href="#cb40-305" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>O argumento **`stats = "main"`** foi utilizado para focar nos indicadores principais, garantindo uma leitura rápida e objetiva das medidas de tendência central e dispersão.</span>
<span id="cb40-306"><a href="#cb40-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-309"><a href="#cb40-309" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-310"><a href="#cb40-310" aria-hidden="true" tabindex="-1"></a><span class="co">#|warning: false</span></span>
<span id="cb40-311"><a href="#cb40-311" aria-hidden="true" tabindex="-1"></a>descritiva <span class="ot">&lt;-</span> dados <span class="sc">%&gt;%</span></span>
<span id="cb40-312"><a href="#cb40-312" aria-hidden="true" tabindex="-1"></a>  metan<span class="sc">::</span><span class="fu">desc_stat</span>(prod, <span class="at">hist =</span> <span class="cn">TRUE</span>, <span class="at">stats =</span> <span class="st">"main"</span>)</span>
<span id="cb40-313"><a href="#cb40-313" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-314"><a href="#cb40-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-315"><a href="#cb40-315" aria-hidden="true" tabindex="-1"></a>O histograma gerado pela função **`desc_stat()`** representa a distribuição dos valores observados de produtividade (prod) entre os genótipos avaliados.</span>
<span id="cb40-316"><a href="#cb40-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-317"><a href="#cb40-317" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Observa-se uma concentração predominante de parcelas com produtividade entre 35.000 e 50.000 kg/ha, indicando que a maior parte dos genótipos apresenta desempenho médio a alto.</span>
<span id="cb40-318"><a href="#cb40-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-319"><a href="#cb40-319" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Há também um pequeno grupo com valores muito baixos, próximos de zero, que provavelmente correspondem a falhas de campo ou perdas experimentais.</span>
<span id="cb40-320"><a href="#cb40-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-321"><a href="#cb40-321" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Essa dispersão assimétrica sugere a presença de heterogeneidade entre genótipos e blocos, reforçando a necessidade do uso de modelos mistos (**`REML/BLUP`**) nas etapas seguintes, para separar o componente genético do ambiental e obter estimativas mais precisas dos efeitos.</span>
<span id="cb40-322"><a href="#cb40-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-325"><a href="#cb40-325" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-326"><a href="#cb40-326" aria-hidden="true" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(descritiva)</span>
<span id="cb40-327"><a href="#cb40-327" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-328"><a href="#cb40-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-329"><a href="#cb40-329" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>A tabela de estatísticas descritivas resume o comportamento da variável de produtividade (prod) no experimento. Ao interpretar os resultados, é possível observar que a média foi de aproximadamente 39.772 kg/ha, enquanto a mediana foi de 43.138 kg/ha, indicando uma leve assimetria negativa ou seja, há algumas parcelas com produtividade mais baixa que puxam a média para baixo.</span>
<span id="cb40-330"><a href="#cb40-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-331"><a href="#cb40-331" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>O valor máximo (58.757 kg/ha) representa o melhor desempenho entre os genótipos avaliados, e o mínimo (3.342 kg/ha) confirma a presença de valores muito baixos observados no histograma, possivelmente relacionados a falhas de campo.</span>
<span id="cb40-332"><a href="#cb40-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-333"><a href="#cb40-333" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>O desvio-padrão (14.605) e o coeficiente de variação (36,7%) refletem alta variabilidade experimental, o que é esperado em populações ainda segregantes.</span>
<span id="cb40-334"><a href="#cb40-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-335"><a href="#cb40-335" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Já o erro padrão da média (1.721) e o intervalo de confiança (±3.432) indicam boa precisão das estimativas, considerando o número de observações válidas (n = 72).</span>
<span id="cb40-336"><a href="#cb40-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-337"><a href="#cb40-337" aria-hidden="true" tabindex="-1"></a><span class="fu">## Modelagem estatística</span></span>
<span id="cb40-338"><a href="#cb40-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-339"><a href="#cb40-339" aria-hidden="true" tabindex="-1"></a>Nesta etapa, ajustei dois modelos lineares mistos para avaliar a produtividade dos genótipos no delineamento alpha-lattice, explorando duas abordagens distintas:</span>
<span id="cb40-340"><a href="#cb40-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-341"><a href="#cb40-341" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Efeito fixo e efeito aleatório. Essa comparação é essencial para compreender o comportamento da variável de interesse sob diferentes pressupostos de inferência e para decidir qual estratégia oferece estimativas mais adequadas ao objetivo experimental.</span>
<span id="cb40-342"><a href="#cb40-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-343"><a href="#cb40-343" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Modelo 1 - Genótipo como efeito fixo (BLUEs)</span></span>
<span id="cb40-344"><a href="#cb40-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-345"><a href="#cb40-345" aria-hidden="true" tabindex="-1"></a>Essa abordagem gera as Estimativas Lineares Não Viesadas (BLUEs), que representam as médias ajustadas dos genótipos após o controle dos efeitos de repetição e blocos incompletos. Esse tipo de modelagem é apropriado quando o interesse está em comparar diretamente os genótipos avaliados no experimento, sem extrapolar conclusões para um conjunto maior de materiais genéticos. Utilizei a função <span class="in">`anova()`</span> com o método <span class="in">`Kenward–Roger`</span><span class="ot">[^5]</span> para obter o teste de significância dos efeitos fixos. Além disso, avaliei os resíduos e a sua normalidade, a fim de verificar o atendimento aos pressupostos do modelo.</span>
<span id="cb40-346"><a href="#cb40-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-347"><a href="#cb40-347" aria-hidden="true" tabindex="-1"></a><span class="ot">[^5]: </span>Kenward-Roger: <span class="co">[</span><span class="ot">**Artigo completo**</span><span class="co">](https://www.jstor.org/stable/2533558?origin=crossref)</span>.</span>
<span id="cb40-348"><a href="#cb40-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-351"><a href="#cb40-351" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-352"><a href="#cb40-352" aria-hidden="true" tabindex="-1"></a>mod.fg <span class="ot">&lt;-</span> <span class="fu">lmer</span>(prod <span class="sc">~</span> gen <span class="sc">+</span> rep <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> rep<span class="sc">:</span>inc.bloco), <span class="at">data =</span> dados)</span>
<span id="cb40-353"><a href="#cb40-353" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-354"><a href="#cb40-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-355"><a href="#cb40-355" aria-hidden="true" tabindex="-1"></a>**O modelo matemático foi especificado da seguinte forma:**</span>
<span id="cb40-356"><a href="#cb40-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-357"><a href="#cb40-357" aria-hidden="true" tabindex="-1"></a>$yijk​=μ+gi​+rj​+bk(j)​+εijk$</span>
<span id="cb40-358"><a href="#cb40-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-359"><a href="#cb40-359" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Componentes <span class="pp">|</span> Descrição <span class="pp">|</span></span>
<span id="cb40-360"><a href="#cb40-360" aria-hidden="true" tabindex="-1"></a><span class="pp">|----|----|</span></span>
<span id="cb40-361"><a href="#cb40-361" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> $y_{ijk}$ <span class="pp">|</span> Observação do rendimento do genótipo (*i*) na repetição (*j*) e bloco incompleto (*k*) <span class="pp">|</span></span>
<span id="cb40-362"><a href="#cb40-362" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> $u$ <span class="pp">|</span> Média geral do experimento <span class="pp">|</span></span>
<span id="cb40-363"><a href="#cb40-363" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> $g_i$ <span class="pp">|</span> Efeito fixo do genótipo $i = 1, 2, \ldots, G$ <span class="pp">|</span></span>
<span id="cb40-364"><a href="#cb40-364" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> $r_j$ <span class="pp">|</span> Efeito fixo da repetição $j = 1, 2, \ldots,R$ <span class="pp">|</span></span>
<span id="cb40-365"><a href="#cb40-365" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> $b_{k(j)}$ <span class="pp">|</span> Efeito aleatório do bloco incompleto (*k*) dentro da repetição (j), assumindo $b_{k(j)} \sim N(0, \sigma_b^2)$ <span class="pp">|</span></span>
<span id="cb40-366"><a href="#cb40-366" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> $\varepsilon_{ijk}$ <span class="pp">|</span> Erro aleatório, assumindo $\varepsilon_{ijk} \sim N(0, \sigma_e^2)$ e independentes entre si <span class="pp">|</span></span>
<span id="cb40-367"><a href="#cb40-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-368"><a href="#cb40-368" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Diagnóstico de resíduos</span></span>
<span id="cb40-369"><a href="#cb40-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-370"><a href="#cb40-370" aria-hidden="true" tabindex="-1"></a>O gráfico Resíduos x Ajustados do modelo fixo (BLUE) mostra a dispersão dos resíduos em relação aos valores ajustados pelo modelo.</span>
<span id="cb40-371"><a href="#cb40-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-372"><a href="#cb40-372" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Ao analisar o gráfico, foi possível observar uma distribuição aleatória dos pontos ao redor da linha zero, sem tendência clara, o que indica que o modelo não apresenta viés sistemático na predição da produtividade.</span>
<span id="cb40-373"><a href="#cb40-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-374"><a href="#cb40-374" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>No entanto, é possível verificar também, uma maior variabilidade dos resíduos em níveis intermediários e altos de produtividade, sugerindo heterocedasticidade leve, isto é, variação desigual do erro entre os níveis de resposta.</span>
<span id="cb40-375"><a href="#cb40-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-376"><a href="#cb40-376" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Apesar disso, os resíduos permanecem majoritariamente centrados em torno de zero, o que é desejável em um modelo bem ajustado.</span>
<span id="cb40-377"><a href="#cb40-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-378"><a href="#cb40-378" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Em experimentos agrícolas, pequenas variações são esperadas devido a fatores ambientais e do campo experimental, mas o padrão geral indica que o modelo fixo se ajusta adequadamente aos dados observados.</span>
<span id="cb40-379"><a href="#cb40-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-382"><a href="#cb40-382" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-383"><a href="#cb40-383" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">resid</span>(mod.fg) <span class="sc">~</span> <span class="fu">fitted</span>(mod.fg),</span>
<span id="cb40-384"><a href="#cb40-384" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Resíduos vs Ajustados - Modelo Fixo (BLUE)"</span>)</span>
<span id="cb40-385"><a href="#cb40-385" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-386"><a href="#cb40-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-387"><a href="#cb40-387" aria-hidden="true" tabindex="-1"></a>No gráfico Q-Q Plot do modelo fixo, foi avaliada a normalidade dos resíduos, comparando os quantis observados (eixo y) com os quantis teóricos da distribuição normal (eixo x).</span>
<span id="cb40-388"><a href="#cb40-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-389"><a href="#cb40-389" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Visualmente, observei que a maioria dos pontos segue próxima da linha diagonal, indicando que os resíduos apresentam comportamento aproximadamente normal.</span>
<span id="cb40-390"><a href="#cb40-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-391"><a href="#cb40-391" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Apenas pequenas deformações nas extremidades (caudas) sugerem uma leve assimetria, o que é comum em dados de produtividade agrícola, especialmente em populações ainda segregantes.</span>
<span id="cb40-392"><a href="#cb40-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-393"><a href="#cb40-393" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Essa análise é importante porque a suposição de normalidade dos erros garante a validade dos testes F e das estimativas de variância no modelo.</span>
<span id="cb40-394"><a href="#cb40-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-395"><a href="#cb40-395" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Apesar das pequenas discrepâncias nas caudas, o ajuste é considerado adequado para fins de inferência, não comprometendo a interpretação dos efeitos fixos e a obtenção das médias ajustadas (BLUEs).</span>
<span id="cb40-396"><a href="#cb40-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-399"><a href="#cb40-399" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-400"><a href="#cb40-400" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(mod.fg)); <span class="fu">qqline</span>(<span class="fu">resid</span>(mod.fg))</span>
<span id="cb40-401"><a href="#cb40-401" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-402"><a href="#cb40-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-403"><a href="#cb40-403" aria-hidden="true" tabindex="-1"></a><span class="fu">#### ANOVA para efeitos fixos</span></span>
<span id="cb40-404"><a href="#cb40-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-405"><a href="#cb40-405" aria-hidden="true" tabindex="-1"></a>Em seguida, foi realizada à análise de variância (ANOVA) para o modelo com genótipos tratados como efeitos fixos, utilizando o método Kenward-Roger para o cálculo dos graus de liberdade (ddf = Kenward-Roger).</span>
<span id="cb40-406"><a href="#cb40-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-407"><a href="#cb40-407" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Essa abordagem é mais apropriada em experimentos com número limitado de repetições e estruturas desbalanceadas, pois ajusta a variância dos erros e fornece testes F mais precisos.</span>
<span id="cb40-408"><a href="#cb40-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-409"><a href="#cb40-409" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>O objetivo aqui, foi avaliar a significância dos efeitos de genótipo, repetição e blocos incompletos sobre a produtividade.</span>
<span id="cb40-410"><a href="#cb40-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-411"><a href="#cb40-411" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Quando o efeito de genótipo é significativo, isso indica que existe variabilidade real entre os materiais avaliados, justificando o prosseguimento da análise com comparações múltiplas e estimativas médias ajustadas (BLUEs).</span>
<span id="cb40-412"><a href="#cb40-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-413"><a href="#cb40-413" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Além disso, essa etapa permite confirmar se a estrutura do delineamento (blocos incompletos dentro de repetições) foi eficiente em controlar a heterogeneidade experimental, garantindo que as diferenças observadas entre genótipos sejam atribuídas majoritariamente a causas genéticas e não ao ruído ambiental.</span>
<span id="cb40-414"><a href="#cb40-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-417"><a href="#cb40-417" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-418"><a href="#cb40-418" aria-hidden="true" tabindex="-1"></a>anova_fg <span class="ot">&lt;-</span> <span class="fu">anova</span>(mod.fg, <span class="at">ddf =</span> <span class="st">"Kenward-Roger"</span>)</span>
<span id="cb40-419"><a href="#cb40-419" aria-hidden="true" tabindex="-1"></a>anova_fg</span>
<span id="cb40-420"><a href="#cb40-420" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-421"><a href="#cb40-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-422"><a href="#cb40-422" aria-hidden="true" tabindex="-1"></a>A tabela da ANOVA com o método de **Kenward-Roger** apresenta os testes de significância para os efeitos fixos incluídos no modelo.</span>
<span id="cb40-423"><a href="#cb40-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-424"><a href="#cb40-424" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Ao interpretar os resultados, foi possível observar que o efeito de genótipo foi significativo (F=1,93; p=0,03598), indicando que existe variabilidade estatisticamente detectável entre os genótipos avaliados quanto à produtividade.</span>
<span id="cb40-425"><a href="#cb40-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-426"><a href="#cb40-426" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Esse resultado confirma que as diferenças observadas não se devem apenas ao acaso, mas refletem diferenças genéticas reais entre os materiais testados.</span>
<span id="cb40-427"><a href="#cb40-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-428"><a href="#cb40-428" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Por outro lado, o efeito de repetição (F=0,02; p=0,88126) não foi significativo, o que sugere que as condições experimentais entre as repetições foram homogêneas, sem variações no ambiente.</span>
<span id="cb40-429"><a href="#cb40-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-430"><a href="#cb40-430" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; A significância do fator genótipo valida o uso do modelo misto na sequência da análise, permitindo estimar as médias ajustadas (BLUEs) e, posteriormente, comparar o desempenho dos materiais.</span></span>
<span id="cb40-431"><a href="#cb40-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-432"><a href="#cb40-432" aria-hidden="true" tabindex="-1"></a>::: callout-important</span>
<span id="cb40-433"><a href="#cb40-433" aria-hidden="true" tabindex="-1"></a><span class="fu">## Importante</span></span>
<span id="cb40-434"><a href="#cb40-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-435"><a href="#cb40-435" aria-hidden="true" tabindex="-1"></a>A ANOVA Tipo III foi utilizada porque o modelo ajustado não é completamente ortogonal ou seja, os efeitos dos fatores (genótipos, repetições e blocos) não são totalmente independentes. Nesse tipo de modelo, cada termo deve ser avaliado ajustando-se para os demais fatores presentes.</span>
<span id="cb40-436"><a href="#cb40-436" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb40-437"><a href="#cb40-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-438"><a href="#cb40-438" aria-hidden="true" tabindex="-1"></a><span class="fu">### Modelo 2: Genótipo como efeito aleatório - BLUPs</span></span>
<span id="cb40-439"><a href="#cb40-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-440"><a href="#cb40-440" aria-hidden="true" tabindex="-1"></a>Neste segundo modelo, considerei o genótipo como efeito aleatório, o que transforma a natureza da inferência do modelo.</span>
<span id="cb40-441"><a href="#cb40-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-442"><a href="#cb40-442" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Essa modelagem tem como objetivo predizer o valor genético dos genótipos ou seja, estimar seus BLUPs (Best Linear Unbiased Predictors).</span>
<span id="cb40-443"><a href="#cb40-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-444"><a href="#cb40-444" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Enquanto o modelo fixo fornece médias ajustadas (BLUEs) apenas para os genótipos testados, este modelo permite inferir sobre uma população maior, tratando os genótipos como uma amostra aleatória dentro do programa de melhoramento.</span>
<span id="cb40-445"><a href="#cb40-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-446"><a href="#cb40-446" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Essa abordagem é mais realista no contexto do melhoramento genético vegetal, pois considera a variabilidade genética como um componente da variância total e reduz o impacto de observações extremas.</span>
<span id="cb40-447"><a href="#cb40-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-448"><a href="#cb40-448" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Além disso, ao estimar simultaneamente as variâncias genética $σg2$, de bloco $σb2​$ e residual $σr2$, o modelo fornece base para calcular parâmetros genéticos, como herdabilidade e acurácia seletiva fundamentais para a etapa de seleção de linhagens promissoras.</span>
<span id="cb40-449"><a href="#cb40-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-452"><a href="#cb40-452" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-453"><a href="#cb40-453" aria-hidden="true" tabindex="-1"></a>mod.rg <span class="ot">&lt;-</span> <span class="fu">lmer</span>(prod <span class="sc">~</span> rep <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> gen) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> rep<span class="sc">:</span>inc.bloco), <span class="at">data =</span> dados)</span>
<span id="cb40-454"><a href="#cb40-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-455"><a href="#cb40-455" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-456"><a href="#cb40-456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-457"><a href="#cb40-457" aria-hidden="true" tabindex="-1"></a>**O modelo matemático foi especificado da seguinte forma:**</span>
<span id="cb40-458"><a href="#cb40-458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-459"><a href="#cb40-459" aria-hidden="true" tabindex="-1"></a>$yijk​=μ+rj​+gi​+bk(j)​+εijk$​</span>
<span id="cb40-460"><a href="#cb40-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-461"><a href="#cb40-461" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Símbolo <span class="pp">|</span> Descrição <span class="pp">|</span> Tipo de efeito <span class="pp">|</span> Distribuição assumida <span class="pp">|</span></span>
<span id="cb40-462"><a href="#cb40-462" aria-hidden="true" tabindex="-1"></a><span class="pp">|----|----|----|----|</span></span>
<span id="cb40-463"><a href="#cb40-463" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> $y_{ijk}$ <span class="pp">|</span> Valor observado do rendimento do genótipo (*i*) na repetição (*j*) e bloco (*k*) <span class="pp">|</span> <span class="sc">\-</span> <span class="pp">|</span> <span class="sc">\-</span> <span class="pp">|</span></span>
<span id="cb40-464"><a href="#cb40-464" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> $u$ <span class="pp">|</span> Média geral do experimento <span class="pp">|</span> Fixo <span class="pp">|</span> <span class="sc">\-</span> <span class="pp">|</span></span>
<span id="cb40-465"><a href="#cb40-465" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> $r_j$ <span class="pp">|</span> Efeito da repetição (*j*) <span class="pp">|</span> Fixo <span class="pp">|</span> <span class="sc">\-</span> <span class="pp">|</span></span>
<span id="cb40-466"><a href="#cb40-466" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> $g_i$ <span class="pp">|</span> Efeito do genótipo (*i)* <span class="pp">|</span> Aleatório <span class="pp">|</span> $g_i \sim N(0, \sigma^2_g)$ <span class="pp">|</span></span>
<span id="cb40-467"><a href="#cb40-467" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> $b_{k(j)}$ <span class="pp">|</span> Efeito do bloco incompleto (*k*) dentro da repetição (*j*) <span class="pp">|</span> Aleatório <span class="pp">|</span> $b_{k(j)} \sim N(0, \sigma^2_b)$ <span class="pp">|</span></span>
<span id="cb40-468"><a href="#cb40-468" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> $\varepsilon_{ijk}$ <span class="pp">|</span> Erro aleatório associado à observação <span class="pp">|</span> Aleatório <span class="pp">|</span> $\varepsilon_{ijk} \sim N(0, \sigma^2_e)$ <span class="pp">|</span></span>
<span id="cb40-469"><a href="#cb40-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-470"><a href="#cb40-470" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Diagnóstico dos resíduos</span></span>
<span id="cb40-471"><a href="#cb40-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-472"><a href="#cb40-472" aria-hidden="true" tabindex="-1"></a>Ao analisar o gráfico Resíduos x Ajustados do modelo aleatório (BLUP), foi possível verificar o comportamento dos erros em relação aos valores preditos.</span>
<span id="cb40-473"><a href="#cb40-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-474"><a href="#cb40-474" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Os pontos se distribuem de forma predominantemente aleatória ao redor da linha zero, sem formação de padrões evidentes, o que indica que o modelo apresenta homocedasticidade, ou seja, variância constante dos resíduos ao longo da faixa de produtividades ajustadas.</span>
<span id="cb40-475"><a href="#cb40-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-476"><a href="#cb40-476" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Entretanto, alguns pontos mais dispersos na extremidade inferior referentes a parcelas com produtividade muito baixa o que é comum em ensaios de campo, onde variações ambientais e falhas experimentais podem gerar resíduos extremos.\</span>
<span id="cb40-477"><a href="#cb40-477" aria-hidden="true" tabindex="-1"></a>    Mesmo assim, a tendência geral mostra que o modelo aleatório ajustou bem a estrutura dos dados, capturando os efeitos genéticos e de bloco de forma eficiente.</span>
<span id="cb40-478"><a href="#cb40-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-481"><a href="#cb40-481" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-482"><a href="#cb40-482" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">resid</span>(mod.rg) <span class="sc">~</span> <span class="fu">fitted</span>(mod.rg), <span class="at">main =</span> <span class="st">"Resíduos vs Ajustados - Modelo Aleatório (BLUP)"</span>)</span>
<span id="cb40-483"><a href="#cb40-483" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-484"><a href="#cb40-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-485"><a href="#cb40-485" aria-hidden="true" tabindex="-1"></a>No gráfico Q-Q Plot do modelo aleatório (BLUP), foi avaliado se os resíduos seguem a distribuição normal teórica, um dos pressupostos fundamentais do modelo misto.</span>
<span id="cb40-486"><a href="#cb40-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-487"><a href="#cb40-487" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>A maioria dos pontos se alinha bem à linha diagonal, o que indica que a distribuição dos resíduos é aproximadamente normal. Apenas pequenas deformações nas extremidades (caudas) podem ser observadas, refletindo a presença de alguns valores atípicos comportamento comum em experimentos agrícolas devido à variabilidade natural entre parcelas.</span>
<span id="cb40-488"><a href="#cb40-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-489"><a href="#cb40-489" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Essa proximidade entre os quantis observados e teóricos confirma que o ajuste do modelo é adequado e que as inferências obtidas (como os componentes de variância e os BLUPs) são estatisticamente válidas.</span>
<span id="cb40-490"><a href="#cb40-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-491"><a href="#cb40-491" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>O modelo aleatório apresentou boa aderência à normalidade e homogeneidade de variâncias, reforçando sua consistência para estimar parâmetros genéticos e predizer o desempenho dos genótipos.</span>
<span id="cb40-492"><a href="#cb40-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-495"><a href="#cb40-495" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-496"><a href="#cb40-496" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(mod.rg)); <span class="fu">qqline</span>(<span class="fu">resid</span>(mod.rg))</span>
<span id="cb40-497"><a href="#cb40-497" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-498"><a href="#cb40-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-499"><a href="#cb40-499" aria-hidden="true" tabindex="-1"></a>Pessoal, vou reforçar uma questão que pode surgir:</span>
<span id="cb40-500"><a href="#cb40-500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-501"><a href="#cb40-501" aria-hidden="true" tabindex="-1"></a>::: callout-important</span>
<span id="cb40-502"><a href="#cb40-502" aria-hidden="true" tabindex="-1"></a>A suposição de normalidade dos resíduos é verificada para avaliar o ajuste e a robustez do modelo, mas não é um pressuposto estritamente necessário para a validade das estimativas obtidas via REML/BLUP. O modelo misto suporta pequenas violações de normalidade, desde que a estrutura de variâncias e covariâncias seja corretamente especificada e os resíduos sejam independentes e homocedásticos.</span>
<span id="cb40-503"><a href="#cb40-503" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb40-504"><a href="#cb40-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-505"><a href="#cb40-505" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Teste de significância dos componentes de variância</span></span>
<span id="cb40-506"><a href="#cb40-506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-507"><a href="#cb40-507" aria-hidden="true" tabindex="-1"></a>Nesta etapa, foi realizado o teste de significância dos componentes de variância por meio da função **`ranova()`**<span class="ot">[^6]</span>, que avalia se os efeitos aleatórios incluídos no modelo contribuem de forma significativa para explicar a variabilidade observada na produtividade.</span>
<span id="cb40-508"><a href="#cb40-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-509"><a href="#cb40-509" aria-hidden="true" tabindex="-1"></a><span class="ot">[^6]: </span>lmerTest Package: Tests in Linear Mixed Effects Models - <span class="co">[</span><span class="ot">**Artigo completo**</span><span class="co">](https://www.jstatsoft.org/article/view/v082i13)</span>**.**</span>
<span id="cb40-510"><a href="#cb40-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-511"><a href="#cb40-511" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>O procedimento compara o modelo completo com versões reduzidas (sem cada efeito aleatório), utilizando testes de **razão de verossimilhança (Likelihood Ratio Test)**<span class="ot">[^7]</span>.</span>
<span id="cb40-512"><a href="#cb40-512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-513"><a href="#cb40-513" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Quando o resultado indica que o componente de variância associado ao genótipo é significativo, isso confirma que existe variabilidade genética expressiva na população avaliada, o que justifica a aplicação do modelo misto e a obtenção dos BLUPs para seleção dos melhores materiais.</span>
<span id="cb40-514"><a href="#cb40-514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-515"><a href="#cb40-515" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Da mesma forma, a significância do componente de bloco dentro de repetição indica que o delineamento alpha-lattice foi eficiente em captar variações ambientais locais, contribuindo para a redução do erro residual e o aumento da precisão experimental.</span>
<span id="cb40-516"><a href="#cb40-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-517"><a href="#cb40-517" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>A <span class="in">`ranova()`</span> permite validar estatisticamente a estrutura hierárquica do modelo e assegurar que cada efeito aleatório considerado genótipos, blocos e erro, desempenha papel relevante na explicação da variância total, garantindo um modelo parcimonioso e biologicamente coerente com o delineamento do experimento.</span>
<span id="cb40-518"><a href="#cb40-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-519"><a href="#cb40-519" aria-hidden="true" tabindex="-1"></a><span class="ot">[^7]: </span>Likelihood Ratio Tests in Linear Mixed Models with One Variance Component.- <span class="co">[</span><span class="ot">**Artigo**</span><span class="co">](https://academic.oup.com/jrsssb/article-abstract/66/1/165/7098985?login=false)</span>.</span>
<span id="cb40-520"><a href="#cb40-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-523"><a href="#cb40-523" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-524"><a href="#cb40-524" aria-hidden="true" tabindex="-1"></a>ranova_rg <span class="ot">&lt;-</span> <span class="fu">ranova</span>(mod.rg)</span>
<span id="cb40-525"><a href="#cb40-525" aria-hidden="true" tabindex="-1"></a>ranova_rg</span>
<span id="cb40-526"><a href="#cb40-526" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-527"><a href="#cb40-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-530"><a href="#cb40-530" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-531"><a href="#cb40-531" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(ranova_rg)</span>
<span id="cb40-532"><a href="#cb40-532" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-533"><a href="#cb40-533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-534"><a href="#cb40-534" aria-hidden="true" tabindex="-1"></a>A análise de variância dos componentes aleatórios, obtida por meio da função <span class="in">`ranova()`</span>, permite avaliar a contribuição de cada termo aleatório do modelo para o ajuste global, com base no teste da razão de verossimilhança (LRT).</span>
<span id="cb40-535"><a href="#cb40-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-536"><a href="#cb40-536" aria-hidden="true" tabindex="-1"></a>**No modelo ajustado**</span>
<span id="cb40-537"><a href="#cb40-537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-538"><a href="#cb40-538" aria-hidden="true" tabindex="-1"></a>$prod∼rep+(1∣gen)+(1∣rep:inc.bloco)$</span>
<span id="cb40-539"><a href="#cb40-539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-540"><a href="#cb40-540" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Observou-se que o efeito aleatório de genótipos foi significativo (p = 0.0388), indicando que há variação genética entre os genótipos avaliados, justificando sua manutenção no modelo.</span>
<span id="cb40-541"><a href="#cb40-541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-542"><a href="#cb40-542" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Por outro lado, o termo blocos incompletos dentro de repetição (<span class="in">`rep:inc.bloco`</span>) não apresentou significância estatística (p = 0.5074), sugerindo que essa fonte de variação **não** contribui de forma relevante para explicar o rendimento.</span>
<span id="cb40-543"><a href="#cb40-543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-544"><a href="#cb40-544" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Nesse caso, a simplificação do modelo, removendo esse termo, resulta em uma estrutura mais parcimoniosa, com melhor ajuste (AIC = 1529.4) e menor complexidade, sem perda de qualidade na predição.</span>
<span id="cb40-545"><a href="#cb40-545" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-546"><a href="#cb40-546" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Comparação entre modelos (AIC e LogLik)</span></span>
<span id="cb40-547"><a href="#cb40-547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-548"><a href="#cb40-548" aria-hidden="true" tabindex="-1"></a>Por fim, comparei o desempenho dos dois modelos o de efeito fixo (BLUE) e o de efeito aleatório (BLUP) utilizando os critérios AIC (Akaike Information Criterion)<span class="ot">[^8]</span> e logLik (logaritmo da verossimilhança).</span>
<span id="cb40-549"><a href="#cb40-549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-550"><a href="#cb40-550" aria-hidden="true" tabindex="-1"></a><span class="ot">[^8]: </span>Critério de <span class="co">[</span><span class="ot">**Akaike**</span><span class="co">](https://pt.wikipedia.org/wiki/Crit%C3%A9rio_de_informa%C3%A7%C3%A3o_de_Akaike)</span>.</span>
<span id="cb40-551"><a href="#cb40-551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-552"><a href="#cb40-552" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Esses indicadores permitem avaliar a qualidade de ajuste e a parcimônia dos modelos, isto é, o equilíbrio entre complexidade e capacidade explicativa.</span>
<span id="cb40-553"><a href="#cb40-553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-554"><a href="#cb40-554" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>O AIC é uma medida em que valores menores indicam melhor ajuste, enquanto o logLik reflete a verossimilhança do modelo quanto maior, melhor a adequação aos dados observados.</span>
<span id="cb40-555"><a href="#cb40-555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-558"><a href="#cb40-558" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-559"><a href="#cb40-559" aria-hidden="true" tabindex="-1"></a>aic_comp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb40-560"><a href="#cb40-560" aria-hidden="true" tabindex="-1"></a>  <span class="at">Modelo =</span> <span class="fu">c</span>(<span class="st">"Efeito Fixo (BLUE)"</span>, <span class="st">"Efeito Aleatório (BLUP)"</span>),</span>
<span id="cb40-561"><a href="#cb40-561" aria-hidden="true" tabindex="-1"></a>  <span class="at">AIC =</span> <span class="fu">c</span>(<span class="fu">AIC</span>(mod.fg), <span class="fu">AIC</span>(mod.rg)),</span>
<span id="cb40-562"><a href="#cb40-562" aria-hidden="true" tabindex="-1"></a>  <span class="at">logLik =</span> <span class="fu">c</span>(<span class="fu">logLik</span>(mod.fg), <span class="fu">logLik</span>(mod.rg)))</span>
<span id="cb40-563"><a href="#cb40-563" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(aic_comp)</span>
<span id="cb40-564"><a href="#cb40-564" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-565"><a href="#cb40-565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-566"><a href="#cb40-566" aria-hidden="true" tabindex="-1"></a>A comparação entre os modelos de efeitos fixos (BLUE) e aleatórios (BLUP) foi realizada com base nos critérios Akaike Information Criterion (AIC) e Log-Likelihood (logLik), que medem a qualidade do ajuste do modelo aos dados.</span>
<span id="cb40-567"><a href="#cb40-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-568"><a href="#cb40-568" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>O modelo com efeitos fixos apresentou um AIC de 1106.276 e logLik = -526.1379, enquanto o modelo com efeitos aleatórios resultou em AIC de 1554.834 e logLik = -772.4170.</span>
<span id="cb40-569"><a href="#cb40-569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-570"><a href="#cb40-570" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Como valores menores de AIC indicam melhor ajuste e maior parcimônia, conclui-se que o modelo com genótipos tratados como efeitos fixos fornece um ajuste mais adequado para os dados avaliados neste experimento. Isso sugere que a variação entre genótipos foi suficientemente explicada como efeito fixo, sem necessidade de tratá-los como uma amostra aleatória de uma população maior.</span>
<span id="cb40-571"><a href="#cb40-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-572"><a href="#cb40-572" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Por outro lado, o modelo com genótipos como efeitos aleatórios (BLUP), embora essencial em contextos de predição genética e seleção em larga escala, apresentou maior penalização no AIC, refletindo maior complexidade sem ganho proporcional de ajuste para este conjunto de dados específico.</span>
<span id="cb40-573"><a href="#cb40-573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-574"><a href="#cb40-574" aria-hidden="true" tabindex="-1"></a><span class="fu">## Estimativas dos BLUEs E BLUPs</span></span>
<span id="cb40-575"><a href="#cb40-575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-576"><a href="#cb40-576" aria-hidden="true" tabindex="-1"></a><span class="fu">### Estimativas dos BLUEs - Efeito fixo</span></span>
<span id="cb40-577"><a href="#cb40-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-578"><a href="#cb40-578" aria-hidden="true" tabindex="-1"></a>Nesta etapa, obtive as estimativas BLUEs (Best Linear Unbiased Estimates), correspondentes às médias ajustadas dos genótipos considerando o modelo com efeitos fixos.</span>
<span id="cb40-579"><a href="#cb40-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-580"><a href="#cb40-580" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Utilizei a função <span class="in">`emmeans()`</span> do pacote <span class="in">`emmeans`</span><span class="ot">[^9]</span>, que calcula as médias marginais ajustadas após o controle dos efeitos de repetição e blocos incompletos.</span>
<span id="cb40-581"><a href="#cb40-581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-582"><a href="#cb40-582" aria-hidden="true" tabindex="-1"></a><span class="ot">[^9]: </span>emmeans: Estimated Marginal Means, aka Least-Squares Means.- <span class="co">[</span><span class="ot">**Pacote**</span><span class="co">](https://cran.r-project.org/web/packages/emmeans/index.html)</span>.</span>
<span id="cb40-583"><a href="#cb40-583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-584"><a href="#cb40-584" aria-hidden="true" tabindex="-1"></a>::: callout-tip</span>
<span id="cb40-585"><a href="#cb40-585" aria-hidden="true" tabindex="-1"></a><span class="fu">## Dica</span></span>
<span id="cb40-586"><a href="#cb40-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-587"><a href="#cb40-587" aria-hidden="true" tabindex="-1"></a>Foi lançada uma nova versão do pacote 29/10/2025. Confira <span class="co">[</span><span class="ot">**aqui**</span><span class="co">](https://rvlenth.github.io/emmeans/news/index.html)</span>, as novas funções!</span>
<span id="cb40-588"><a href="#cb40-588" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb40-589"><a href="#cb40-589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-590"><a href="#cb40-590" aria-hidden="true" tabindex="-1"></a>**Em seguida, converti o resultado para data frame e selecionei as colunas principais:**</span>
<span id="cb40-591"><a href="#cb40-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-592"><a href="#cb40-592" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`gen`</span>: identificação dos genótipos;</span>
<span id="cb40-593"><a href="#cb40-593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-594"><a href="#cb40-594" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`BLUE`</span>: média ajustada estimada;</span>
<span id="cb40-595"><a href="#cb40-595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-596"><a href="#cb40-596" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`IC_inferior`</span> e <span class="in">`IC_superior`</span>: limites inferior e superior do intervalo de confiança (95%) para cada genótipo.</span>
<span id="cb40-597"><a href="#cb40-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-598"><a href="#cb40-598" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Essas estimativas representam o desempenho fenotípico médio dos genótipos, já corrigido pelas variações ambientais controladas no modelo.</span>
<span id="cb40-599"><a href="#cb40-599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-600"><a href="#cb40-600" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>O uso das BLUEs é apropriado quando o objetivo é comparar diretamente os materiais testados no experimento, fornecendo uma base para a classificação e agrupamento dos genótipos com base nas médias ajustadas de produtividade.</span>
<span id="cb40-601"><a href="#cb40-601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-604"><a href="#cb40-604" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-605"><a href="#cb40-605" aria-hidden="true" tabindex="-1"></a>BLUEs <span class="ot">&lt;-</span> emmeans<span class="sc">::</span><span class="fu">emmeans</span>(mod.fg, <span class="sc">~</span> gen) <span class="sc">%&gt;%</span></span>
<span id="cb40-606"><a href="#cb40-606" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb40-607"><a href="#cb40-607" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(gen, <span class="at">BLUE =</span> emmean, <span class="at">IC_inferior =</span> lower.CL, <span class="at">IC_superior =</span> upper.CL)</span>
<span id="cb40-608"><a href="#cb40-608" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-609"><a href="#cb40-609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-612"><a href="#cb40-612" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-613"><a href="#cb40-613" aria-hidden="true" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(BLUEs)</span>
<span id="cb40-614"><a href="#cb40-614" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-615"><a href="#cb40-615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-616"><a href="#cb40-616" aria-hidden="true" tabindex="-1"></a><span class="fu">### Estimativas dos BLUPs - Efeito aleatório</span></span>
<span id="cb40-617"><a href="#cb40-617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-618"><a href="#cb40-618" aria-hidden="true" tabindex="-1"></a>Nesta etapa, estimei os BLUPs (Best Linear Unbiased Predictors) a partir do modelo em que o genótipo foi considerado como efeito aleatório.</span>
<span id="cb40-619"><a href="#cb40-619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-620"><a href="#cb40-620" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Primeiro, extraí a média geral $u$ do modelo por meio da função <span class="in">`fixef(mod.rg)[1]`</span>, que representa o intercepto fixo, isto é, o valor médio da produtividade ajustado para todos os efeitos incluídos.</span>
<span id="cb40-621"><a href="#cb40-621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-622"><a href="#cb40-622" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Em seguida, utilizei a função <span class="in">`ranef()`</span> para obter os efeitos aleatórios preditos de cada genótipo, os quais representam os desvios individuais em relação à média geral do experimento.</span>
<span id="cb40-623"><a href="#cb40-623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-624"><a href="#cb40-624" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Esses valores correspondem às diferenças genéticas ajustadas, considerando os efeitos de repetição e de blocos incompletos dentro de cada repetição.</span>
<span id="cb40-625"><a href="#cb40-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-626"><a href="#cb40-626" aria-hidden="true" tabindex="-1"></a>O BLUP de cada genótipo foi calculado somando a média geral ao efeito aleatório estimado:</span>
<span id="cb40-627"><a href="#cb40-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-628"><a href="#cb40-628" aria-hidden="true" tabindex="-1"></a>$BLUPj=μ+gj$</span>
<span id="cb40-629"><a href="#cb40-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-630"><a href="#cb40-630" aria-hidden="true" tabindex="-1"></a>**onde:**</span>
<span id="cb40-631"><a href="#cb40-631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-632"><a href="#cb40-632" aria-hidden="true" tabindex="-1"></a>$u$ : é a média geral ajustada do modelo;</span>
<span id="cb40-633"><a href="#cb40-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-634"><a href="#cb40-634" aria-hidden="true" tabindex="-1"></a>$\hat{g}_j$ é o valor predito para o efeito aleatório do genótipo *j*.</span>
<span id="cb40-635"><a href="#cb40-635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-636"><a href="#cb40-636" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Para cada genótipo, também foram calculados intervalos de confiança de 95%, baseados no erro-padrão associado à predição individual. As colunas finais da tabela de resultados incluem:</span>
<span id="cb40-637"><a href="#cb40-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-638"><a href="#cb40-638" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- --&gt;</span></span>
<span id="cb40-639"><a href="#cb40-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-640"><a href="#cb40-640" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>gen - identificação do genótipo</span>
<span id="cb40-641"><a href="#cb40-641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-642"><a href="#cb40-642" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>BLUP - valor genético predito ajustado;</span>
<span id="cb40-643"><a href="#cb40-643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-644"><a href="#cb40-644" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>IC_inferior e IC_superior - limites inferior e superior do intervalo de confiança.</span>
<span id="cb40-645"><a href="#cb40-645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-646"><a href="#cb40-646" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Essas estimativas representam o desempenho genético ajustado dos materiais avaliados, já descontando a influência ambiental e dos blocos.</span>
<span id="cb40-647"><a href="#cb40-647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-648"><a href="#cb40-648" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Diferentemente dos BLUEs, os BLUPs permitem predizer o valor genético de genótipos não observados diretamente, sendo, portanto, uma abordagem mais apropriada para a seleção em programas de melhoramento genético de plantas.</span>
<span id="cb40-649"><a href="#cb40-649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-652"><a href="#cb40-652" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-653"><a href="#cb40-653" aria-hidden="true" tabindex="-1"></a>mu_manual <span class="ot">&lt;-</span> <span class="fu">fixef</span>(mod.rg)[<span class="dv">1</span>]</span>
<span id="cb40-654"><a href="#cb40-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-655"><a href="#cb40-655" aria-hidden="true" tabindex="-1"></a>BLUPs <span class="ot">&lt;-</span> <span class="fu">augment</span>(<span class="fu">ranef</span>(mod.rg)) <span class="sc">%&gt;%</span></span>
<span id="cb40-656"><a href="#cb40-656" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(grp <span class="sc">==</span> <span class="st">"gen"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb40-657"><a href="#cb40-657" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(<span class="at">gen =</span> level,</span>
<span id="cb40-658"><a href="#cb40-658" aria-hidden="true" tabindex="-1"></a>            <span class="at">BLUP =</span> mu_manual <span class="sc">+</span> estimate,</span>
<span id="cb40-659"><a href="#cb40-659" aria-hidden="true" tabindex="-1"></a>            <span class="at">IC_inferior =</span> BLUP <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> std.error,</span>
<span id="cb40-660"><a href="#cb40-660" aria-hidden="true" tabindex="-1"></a>            <span class="at">IC_superior =</span> BLUP <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> std.error)</span>
<span id="cb40-661"><a href="#cb40-661" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-662"><a href="#cb40-662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-665"><a href="#cb40-665" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-666"><a href="#cb40-666" aria-hidden="true" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(BLUPs)</span>
<span id="cb40-667"><a href="#cb40-667" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-668"><a href="#cb40-668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-669"><a href="#cb40-669" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Comparação entre BLUE x BLUP</span></span>
<span id="cb40-670"><a href="#cb40-670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-673"><a href="#cb40-673" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-674"><a href="#cb40-674" aria-hidden="true" tabindex="-1"></a><span class="co"># Junta as estimativas dos dois modelos pelo identificador gen</span></span>
<span id="cb40-675"><a href="#cb40-675" aria-hidden="true" tabindex="-1"></a>comparacao <span class="ot">&lt;-</span> <span class="fu">full_join</span>(BLUEs, BLUPs, <span class="at">by =</span> <span class="st">"gen"</span>, <span class="at">suffix =</span> <span class="fu">c</span>(<span class="st">"_BLUE"</span>, <span class="st">"_BLUP"</span>))</span>
<span id="cb40-676"><a href="#cb40-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-677"><a href="#cb40-677" aria-hidden="true" tabindex="-1"></a>comparacao_long <span class="ot">&lt;-</span> comparacao <span class="sc">%&gt;%</span></span>
<span id="cb40-678"><a href="#cb40-678" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb40-679"><a href="#cb40-679" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">c</span>(BLUE, BLUP),</span>
<span id="cb40-680"><a href="#cb40-680" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"Tipo"</span>,</span>
<span id="cb40-681"><a href="#cb40-681" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"Estimativa"</span>)</span>
<span id="cb40-682"><a href="#cb40-682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-683"><a href="#cb40-683" aria-hidden="true" tabindex="-1"></a><span class="co"># Ordena os genótipos pela média BLUP</span></span>
<span id="cb40-684"><a href="#cb40-684" aria-hidden="true" tabindex="-1"></a>ordem_gen <span class="ot">&lt;-</span> comparacao <span class="sc">%&gt;%</span></span>
<span id="cb40-685"><a href="#cb40-685" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(BLUP) <span class="sc">%&gt;%</span></span>
<span id="cb40-686"><a href="#cb40-686" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(gen)</span>
<span id="cb40-687"><a href="#cb40-687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-688"><a href="#cb40-688" aria-hidden="true" tabindex="-1"></a>comparacao_long<span class="sc">$</span>gen <span class="ot">&lt;-</span> <span class="fu">factor</span>(comparacao_long<span class="sc">$</span>gen, </span>
<span id="cb40-689"><a href="#cb40-689" aria-hidden="true" tabindex="-1"></a>                              <span class="at">levels =</span> ordem_gen)</span>
<span id="cb40-690"><a href="#cb40-690" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-691"><a href="#cb40-691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-694"><a href="#cb40-694" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-695"><a href="#cb40-695" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(comparacao_long, <span class="fu">aes</span>(<span class="at">x =</span> gen, <span class="at">y =</span> Estimativa, <span class="at">fill =</span> Tipo)) <span class="sc">+</span></span>
<span id="cb40-696"><a href="#cb40-696" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.8</span>), <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb40-697"><a href="#cb40-697" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(</span>
<span id="cb40-698"><a href="#cb40-698" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymin =</span> <span class="fu">ifelse</span>(Tipo <span class="sc">==</span> <span class="st">"BLUE"</span>, IC_inferior_BLUE, </span>
<span id="cb40-699"><a href="#cb40-699" aria-hidden="true" tabindex="-1"></a>                  IC_inferior_BLUP),</span>
<span id="cb40-700"><a href="#cb40-700" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymax =</span> <span class="fu">ifelse</span>(Tipo <span class="sc">==</span> <span class="st">"BLUE"</span>, IC_superior_BLUE,</span>
<span id="cb40-701"><a href="#cb40-701" aria-hidden="true" tabindex="-1"></a>                  IC_superior_BLUP)), </span>
<span id="cb40-702"><a href="#cb40-702" aria-hidden="true" tabindex="-1"></a>    <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.8</span>), <span class="at">width =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb40-703"><a href="#cb40-703" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb40-704"><a href="#cb40-704" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Comparação entre BLUEs e BLUPs por Genótipo"</span>,</span>
<span id="cb40-705"><a href="#cb40-705" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Genótipos"</span>,</span>
<span id="cb40-706"><a href="#cb40-706" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Estimativas de produção"</span>,</span>
<span id="cb40-707"><a href="#cb40-707" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Modelo"</span>) <span class="sc">+</span></span>
<span id="cb40-708"><a href="#cb40-708" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb40-709"><a href="#cb40-709" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb40-710"><a href="#cb40-710" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb40-711"><a href="#cb40-711" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb40-712"><a href="#cb40-712" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-713"><a href="#cb40-713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-714"><a href="#cb40-714" aria-hidden="true" tabindex="-1"></a>Neste gráfico, comparei as estimativas BLUEs e BLUPs obtidas para cada genótipo, representando a produtividade ajustada segundo as duas modelagens estatísticas.</span>
<span id="cb40-715"><a href="#cb40-715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-716"><a href="#cb40-716" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Os genótipos estão ordenados pela média BLUP, permitindo visualizar a progressão do desempenho genético predito.</span>
<span id="cb40-717"><a href="#cb40-717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-718"><a href="#cb40-718" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>As barras vermelhas correspondem aos BLUEs, provenientes do modelo com efeito fixo de genótipo, enquanto as barras azuis representam os BLUPs, obtidas do modelo com efeito aleatório de genótipo.</span>
<span id="cb40-719"><a href="#cb40-719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-720"><a href="#cb40-720" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Ao observar o gráfico, percebo que os BLUEs apresentam maior amplitude e maior variação entre genótipos, refletindo diretamente os valores médios observados no experimento portanto, mais sensíveis à variação fenotípica e ao erro experimental.</span>
<span id="cb40-721"><a href="#cb40-721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-722"><a href="#cb40-722" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Já os BLUPs mostram comportamento mais suavizado e estável, pois incorporam a estrutura de variâncias do modelo misto, corrigindo a influência ambiental e priorizando a informação genética predita.</span>
<span id="cb40-723"><a href="#cb40-723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-724"><a href="#cb40-724" aria-hidden="true" tabindex="-1"></a>**Essa diferença é esperada:**</span>
<span id="cb40-725"><a href="#cb40-725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-726"><a href="#cb40-726" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Os BLUEs são estimativas descritivas, adequadas para comparar os genótipos avaliados dentro do experimento específico;</span>
<span id="cb40-727"><a href="#cb40-727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-728"><a href="#cb40-728" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Os BLUPs são preditivos, permitindo inferir sobre o valor genético e realizar seleção com base em mérito genético.</span>
<span id="cb40-729"><a href="#cb40-729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-730"><a href="#cb40-730" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>O gráfico evidencia que, embora ambos os métodos estimem o mesmo fenômeno (produtividade ajustada), eles respondem a objetivos distintos:</span>
<span id="cb40-731"><a href="#cb40-731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-732"><a href="#cb40-732" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Os BLUEs detalham o comportamento experimental observado, enquanto os BLUPs fornecem uma visão mais generalizada e essencial em contextos de melhoramento genético e seleção de linhagens promissoras.</span>
<span id="cb40-733"><a href="#cb40-733" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-734"><a href="#cb40-734" aria-hidden="true" tabindex="-1"></a><span class="fu">#### BLUPs preditos</span></span>
<span id="cb40-735"><a href="#cb40-735" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-736"><a href="#cb40-736" aria-hidden="true" tabindex="-1"></a>Nesta visualização, apresento as estimativas BLUPs (Best Linear Unbiased Predictors) para os genótipos avaliados, já ajustadas pelos efeitos ambientais e de blocos.</span>
<span id="cb40-737"><a href="#cb40-737" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-738"><a href="#cb40-738" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Os genótipos estão ordenados do menor para o maior valor predito, permitindo observar claramente o gradiente de desempenho genético na população.</span>
<span id="cb40-739"><a href="#cb40-739" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-740"><a href="#cb40-740" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>As barras representam a produtividade ajustada (kg/ha), enquanto as linhas verticais indicam os intervalos de confiança (95%), evidenciando a precisão das estimativas individuais.</span>
<span id="cb40-741"><a href="#cb40-741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-742"><a href="#cb40-742" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Genótipos com BLUPs mais altos estão acima da média geral $μ$, sendo candidatos preferenciais à seleção, pois apresentam maior mérito genético estimado.</span>
<span id="cb40-743"><a href="#cb40-743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-744"><a href="#cb40-744" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Por outro lado, genótipos com BLUPs mais baixos situam-se abaixo da média, refletindo desempenho inferior após o ajuste dos efeitos ambientais.</span>
<span id="cb40-745"><a href="#cb40-745" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-746"><a href="#cb40-746" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Enquanto análises clássicas (como médias de tratamento) descrevem o desempenho observado, o modelo misto e os BLUPs revelam o potencial genético verdadeiro dos genótipos, tornando-se a principal abordagem de seleção em programas de melhoramento vegetal.</span>
<span id="cb40-747"><a href="#cb40-747" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-750"><a href="#cb40-750" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-751"><a href="#cb40-751" aria-hidden="true" tabindex="-1"></a><span class="co"># Ordena os genótipos pela estimativa BLUP</span></span>
<span id="cb40-752"><a href="#cb40-752" aria-hidden="true" tabindex="-1"></a>BLUPs <span class="ot">&lt;-</span> BLUPs <span class="sc">%&gt;%</span></span>
<span id="cb40-753"><a href="#cb40-753" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(BLUP) <span class="sc">%&gt;%</span></span>
<span id="cb40-754"><a href="#cb40-754" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gen =</span> <span class="fu">factor</span>(gen, <span class="at">levels =</span> gen))</span>
<span id="cb40-755"><a href="#cb40-755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-756"><a href="#cb40-756" aria-hidden="true" tabindex="-1"></a>media_geral <span class="ot">&lt;-</span> <span class="fu">fixef</span>(mod.rg)[<span class="dv">1</span>]</span>
<span id="cb40-757"><a href="#cb40-757" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-758"><a href="#cb40-758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-761"><a href="#cb40-761" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-762"><a href="#cb40-762" aria-hidden="true" tabindex="-1"></a><span class="co">#|wwarning: false</span></span>
<span id="cb40-763"><a href="#cb40-763" aria-hidden="true" tabindex="-1"></a><span class="co">#|mmessage: false</span></span>
<span id="cb40-764"><a href="#cb40-764" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(BLUPs, <span class="fu">aes</span>(<span class="at">x =</span> gen, <span class="at">y =</span> BLUP)) <span class="sc">+</span></span>
<span id="cb40-765"><a href="#cb40-765" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"#2ca9b7"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb40-766"><a href="#cb40-766" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> IC_inferior, <span class="at">ymax =</span> IC_superior), <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb40-767"><a href="#cb40-767" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> media_geral, </span>
<span id="cb40-768"><a href="#cb40-768" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"#E85D04"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb40-769"><a href="#cb40-769" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb40-770"><a href="#cb40-770" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Estimativas BLUPs por Genótipo"</span>,</span>
<span id="cb40-771"><a href="#cb40-771" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Linha tracejada indica a média geral ajustada (μ)"</span>,</span>
<span id="cb40-772"><a href="#cb40-772" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Genótipos"</span>,</span>
<span id="cb40-773"><a href="#cb40-773" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Produtividade (kg/ha)"</span>) <span class="sc">+</span></span>
<span id="cb40-774"><a href="#cb40-774" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb40-775"><a href="#cb40-775" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb40-776"><a href="#cb40-776" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb40-777"><a href="#cb40-777" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb40-778"><a href="#cb40-778" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-779"><a href="#cb40-779" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-780"><a href="#cb40-780" aria-hidden="true" tabindex="-1"></a><span class="fu">## Herdabilidade</span></span>
<span id="cb40-781"><a href="#cb40-781" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-782"><a href="#cb40-782" aria-hidden="true" tabindex="-1"></a>Nesta etapa, estimei a herdabilidade em sentido amplo $H^2$ com base nas variâncias obtidas do modelo misto com genótipos como efeito aleatório.</span>
<span id="cb40-783"><a href="#cb40-783" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-786"><a href="#cb40-786" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-787"><a href="#cb40-787" aria-hidden="true" tabindex="-1"></a>vcomps <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">VarCorr</span>(mod.rg))</span>
<span id="cb40-788"><a href="#cb40-788" aria-hidden="true" tabindex="-1"></a>vc.g <span class="ot">&lt;-</span> vcomps[vcomps<span class="sc">$</span>grp <span class="sc">==</span> <span class="st">"gen"</span>, <span class="st">"vcov"</span>]</span>
<span id="cb40-789"><a href="#cb40-789" aria-hidden="true" tabindex="-1"></a>vc.e <span class="ot">&lt;-</span> vcomps[vcomps<span class="sc">$</span>grp <span class="sc">==</span> <span class="st">"Residual"</span>, <span class="st">"vcov"</span>]</span>
<span id="cb40-790"><a href="#cb40-790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-791"><a href="#cb40-791" aria-hidden="true" tabindex="-1"></a>nreps <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb40-792"><a href="#cb40-792" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-793"><a href="#cb40-793" aria-hidden="true" tabindex="-1"></a>hc <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(vc.g <span class="sc">/</span> (vc.g <span class="sc">+</span> vc.e <span class="sc">/</span> nreps))  <span class="co"># &lt;- garante tipo numérico</span></span>
<span id="cb40-794"><a href="#cb40-794" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-795"><a href="#cb40-795" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"Herdabilidade estimada: {round(hc, 3)}"</span>))</span>
<span id="cb40-796"><a href="#cb40-796" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-797"><a href="#cb40-797" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-798"><a href="#cb40-798" aria-hidden="true" tabindex="-1"></a>Estimei $H^2$ (sentido amplo) a partir dos componentes de variância do modelo misto com genótipos como efeito aleatório. Extraí $σ^2g$ (genótipos) e $σ^2e$​ (resíduo) via <span class="in">`VarCorr()`</span>, e calculei $H^2$ na base de médias por genótipo, considerando r repetições:</span>
<span id="cb40-799"><a href="#cb40-799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-800"><a href="#cb40-800" aria-hidden="true" tabindex="-1"></a>$H^2 = \frac{\sigma_g^2}{\sigma_g^2 + \frac{\sigma_e^2}{r}}$</span>
<span id="cb40-801"><a href="#cb40-801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-802"><a href="#cb40-802" aria-hidden="true" tabindex="-1"></a><span class="fu">## Agrupamento hierárquico - UPGMA</span></span>
<span id="cb40-803"><a href="#cb40-803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-804"><a href="#cb40-804" aria-hidden="true" tabindex="-1"></a>Nesta etapa, realizei o agrupamento hierárquico dos genótipos com base nas estimativas BLUPs de produtividade, utilizando o método UPGMA (Unweighted Pair Group Method with Arithmetic Mean) e a distância euclidiana como medida de dissimilaridade.</span>
<span id="cb40-805"><a href="#cb40-805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-806"><a href="#cb40-806" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>O objetivo desse procedimento é avaliar o grau de similaridade genética entre os genótipos e identificar possíveis padrões de agrupamento entre materiais com desempenho produtivo semelhante.</span>
<span id="cb40-807"><a href="#cb40-807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-808"><a href="#cb40-808" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Genótipos próximos no dendrograma apresentam valores genéticos preditos semelhantes, enquanto aqueles separados por maiores distâncias euclidianas diferem mais em seu potencial produtivo.</span>
<span id="cb40-809"><a href="#cb40-809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-810"><a href="#cb40-810" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>O dendrograma evidencia a formação de três grupos principais de genótipos, com base na similaridade de seus valores genéticos preditos.</span>
<span id="cb40-811"><a href="#cb40-811" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-812"><a href="#cb40-812" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>O primeiro grupo reúne materiais com desempenho produtivo médio a baixo, enquanto o segundo concentra genótipos com resposta intermediária.</span>
<span id="cb40-813"><a href="#cb40-813" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-814"><a href="#cb40-814" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>O terceiro grupo, mais distante, representa genótipos com maiores valores de BLUP, indicando superioridade genética e potencial para seleção em programas de melhoramento.</span>
<span id="cb40-815"><a href="#cb40-815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-816"><a href="#cb40-816" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Essa estrutura de agrupamento pode ser explorada para selecionar genótipos contrastantes, direcionar cruzamentos futuros ou representar a diversidade entre linhagens avançadas.</span>
<span id="cb40-817"><a href="#cb40-817" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-818"><a href="#cb40-818" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>O método UPGMA, ao utilizar as estimativas BLUPs, garante que o agrupamento seja baseado na performance genética ajustada e não apenas em médias fenotípicas -, o que torna a análise mais robusta e alinhada ao propósito do melhoramento genético quantitativo.</span>
<span id="cb40-819"><a href="#cb40-819" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-822"><a href="#cb40-822" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-823"><a href="#cb40-823" aria-hidden="true" tabindex="-1"></a>blup_values <span class="ot">&lt;-</span> BLUPs<span class="sc">$</span>BLUP</span>
<span id="cb40-824"><a href="#cb40-824" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(blup_values) <span class="ot">&lt;-</span> BLUPs<span class="sc">$</span>gen</span>
<span id="cb40-825"><a href="#cb40-825" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-826"><a href="#cb40-826" aria-hidden="true" tabindex="-1"></a>dist_blups <span class="ot">&lt;-</span> <span class="fu">dist</span>(blup_values, <span class="at">method =</span> <span class="st">"euclidean"</span>)</span>
<span id="cb40-827"><a href="#cb40-827" aria-hidden="true" tabindex="-1"></a>hc <span class="ot">&lt;-</span> <span class="fu">hclust</span>(dist_blups, <span class="at">method =</span> <span class="st">"average"</span>)</span>
<span id="cb40-828"><a href="#cb40-828" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-829"><a href="#cb40-829" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-832"><a href="#cb40-832" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-833"><a href="#cb40-833" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(hc, <span class="at">main =</span> <span class="st">"Dendrograma UPGMA - BLUPs"</span>,</span>
<span id="cb40-834"><a href="#cb40-834" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Genótipos"</span>, <span class="at">ylab =</span> <span class="st">"Distância Euclidiana"</span>)</span>
<span id="cb40-835"><a href="#cb40-835" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-836"><a href="#cb40-836" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-837"><a href="#cb40-837" aria-hidden="true" tabindex="-1"></a><span class="fu">### Correlação cofenética</span></span>
<span id="cb40-838"><a href="#cb40-838" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-839"><a href="#cb40-839" aria-hidden="true" tabindex="-1"></a>Após a geração do dendrograma, eu avaliei a consistência do agrupamento UPGMA por meio da correlação cofenética, que mede o grau de concordância entre a matriz original de distâncias genéticas e a matriz de distâncias representada pelo dendrograma.</span>
<span id="cb40-840"><a href="#cb40-840" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-841"><a href="#cb40-841" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>A correlação cofenética obtida foi de 0,8943, o que indica excelente ajuste entre os dados originais e a representação hierárquica produzida pelo método UPGMA.</span>
<span id="cb40-842"><a href="#cb40-842" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-843"><a href="#cb40-843" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Valores próximos de 1 refletem alta fidelidade do dendrograma em representar as relações de similaridade entre os genótipos, garantindo confiabilidade na estrutura de agrupamento observada.</span>
<span id="cb40-844"><a href="#cb40-844" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-845"><a href="#cb40-845" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Esse resultado confirma que o método de agrupamento adotado foi estatisticamente adequado para os dados de BLUPs, permitindo interpretar os grupos formados como indicativos reais de proximidade genética e desempenho produtivo semelhante.</span>
<span id="cb40-846"><a href="#cb40-846" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-847"><a href="#cb40-847" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Assim, a análise de agrupamento, validada pela alta correlação cofenética, reforça a robustez da modelagem mista e a diversidade genética presente entre os genótipos avaliados.</span>
<span id="cb40-848"><a href="#cb40-848" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-851"><a href="#cb40-851" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-852"><a href="#cb40-852" aria-hidden="true" tabindex="-1"></a><span class="co"># Correlação cofenética</span></span>
<span id="cb40-853"><a href="#cb40-853" aria-hidden="true" tabindex="-1"></a>cophenetic_dist <span class="ot">&lt;-</span> <span class="fu">cophenetic</span>(hc)</span>
<span id="cb40-854"><a href="#cb40-854" aria-hidden="true" tabindex="-1"></a>correlation_cophenetic <span class="ot">&lt;-</span> <span class="fu">cor</span>(dist_blups, cophenetic_dist)</span>
<span id="cb40-855"><a href="#cb40-855" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Correlação cofenética:"</span>, <span class="fu">round</span>(correlation_cophenetic, <span class="dv">4</span>)))</span>
<span id="cb40-856"><a href="#cb40-856" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-857"><a href="#cb40-857" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-858"><a href="#cb40-858" aria-hidden="true" tabindex="-1"></a><span class="fu">## Considerações finais</span></span>
<span id="cb40-859"><a href="#cb40-859" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-860"><a href="#cb40-860" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb40-861"><a href="#cb40-861" aria-hidden="true" tabindex="-1"></a><span class="fu">## Pipeline</span></span>
<span id="cb40-862"><a href="#cb40-862" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-863"><a href="#cb40-863" aria-hidden="true" tabindex="-1"></a>O pipeline desenvolvido neste portfólio consolida um fluxo completo de análise experimental, desde a importação automatizada dos dados via API do GitHub até a modelagem estatística com delineamento alpha-lattice, integrando visualizações, estimativas genéticas e validação por agrupamento hierárquico.</span>
<span id="cb40-864"><a href="#cb40-864" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-865"><a href="#cb40-865" aria-hidden="true" tabindex="-1"></a><span class="fu">## Modelagem</span></span>
<span id="cb40-866"><a href="#cb40-866" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-867"><a href="#cb40-867" aria-hidden="true" tabindex="-1"></a>As análises realizadas demonstram a eficiência da modelagem mista aplicada ao delineamento alpha-lattice para a avaliação genética de genótipos.</span>
<span id="cb40-868"><a href="#cb40-868" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-869"><a href="#cb40-869" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>O uso combinado dos modelos BLUE e BLUP permitiu distinguir de forma precisa os efeitos fixos e aleatórios, evidenciando a importância de controlar a variação proveniente de blocos incompletos e repetições.</span>
<span id="cb40-870"><a href="#cb40-870" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-871"><a href="#cb40-871" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>A estimativa de herdabilidade indicou a proporção da variação total atribuída aos efeitos genéticos, confirmando a adequação do modelo e a confiabilidade dos parâmetros obtidos. Além disso, a análise de agrupamento via UPGMA reforçou a presença de variabilidade genética entre os materiais, o que é essencial para a continuidade do processo seletivo.</span>
<span id="cb40-872"><a href="#cb40-872" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-873"><a href="#cb40-873" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>De modo geral, a modelagem adotada proporcionou predições mais acuradas do desempenho genético, favorecendo a seleção de genótipos superiores e garantindo reprodutibilidade e transparência nas etapas analíticas aspectos fundamentais em pipelines de programas de melhoramento genético e experimentação agrícola.</span>
<span id="cb40-874"><a href="#cb40-874" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-875"><a href="#cb40-875" aria-hidden="true" tabindex="-1"></a><span class="fu">## Recursos recomendados</span></span>
<span id="cb40-876"><a href="#cb40-876" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-877"><a href="#cb40-877" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Pacote <span class="sc">\|</span> Recurso <span class="pp">|</span> Descrição <span class="pp">|</span> Link <span class="pp">|</span></span>
<span id="cb40-878"><a href="#cb40-878" aria-hidden="true" tabindex="-1"></a><span class="pp">|----|----|----|</span></span>
<span id="cb40-879"><a href="#cb40-879" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **{httr2}** <span class="pp">|</span> Pacote moderno para consumo de APIs REST no R. Permite autenticação, controle de headers e tratamento seguro de respostas HTTP. <span class="pp">|</span> <span class="co">[</span><span class="ot">httr2.r-lib.org</span><span class="co">](https://httr2.r-lib.org/articles/wrapping-apis.html)</span> <span class="pp">|</span></span>
<span id="cb40-880"><a href="#cb40-880" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **GitHub API (REST)** <span class="pp">|</span> Interface oficial para acessar dados do GitHub (arquivos, repositórios, commits, issues) via requisições autenticadas. <span class="pp">|</span> <span class="co">[</span><span class="ot">docs.github.com/rest</span><span class="co">](https://docs.github.com/rest/guides/getting-started-with-the-rest-api)</span> <span class="pp">|</span></span>
<span id="cb40-881"><a href="#cb40-881" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **{gh}** <span class="pp">|</span> Cliente R oficial para a API do GitHub. Facilita automações e integrações entre R e repositórios GitHub. <span class="pp">|</span> <span class="co">[</span><span class="ot">r-lib.github.io/gh</span><span class="co">](https://r-lib.github.io/gh/)</span> <span class="pp">|</span></span>
<span id="cb40-882"><a href="#cb40-882" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **{lme4}** <span class="pp">|</span> Base para ajuste de modelos lineares mistos (efeitos fixos e aleatórios) fundamental para estimar BLUPs. <span class="pp">|</span> <span class="co">[</span><span class="ot">cran.r-project.org/lme4</span><span class="co">](https://cran.r-project.org/package=lme4)</span> <span class="pp">|</span></span>
<span id="cb40-883"><a href="#cb40-883" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **{emmeans}** <span class="pp">|</span> Calcula médias ajustadas (BLUEs), intervalos de confiança e comparações múltiplas. <span class="pp">|</span> <span class="co">[</span><span class="ot">emmeans.r-forge.r-project.org</span><span class="co">](https://emmeans.r-forge.r-project.org/)</span> <span class="pp">|</span></span>
<span id="cb40-884"><a href="#cb40-884" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **{metan}** <span class="pp">|</span> Ferramenta completa para análises agronômicas e genéticas (BLUP, MGIDI, herdabilidade, PCA, correlação). <span class="pp">|</span> <span class="co">[</span><span class="ot">cran.r-project.org/metan</span><span class="co">](https://cran.r-project.org/package=metan)</span> <span class="pp">|</span></span>
<span id="cb40-885"><a href="#cb40-885" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **{tidyverse}** <span class="pp">|</span> Coleção de pacotes para manipulação, visualização e comunicação de dados de forma coerente e reprodutível. <span class="pp">|</span> <span class="co">[</span><span class="ot">tidyverse.org</span><span class="co">](https://www.tidyverse.org/)</span> <span class="pp">|</span></span>
<span id="cb40-886"><a href="#cb40-886" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **Quarto** <span class="pp">|</span> Sistema de publicação científica integrado ao RStudio, ideal para relatórios dinâmicos, artigos e portfólios. <span class="pp">|</span> <span class="co">[</span><span class="ot">quarto.org</span><span class="co">](https://quarto.org/)</span> <span class="pp">|</span></span>
<span id="cb40-887"><a href="#cb40-887" aria-hidden="true" tabindex="-1"></a>:::</span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




<script src="modelagem_experimental_explicacoes_files/libs/quarto-html/zenscroll-min.js"></script>
</body></html>