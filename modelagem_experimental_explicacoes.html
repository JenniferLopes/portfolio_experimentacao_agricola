<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Jennifer Luz Lopes">

<title>Portfólio Experimental – Delineamento Alpha-Lattice</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="modelagem_experimental_explicacoes_files/libs/clipboard/clipboard.min.js"></script>
<script src="modelagem_experimental_explicacoes_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="modelagem_experimental_explicacoes_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="modelagem_experimental_explicacoes_files/libs/quarto-html/popper.min.js"></script>
<script src="modelagem_experimental_explicacoes_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="modelagem_experimental_explicacoes_files/libs/quarto-html/anchor.min.js"></script>
<link href="modelagem_experimental_explicacoes_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="modelagem_experimental_explicacoes_files/libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="modelagem_experimental_explicacoes_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="modelagem_experimental_explicacoes_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="modelagem_experimental_explicacoes_files/libs/bootstrap/bootstrap-6e5ff12f349f7d7ee99023e5a7f49be9.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<style>html{ scroll-behavior: smooth; }</style>
<link href="modelagem_experimental_explicacoes_files/libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">

<script src="modelagem_experimental_explicacoes_files/libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>

<link href="modelagem_experimental_explicacoes_files/libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">

<script src="modelagem_experimental_explicacoes_files/libs/datatables-binding-0.33/datatables.js"></script>

<script src="modelagem_experimental_explicacoes_files/libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>

<link href="modelagem_experimental_explicacoes_files/libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">

<link href="modelagem_experimental_explicacoes_files/libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">

<script src="modelagem_experimental_explicacoes_files/libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>

<link href="modelagem_experimental_explicacoes_files/libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">

<script src="modelagem_experimental_explicacoes_files/libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>


  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="estilo.css">
</head>

<body class="quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-full">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Sumário</h2>
   
  <ul>
  <li><a href="#instalação-e-carregamento-dos-pacotes" id="toc-instalação-e-carregamento-dos-pacotes" class="nav-link active" data-scroll-target="#instalação-e-carregamento-dos-pacotes"><span class="header-section-number">1</span> Instalação e carregamento dos pacotes</a></li>
  <li><a href="#como-gerar-um-token-de-acesso-pessoal-no-github" id="toc-como-gerar-um-token-de-acesso-pessoal-no-github" class="nav-link" data-scroll-target="#como-gerar-um-token-de-acesso-pessoal-no-github"><span class="header-section-number">2</span> Como gerar um token de acesso pessoal no GitHub</a></li>
  <li><a href="#função-coleta_dados_github" id="toc-função-coleta_dados_github" class="nav-link" data-scroll-target="#função-coleta_dados_github"><span class="header-section-number">3</span> Função coleta_dados_github()</a></li>
  <li><a href="#importação-dos-dados-via-api-do-github" id="toc-importação-dos-dados-via-api-do-github" class="nav-link" data-scroll-target="#importação-dos-dados-via-api-do-github"><span class="header-section-number">4</span> Importação dos dados via API do GitHub</a></li>
  <li><a href="#delineamento-alpha-lattice" id="toc-delineamento-alpha-lattice" class="nav-link" data-scroll-target="#delineamento-alpha-lattice"><span class="header-section-number">5</span> <strong>Delineamento Alpha-Lattice</strong></a></li>
  <li><a href="#sobre-os-dados-experimentais" id="toc-sobre-os-dados-experimentais" class="nav-link" data-scroll-target="#sobre-os-dados-experimentais"><span class="header-section-number">6</span> Sobre os dados experimentais</a></li>
  <li><a href="#ajuste-das-variáveis" id="toc-ajuste-das-variáveis" class="nav-link" data-scroll-target="#ajuste-das-variáveis"><span class="header-section-number">7</span> Ajuste das variáveis</a></li>
  <li><a href="#sobre-o-experimento" id="toc-sobre-o-experimento" class="nav-link" data-scroll-target="#sobre-o-experimento"><span class="header-section-number">8</span> Sobre o experimento</a></li>
  <li><a href="#croqui-experimental" id="toc-croqui-experimental" class="nav-link" data-scroll-target="#croqui-experimental"><span class="header-section-number">9</span> Croqui experimental</a></li>
  <li><a href="#análise-descritiva" id="toc-análise-descritiva" class="nav-link" data-scroll-target="#análise-descritiva"><span class="header-section-number">10</span> Análise descritiva</a></li>
  <li><a href="#modelagem-estatística" id="toc-modelagem-estatística" class="nav-link" data-scroll-target="#modelagem-estatística"><span class="header-section-number">11</span> Modelagem estatística</a>
  <ul class="collapse">
  <li><a href="#modelo-2-genótipo-como-efeito-aleatório---blups" id="toc-modelo-2-genótipo-como-efeito-aleatório---blups" class="nav-link" data-scroll-target="#modelo-2-genótipo-como-efeito-aleatório---blups"><span class="header-section-number">11.1</span> Modelo 2: Genótipo como efeito aleatório - BLUPs</a></li>
  </ul></li>
  <li><a href="#estimativas-dos-blues-e-blups" id="toc-estimativas-dos-blues-e-blups" class="nav-link" data-scroll-target="#estimativas-dos-blues-e-blups"><span class="header-section-number">12</span> Estimativas dos BLUEs E BLUPs</a>
  <ul class="collapse">
  <li><a href="#estimativas-dos-blues---efeito-fixo" id="toc-estimativas-dos-blues---efeito-fixo" class="nav-link" data-scroll-target="#estimativas-dos-blues---efeito-fixo"><span class="header-section-number">12.1</span> Estimativas dos BLUEs - Efeito fixo</a></li>
  <li><a href="#estimativas-dos-blups---efeito-aleatório" id="toc-estimativas-dos-blups---efeito-aleatório" class="nav-link" data-scroll-target="#estimativas-dos-blups---efeito-aleatório"><span class="header-section-number">12.2</span> Estimativas dos BLUPs - Efeito aleatório</a></li>
  </ul></li>
  <li><a href="#herdabilidade" id="toc-herdabilidade" class="nav-link" data-scroll-target="#herdabilidade"><span class="header-section-number">13</span> Herdabilidade</a></li>
  <li><a href="#agrupamento-hierárquico---upgma" id="toc-agrupamento-hierárquico---upgma" class="nav-link" data-scroll-target="#agrupamento-hierárquico---upgma"><span class="header-section-number">14</span> Agrupamento hierárquico - UPGMA</a>
  <ul class="collapse">
  <li><a href="#correlção-cofenética" id="toc-correlção-cofenética" class="nav-link" data-scroll-target="#correlção-cofenética"><span class="header-section-number">14.1</span> Correlção cofenética</a></li>
  </ul></li>
  <li><a href="#considerações-finais" id="toc-considerações-finais" class="nav-link" data-scroll-target="#considerações-finais"><span class="header-section-number">15</span> Considerações finais</a></li>
  </ul>
</nav>
</div>
<main class="content column-page-left" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Portfólio Experimental – Delineamento Alpha-Lattice</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
<p class="subtitle lead">Análise de seleção de genótipos superiores</p>
</div>



<div class="quarto-title-meta column-page-left">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Jennifer Luz Lopes </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="instalação-e-carregamento-dos-pacotes" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="instalação-e-carregamento-dos-pacotes"><span class="header-section-number">1</span> Instalação e carregamento dos pacotes</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">"pacman"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) <span class="fu">install.packages</span>(<span class="st">"pacman"</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  broom,          <span class="co"># Organiza resultados de modelos em formato tidy</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  broom.mixed,    <span class="co"># Versão do broom para modelos mistos</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  desplot,        <span class="co"># Visualiza delineamentos experimentais</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  emmeans,        <span class="co"># Médias ajustadas e comparações múltiplas</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  ggpubr,         <span class="co"># Gráficos estatísticos prontos com ggplot2</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  lme4,           <span class="co"># Modelos lineares mistos</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  lmerTest,       <span class="co"># P-valores para modelos lmer()</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  multcomp,       <span class="co"># Testes múltiplos (Tukey, Dunnett)</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  multcompView,   <span class="co"># Letras de agrupamento (a, b, c)</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  plotly,         <span class="co"># Gráficos interativos</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  tidyverse,      <span class="co"># Conjunto para manipulação e visualização de dados</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>  writexl,        <span class="co"># Exporta dados para Excel</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  metan,          <span class="co"># Análises agronômicas e genéticas (BLUP, MGIDI)</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  httr2,          <span class="co"># Consumo de APIs modernas</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>  readr,          <span class="co"># Leitura rápida de CSV e textos</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>  readxl,         <span class="co"># Importação de planilhas Excel</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>  base64enc,       <span class="co"># Codificação Base64 (arquivos e APIs)</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>  viridis,</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>  DT, </span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>  tidyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="como-gerar-um-token-de-acesso-pessoal-no-github" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="como-gerar-um-token-de-acesso-pessoal-no-github"><span class="header-section-number">2</span> Como gerar um token de acesso pessoal no GitHub</h2>
<p>O Personal Access Token (PAT) é uma credencial que substitui sua senha ao usar a API, CLI ou comandos Git via HTTPS. Ele garante autenticação segura e controle sobre o que pode ser acessado.</p>
<p><strong>Etapas para gerar o token:</strong></p>
<ol type="1">
<li><p>Acesse sua conta GitHub. Entre em github.com com seu usuário e senha.</p></li>
<li><p>Abra as configurações do desenvolvedor. No canto superior direito, clique na sua foto de perfil → Settings → Developer Settings → Personal access tokens.</p></li>
<li><p>Crie um novo token. Clique em Generate new token (ou Create new token (fine-grained), se disponível).</p></li>
<li><p>Defina as informações básicas.</p></li>
<li><p>Dê um nome descritivo ao token (ex: token_api_portfolio);</p></li>
<li><p>Escolha uma data de expiração adequada (por exemplo, 90 dias);</p></li>
<li><p>Selecione apenas os escopos (permissões) necessários — por exemplo, marque repo para acesso a repositórios.</p></li>
<li><p>Gere o token. Clique em Generate token para criar. Importante: copie o valor imediatamente ele não será mostrado novamente.</p></li>
<li><p>Armazene o token com segurança. Guarde em local seguro, por exemplo, em um gerenciador de senhas ou em variáveis de ambiente como <code>Sys.setenv(GITHUB_TOKEN="...")</code>.</p></li>
</ol>
<p><strong>Use o token em suas integrações. Esse token pode ser usado para:</strong></p>
<ul>
<li><p>Autenticação em APIs, ex: <strong><code>httr2::req_auth_bearer_token()</code></strong>;</p></li>
<li><p>Operações Git via HTTPS (push/pull);</p></li>
<li><p>Execuções automatizadas em pipelines e scripts.</p></li>
</ul>
</section>
<section id="função-coleta_dados_github" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="função-coleta_dados_github"><span class="header-section-number">3</span> Função coleta_dados_github()</h2>
<p>Criei a função <strong><code>coleta_dados_github()</code></strong> para automatizar a leitura de arquivos diretamente de um repositório GitHub, sem necessidade de download manual. Ela utiliza o pacote <strong><code>httr2</code></strong><a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> para realizar a requisição HTTP à <strong>API do GitHub</strong><a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>, montando a URL de acesso a partir do nome do repositório, caminho do arquivo e branch especificados.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>Você precisa acessar o GitHub e gerar um <strong>Token de Acesso Pessoal (PAT -Personal Access Token)</strong>.</p>
</div>
</div>
<p>Caso o repositório exija autenticação, o token pessoal do GitHub é aplicado automaticamente via <strong><code>req_auth_bearer_token()</code></strong>.</p>
<p>Após a conexão, a função valida o status da resposta e decodifica o conteúdo retornado, que vem em formato <strong><code>Base64</code></strong> padrão usado pela API para transmitir arquivos binários.</p>
<p>O arquivo é temporariamente salvo e, em seguida, lido conforme sua extensão: arquivos .csv são importados com <strong><code>readr::read_csv()</code></strong> e planilhas .xlsx com <strong><code>readxl::read_excel()</code></strong>.</p>
<p>Ao final, a função retorna um data frame limpo e pronto para análise, exibindo mensagens informativas sobre o número de linhas e colunas carregadas. Essa estrutura modular permite integração direta entre o GitHub e o pipeline experimental.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>coleta_dados_github <span class="ot">&lt;-</span> <span class="cf">function</span>(repo, path, <span class="at">branch =</span> <span class="st">"main"</span>, <span class="at">token =</span> <span class="fu">Sys.getenv</span>(<span class="st">"GITHUB_TOKEN"</span>)) {</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(httr2)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(readr)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(readxl)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(base64enc)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(glue)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Mensagem de debug</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">message</span>(<span class="fu">glue</span>(<span class="st">"Conectando ao repositório {repo}, arquivo: {path}"</span>))</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Monta a URL da API</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  url <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"https://api.github.com/repos/"</span>, repo, <span class="st">"/contents/"</span>, path, <span class="st">"?ref="</span>, branch)</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Requisição</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>  req <span class="ot">&lt;-</span> <span class="fu">request</span>(url)</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">nzchar</span>(token)) {</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>    req <span class="ot">&lt;-</span> <span class="fu">req_auth_bearer_token</span>(req, token)</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Executa a requisição</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>  resp <span class="ot">&lt;-</span> <span class="fu">req_perform</span>(req)</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Se falhar, mostra status</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">resp_status</span>(resp) <span class="sc">&gt;=</span> <span class="dv">300</span>) {</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="fu">glue</span>(<span class="st">"Falha ao acessar GitHub: HTTP {resp_status(resp)}. Verifique o token, repo e caminho."</span>))</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>  obj <span class="ot">&lt;-</span> <span class="fu">resp_body_json</span>(resp)</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.null</span>(obj<span class="sc">$</span>content)) {</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">"Conteúdo vazio verifique se o caminho aponta para um arquivo, não para uma pasta."</span>)</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Decodifica o arquivo em base64</span></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>  raw <span class="ot">&lt;-</span> <span class="fu">base64decode</span>(obj<span class="sc">$</span>content)</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>  ext <span class="ot">&lt;-</span> tools<span class="sc">::</span><span class="fu">file_ext</span>(path)</span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>  tmp <span class="ot">&lt;-</span> <span class="fu">tempfile</span>(<span class="at">fileext =</span> <span class="fu">paste0</span>(<span class="st">"."</span>, ext))</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">writeBin</span>(raw, tmp)</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Lê conforme o tipo</span></span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (ext <span class="sc">==</span> <span class="st">"csv"</span>) {</span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>    dados <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(tmp, <span class="at">show_col_types =</span> <span class="cn">FALSE</span>)</span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (ext <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"xlsx"</span>, <span class="st">"xls"</span>)) {</span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>    dados <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(tmp)</span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">"Formato não suportado: use .csv, .xlsx ou .xls"</span>)</span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">message</span>(<span class="fu">glue</span>(<span class="st">"Dados carregados com sucesso ({nrow(dados)} linhas, {ncol(dados)} colunas)."</span>))</span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(dados)</span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="importação-dos-dados-via-api-do-github" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="importação-dos-dados-via-api-do-github"><span class="header-section-number">4</span> Importação dos dados via API do GitHub</h2>
<p>Nesta etapa, foi realizada a importação automatizada dos dados diretamente do GitHub, garantindo reprodutibilidade e versionamento do experimento. A função <strong><code>coleta_dados_github()</code></strong> foi desenvolvida previamente e armazenada no <strong>diretório funcoes/</strong>, sendo responsável por estabelecer a conexão com o repositório público, localizar o arquivo especificado e fazer o download temporário antes de ler o conteúdo com o pacote <strong><code>readxl</code></strong>.</p>
<p>Essa abordagem elimina a necessidade de armazenar arquivos localmente e permite atualizar os dados sempre que o repositório for modificado. Em seguida, a função <strong><code>glimpse()</code></strong> é utilizada para inspecionar rapidamente a estrutura do dataset, verificando nomes, tipos e exemplos das variáveis que serão analisadas nos próximos blocos.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Carrega a função de coleta de dados (salva em funcoes/coleta_dados_github.R)</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"meu_projeto/funcoes/coleta_dados_github.R"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Coleta dos dados direto do repositório público</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>dados <span class="ot">&lt;-</span> <span class="fu">coleta_dados_github</span>(</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">repo =</span> <span class="st">"JenniferLopes/portfolio_experimentacao_agricola"</span>,</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">path =</span> <span class="st">"meu_projeto/dados/alpha_lattice.xlsx"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualiza estrutura do dataset</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(dados)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 72
Columns: 6
$ rep       &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …
$ inc.bloco &lt;dbl&gt; 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 4, 5, 5, 5, 5, …
$ gen       &lt;chr&gt; "G11", "G04", "G05", "G22", "G21", "G10", "G20", "G02", "G23…
$ prod      &lt;dbl&gt; 41172, 44461, 58757, 45784, 4654, 41736, 40141, 4335, 42323,…
$ row       &lt;dbl&gt; 4, 3, 2, 1, 4, 3, 2, 1, 4, 3, 2, 1, 4, 3, 2, 1, 4, 3, 2, 1, …
$ col       &lt;dbl&gt; 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 4, 5, 5, 5, 5, …</code></pre>
</div>
</div>
</section>
<section id="delineamento-alpha-lattice" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="delineamento-alpha-lattice"><span class="header-section-number">5</span> <strong>Delineamento Alpha-Lattice</strong></h2>
<p>O delineamento <strong><code>Alpha-Lattice</code></strong><a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a> é uma variação do látice incompleto balanceado desenvolvido para experimentos com grande número de tratamentos (genótipos) e número limitado de repetições.</p>
<ul>
<li><p>Ele organiza os tratamentos em blocos incompletos de tamanho fixo, distribuídos aleatoriamente dentro de cada repetição, de forma que cada par de tratamentos ocorra juntos em um número balanceado (ou quase balanceado) de blocos.</p></li>
<li><p>Essa estrutura reduz a variabilidade dentro dos blocos e aumenta a precisão experimental, especialmente quando há heterogeneidade no campo.</p></li>
</ul>
<p>O modelo estatístico para o delineamento Alpha-Lattice inclui efeitos de tratamentos (genótipos), repetições e blocos dentro das repetições, permitindo ajustar as diferenças ambientais por meio de modelos lineares mistos (REML/BLUP).</p>
<p>Por isso, ele é amplamente utilizado em programas de melhoramento genético de plantas, onde se avaliam dezenas ou centenas de linhagens experimentais. Além de aumentar a eficiência da comparação entre genótipos, o delineamento Alpha-Lattice viabiliza o uso de componentes de variância e herdabilidade, fornecendo base sólida para a seleção genotípica mais precisa.</p>
</section>
<section id="sobre-os-dados-experimentais" class="level2" data-number="6">
<h2 data-number="6" class="anchored" data-anchor-id="sobre-os-dados-experimentais"><span class="header-section-number">6</span> Sobre os dados experimentais</h2>
<p>Os dados analisados neste experimento correspondem a um ensaio de avaliação de genótipos conduzido sob delineamento em blocos incompletos do tipo Alpha-Lattice, com o objetivo de estimar parâmetros genéticos e identificar materiais superiores em termos de produtividade.</p>
<ul>
<li><p>O conjunto de dados contém informações de:</p></li>
<li><p>produção por parcela (prod);</p></li>
<li><p>genótipos avaliados (gen);</p></li>
<li><p>repetições (rep);</p></li>
<li><p>blocos incompletos (inc.bloco);</p></li>
<li><p>Além das coordenadas de campo utilizadas para a construção do croqui experimental, col (clouna) e row (linha);</p></li>
<li><p>Cada repetição foi subdividida em blocos menores, chamados de subblocos para reduzir o efeito da variabilidade ambiental e aumentar a precisão das comparações entre genótipos.</p></li>
</ul>
</section>
<section id="ajuste-das-variáveis" class="level2" data-number="7">
<h2 data-number="7" class="anchored" data-anchor-id="ajuste-das-variáveis"><span class="header-section-number">7</span> Ajuste das variáveis</h2>
<p>Neste passo, realizei o ajuste das variáveis categóricas do conjunto de dados para garantir que o modelo estatístico reconheça corretamente os fatores experimentais.</p>
<p>As colunas correspondentes a genótipos (gen), repetições (rep) e blocos incompletos (inc.bloco) são convertidas para o tipo factor, utilizando a função <strong><code>mutate()</code></strong> do <strong><code>dplyr</code></strong>.</p>
<p>Essa conversão é essencial em análises de experimentação agrícola, pois esses efeitos representam níveis de tratamento e estruturas hierárquicas que devem ser tratadas como variáveis qualitativas, e não numéricas.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>dados <span class="ot">&lt;-</span> dados <span class="sc">%&gt;%</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">gen =</span> <span class="fu">as.factor</span>(gen),</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">rep =</span> <span class="fu">as.factor</span>(rep),</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">inc.bloco =</span> <span class="fu">as.factor</span>(inc.bloco))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="sobre-o-experimento" class="level2" data-number="8">
<h2 data-number="8" class="anchored" data-anchor-id="sobre-o-experimento"><span class="header-section-number">8</span> Sobre o experimento</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>resumo <span class="ot">&lt;-</span> dados <span class="sc">%&gt;%</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_genotipos   =</span> <span class="fu">n_distinct</span>(gen),</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_repeticoes  =</span> <span class="fu">n_distinct</span>(rep),</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_blocos_inc      =</span> <span class="fu">n_distinct</span>(inc.bloco))</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(resumo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 3
  n_genotipos n_repeticoes n_blocos_inc
        &lt;int&gt;        &lt;int&gt;        &lt;int&gt;
1          24            3            6</code></pre>
</div>
</div>
</section>
<section id="croqui-experimental" class="level2" data-number="9">
<h2 data-number="9" class="anchored" data-anchor-id="croqui-experimental"><span class="header-section-number">9</span> Croqui experimental</h2>
<p>O croqui do experimento, foi representado graficamente no delineamento alpha-lattice. Para isso, utilizei o pacote <strong><code>ggplot2</code></strong>, mapeando as coordenadas de campo onde cada célula <strong><code>geom_tile()</code></strong> representa uma unidade experimental e é identificada pelo respectivo genótipo (label = gen).</p>
<p>A coloração das parcelas foi definida pela variável inc.bloco, permitindo destacar visualmente os blocos incompletos. Em seguida, apliquei <strong><code>facet_wrap(~ rep)</code></strong> para separar as repetições em painéis distintos, o que facilita a inspeção da uniformidade entre blocos dentro de cada repetição.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>dados <span class="ot">&lt;-</span> dados <span class="sc">%&gt;%</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">inc.bloco =</span> <span class="fu">as.factor</span>(inc.bloco))</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>croqui <span class="ot">&lt;-</span> dados <span class="sc">%&gt;%</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> col, <span class="at">y =</span> row, <span class="at">fill =</span> inc.bloco)) <span class="sc">+</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> gen), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">"C"</span>, <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> rep, <span class="at">scales =</span> <span class="st">"free_x"</span>) <span class="sc">+</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Croqui de Campo - Portfólio Experimental"</span>,</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Colunas"</span>,</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Linhas"</span>,</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Bloco incompleto"</span>, </span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"Jennifer Lopes."</span>)</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(croqui)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelagem_experimental_explicacoes_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="análise-descritiva" class="level2" data-number="10">
<h2 data-number="10" class="anchored" data-anchor-id="análise-descritiva"><span class="header-section-number">10</span> Análise descritiva</h2>
<p>Foi realizada à análise descritiva da variável produtividade (prod), utilizando a função <strong><code>desc_stat()</code></strong> do pacote <strong><code>metan</code></strong>. Essa função permite gerar estatísticas resumo como média, mediana, desvio-padrão, coeficiente de variação e amplitude e, quando <strong><code>hist = TRUE</code></strong>, apresenta o histograma da distribuição dos dados. O argumento <strong><code>stats = "main"</code></strong> foi utilizado para focar nos indicadores principais, garantindo uma leitura rápida e objetiva das medidas de tendência central e dispersão.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>descritiva <span class="ot">&lt;-</span> dados <span class="sc">%&gt;%</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  metan<span class="sc">::</span><span class="fu">desc_stat</span>(prod, <span class="at">hist =</span> <span class="cn">TRUE</span>, <span class="at">stats =</span> <span class="st">"main"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelagem_experimental_explicacoes_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>O histograma gerado pela função <strong><code>desc_stat()</code></strong> representa a distribuição dos valores observados de produtividade (prod) entre os genótipos avaliados.</p>
<ul>
<li><p>Observa-se uma concentração predominante de parcelas com produtividade entre 35.000 e 50.000 kg/ha, indicando que a maior parte dos genótipos apresenta desempenho médio a alto.</p></li>
<li><p>Há também um pequeno grupo com valores muito baixos, próximos de zero, que provavelmente correspondem a falhas de campo ou perdas experimentais.</p></li>
<li><p>Essa dispersão assimétrica sugere a presença de heterogeneidade entre genótipos e blocos, reforçando a necessidade do uso de modelos mistos (<strong><code>REML/BLUP</code></strong>) nas etapas seguintes, para separar o componente genético do ambiental e obter estimativas mais precisas dos efeitos.</p></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(descritiva)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-44ef1d319c9fb8175dab" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-44ef1d319c9fb8175dab">{"x":{"filter":"none","vertical":false,"data":[["1"],["prod"],[36.7224],[58757],[39772.1667],[43138],[3342],[14605.2905],[1721.25],[3432.075],[72]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>variable<\/th>\n      <th>cv<\/th>\n      <th>max<\/th>\n      <th>mean<\/th>\n      <th>median<\/th>\n      <th>min<\/th>\n      <th>sd.amo<\/th>\n      <th>se<\/th>\n      <th>ci.t<\/th>\n      <th>n.valid<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[2,3,4,5,6,7,8,9,10]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"variable","targets":1},{"name":"cv","targets":2},{"name":"max","targets":3},{"name":"mean","targets":4},{"name":"median","targets":5},{"name":"min","targets":6},{"name":"sd.amo","targets":7},{"name":"se","targets":8},{"name":"ci.t","targets":9},{"name":"n.valid","targets":10}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<ul>
<li><p>A tabela de estatísticas descritivas resume o comportamento da variável de produtividade (prod) no experimento. Ao interpretar os resultados, é possível observar que a média foi de aproximadamente 39.772 kg/ha, enquanto a mediana foi de 43.138 kg/ha, indicando uma leve assimetria negativa ou seja, há algumas parcelas com produtividade mais baixa que puxam a média para baixo.</p></li>
<li><p>O valor máximo (58.757 kg/ha) representa o melhor desempenho entre os genótipos avaliados, e o mínimo (3.342 kg/ha) confirma a presença de valores muito baixos observados no histograma, possivelmente relacionados a falhas de campo.</p></li>
<li><p>O desvio-padrão (14.605) e o coeficiente de variação (36,7%) refletem alta variabilidade experimental, o que é esperado em populações ainda segregantes.</p></li>
<li><p>Já o erro padrão da média (1.721) e o intervalo de confiança (±3.432) indicam boa precisão das estimativas, considerando o número de observações válidas (n = 72).</p></li>
</ul>
</section>
<section id="modelagem-estatística" class="level2" data-number="11">
<h2 data-number="11" class="anchored" data-anchor-id="modelagem-estatística"><span class="header-section-number">11</span> Modelagem estatística</h2>
<p>Nesta etapa, ajustei dois modelos lineares mistos para avaliar a produtividade dos genótipos no delineamento alpha-lattice, explorando duas abordagens distintas: efeito fixo e efeito aleatório. Essa comparação é essencial para compreender o comportamento da variável de interesse sob diferentes pressupostos de inferência e para decidir qual estratégia oferece estimativas mais adequadas ao objetivo experimental.</p>
<section id="modelo-1---genótipo-como-efeito-fixo-blues" class="level4" data-number="11.0.1">
<h4 data-number="11.0.1" class="anchored" data-anchor-id="modelo-1---genótipo-como-efeito-fixo-blues"><span class="header-section-number">11.0.1</span> Modelo 1 - Genótipo como efeito fixo (BLUEs)</h4>
<p>Essa abordagem gera as Estimativas Lineares Não Viesadas (BLUEs), que representam as médias ajustadas dos genótipos após o controle dos efeitos de repetição e blocos incompletos. Esse tipo de modelagem é apropriado quando o interesse está em comparar diretamente os genótipos avaliados no experimento, sem extrapolar conclusões para um conjunto maior de materiais genéticos. Utilizei a função <code>anova()</code> com o método <code>Kenward–Roger</code><a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a> para obter o teste de significância dos efeitos fixos. Além disso, avaliei os resíduos e a sua normalidade, a fim de verificar o atendimento aos pressupostos do modelo.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>mod.fg <span class="ot">&lt;-</span> <span class="fu">lmer</span>(prod <span class="sc">~</span> gen <span class="sc">+</span> rep <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> rep<span class="sc">:</span>inc.bloco), <span class="at">data =</span> dados)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>O modelo matemático foi especificado da seguinte forma:</strong></p>
<p><span class="math inline">\(yijk​=μ+gi​+rj​+bk(j)​+εijk\)</span></p>
<table class="caption-top table">
<colgroup>
<col style="width: 20%">
<col style="width: 79%">
</colgroup>
<thead>
<tr class="header">
<th>Componentes</th>
<th>Descrição</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(y_{ijk}\)</span></td>
<td>Observação do rendimento do genótipo (<em>i</em>) na repetição (<em>j</em>) e bloco incompleto (<em>k</em>)</td>
</tr>
<tr class="even">
<td><span class="math inline">\(u\)</span></td>
<td>Média geral do experimento</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(g_i\)</span></td>
<td>Efeito fixo do <strong>genótipo</strong> <span class="math inline">\(i = 1, 2, \ldots, G\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(r_j\)</span></td>
<td>Efeito fixo da <strong>repetição</strong> <span class="math inline">\(j = 1, 2, \ldots,R\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(b_{k(j)}\)</span></td>
<td>Efeito <strong>aleatório do bloco incompleto</strong> (<em>k</em>) dentro da repetição (j), assumindo <span class="math inline">\(b_{k(j)} \sim N(0, \sigma_b^2)\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(\varepsilon_{ijk}\)</span></td>
<td>Erro aleatório, assumindo <span class="math inline">\(\varepsilon_{ijk} \sim N(0, \sigma_e^2)\)</span> e independentes entre si</td>
</tr>
</tbody>
</table>
<p>No ajuste do modelo misto, foram consideradas as seguintes especificações:</p>
<ul>
<li><p><strong>Efeito fixo de genótipo (<code>gen</code>)</strong></p>
<ul>
<li><p>Representa os tratamentos ou linhagens avaliadas.</p></li>
<li><p>O interesse está em estimar e comparar diretamente o desempenho médio de cada genótipo (efeitos fixos - <strong>BLUEs</strong>).</p></li>
</ul></li>
<li><p><strong>Efeito fixo de repetição (<code>rep</code>)</strong></p>
<ul>
<li>Controla as variações sistemáticas entre as repetições (ex.: diferenças de ambiente, fertilidade do solo ou manejo entre blocos experimentais).</li>
</ul></li>
<li><p><strong>Efeito aleatório de bloco incompleto dentro da repetição (<code>rep:inc.bloco</code>)</strong></p>
<ul>
<li><p>Captura a variação aleatória entre blocos dentro de cada repetição.<br>
Essa estrutura é essencial no delineamento <strong>alpha-lattice</strong>, em que:</p>
<ul>
<li><p>Os tratamentos são distribuídos em <strong>blocos incompletos</strong>, menores que o número total de genótipos;</p></li>
<li><p>Cada bloco é um <strong>subconjunto dos tratamentos</strong>, utilizado para reduzir o erro experimental;</p></li>
<li><p>O termo aleatório permite <strong>modelar a dependência</strong> entre parcelas do mesmo bloco, aumentando a precisão das estimativas dos efeitos fixos.​</p></li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="diagnóstico-de-resíduos" class="level4" data-number="11.0.2">
<h4 data-number="11.0.2" class="anchored" data-anchor-id="diagnóstico-de-resíduos"><span class="header-section-number">11.0.2</span> Diagnóstico de resíduos</h4>
<p>O gráfico Resíduos x Ajustados do modelo fixo (BLUE) mostra a dispersão dos resíduos em relação aos valores ajustados pelo modelo.</p>
<ul>
<li><p>Ao analisar o gráfico, foi possível observar uma distribuição aleatória dos pontos ao redor da linha zero, sem tendência clara, o que indica que o modelo não apresenta viés sistemático na predição da produtividade.</p></li>
<li><p>No entanto, é possível verificar também, uma maior variabilidade dos resíduos em níveis intermediários e altos de produtividade, sugerindo heterocedasticidade leve, isto é, variação desigual do erro entre os níveis de resposta.</p></li>
<li><p>Apesar disso, os resíduos permanecem majoritariamente centrados em torno de zero, o que é desejável em um modelo bem ajustado.</p></li>
<li><p>Em experimentos agrícolas, pequenas variações são esperadas devido a fatores ambientais e do campo experimental, mas o padrão geral indica que o modelo fixo se ajusta adequadamente aos dados observados.</p></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">resid</span>(mod.fg) <span class="sc">~</span> <span class="fu">fitted</span>(mod.fg),</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Resíduos vs Ajustados - Modelo Fixo (BLUE)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelagem_experimental_explicacoes_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>No gráfico Q-Q Plot do modelo fixo, foi avaliada a normalidade dos resíduos, comparando os quantis observados (eixo y) com os quantis teóricos da distribuição normal (eixo x).</p>
<ul>
<li><p>Visualmente, observei que a maioria dos pontos segue próxima da linha diagonal, indicando que os resíduos apresentam comportamento aproximadamente normal.</p></li>
<li><p>Apenas pequenas deformações nas extremidades (caudas) sugerem uma leve assimetria, o que é comum em dados de produtividade agrícola, especialmente em populações ainda segregantes.</p></li>
<li><p>Essa análise é importante porque a suposição de normalidade dos erros garante a validade dos testes F e das estimativas de variância no modelo.</p></li>
<li><p>Apesar das pequenas discrepâncias nas caudas, o ajuste é considerado adequado para fins de inferência, não comprometendo a interpretação dos efeitos fixos e a obtenção das médias ajustadas (BLUEs).</p></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(mod.fg)); <span class="fu">qqline</span>(<span class="fu">resid</span>(mod.fg))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelagem_experimental_explicacoes_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="anova-para-efeitos-fixos" class="level4" data-number="11.0.3">
<h4 data-number="11.0.3" class="anchored" data-anchor-id="anova-para-efeitos-fixos"><span class="header-section-number">11.0.3</span> ANOVA para efeitos fixos</h4>
<p>Em seguida, foi realizada à análise de variância (ANOVA) para o modelo com genótipos tratados como efeitos fixos, utilizando o método Kenward-Roger para o cálculo dos graus de liberdade (ddf = “Kenward-Roger”).</p>
<ul>
<li><p>Essa abordagem é mais apropriada em experimentos com número limitado de repetições e estruturas desbalanceadas, pois ajusta a variância dos erros e fornece testes F mais precisos.</p></li>
<li><p>O objetivo aqui foi avaliar a significância dos efeitos de genótipo, repetição e blocos incompletos sobre a produtividade.</p></li>
<li><p>Quando o efeito de genótipo é significativo, isso indica que existe variabilidade real entre os materiais avaliados, justificando o prosseguimento da análise com comparações múltiplas e estimativas médias ajustadas (BLUEs).</p></li>
<li><p>Além disso, essa etapa permite confirmar se a estrutura do delineamento (blocos incompletos dentro de repetições) foi eficiente em controlar a heterogeneidade experimental, garantindo que as diferenças observadas entre genótipos sejam atribuídas majoritariamente a causas genéticas e não ao ruído ambiental.</p></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>anova_fg <span class="ot">&lt;-</span> <span class="fu">anova</span>(mod.fg, <span class="at">ddf =</span> <span class="st">"Kenward-Roger"</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>anova_fg</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Type III Analysis of Variance Table with Kenward-Roger's method
        Sum Sq   Mean Sq NumDF  DenDF F value  Pr(&gt;F)  
gen 5951733732 258771032    23 38.024  1.9325 0.03499 *
rep 1007639474 503819737     2  8.142  3.7693 0.06938 .
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>A tabela da ANOVA com o método de Kenward-Roger apresenta os testes de significância para os efeitos fixos incluídos no modelo.</p>
<ul>
<li><p>Ao interpretar os resultados, foi possível observar que o efeito de genótipo foi significativo (F=1,93; p=0,03598), indicando que existe variabilidade estatisticamente detectável entre os genótipos avaliados quanto à produtividade.</p></li>
<li><p>Esse resultado confirma que as diferenças observadas não se devem apenas ao acaso, mas refletem diferenças genéticas reais entre os materiais testados.</p></li>
<li><p>Por outro lado, o efeito de repetição (F=0,02; p=0,88) não foi significativo, o que sugere que as condições experimentais entre as repetições foram homogêneas, sem variações no ambiente.</p></li>
</ul>
<blockquote class="blockquote">
<p>A significância do fator genótipo valida o uso do modelo misto na sequência da análise, permitindo estimar as médias ajustadas (BLUEs) e, posteriormente, comparar o desempenho dos materiais.</p>
</blockquote>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>A ANOVA Tipo III foi utilizada porque o modelo ajustado não é completamente ortogonal ou seja, os efeitos dos fatores (genótipos, repetições e blocos) não são totalmente independentes. Nesse tipo de modelo, cada termo deve ser avaliado ajustando-se para os demais fatores presentes.</p>
</div>
</div>
</section>
<section id="modelo-2-genótipo-como-efeito-aleatório---blups" class="level3" data-number="11.1">
<h3 data-number="11.1" class="anchored" data-anchor-id="modelo-2-genótipo-como-efeito-aleatório---blups"><span class="header-section-number">11.1</span> Modelo 2: Genótipo como efeito aleatório - BLUPs</h3>
<p>Neste segundo modelo, considerei o genótipo como efeito aleatório, o que transforma a natureza da inferência do modelo.</p>
<p>Essa modelagem tem como objetivo predizer o valor genético dos genótipos ou seja, estimar seus BLUPs (Best Linear Unbiased Predictors).<br>
Enquanto o modelo fixo fornece médias ajustadas (BLUEs) apenas para os genótipos testados, este modelo permite inferir sobre uma população maior, tratando os genótipos como uma amostra aleatória dentro do programa de melhoramento.</p>
<p>Essa abordagem é mais realista e robusta no contexto do melhoramento genético vegetal, pois considera a variabilidade genética como um componente da variância total e reduz o impacto de observações extremas.<br>
Além disso, ao estimar simultaneamente as variâncias genética (σg2_g^2σg2​), de bloco (σb2_b^2σb2​) e residual (σ2^2σ2), o modelo fornece base para calcular parâmetros genéticos, como herdabilidade e acurácia seletiva fundamentais para a etapa de seleção de linhagens promissoras.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>mod.rg <span class="ot">&lt;-</span> <span class="fu">lmer</span>(prod <span class="sc">~</span> rep <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> gen) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> rep<span class="sc">:</span>inc.bloco), <span class="at">data =</span> dados)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>O modelo matemático foi especificado da seguinte forma:</strong></p>
<section id="diagnóstico-de-resíduos-1" class="level4" data-number="11.1.1">
<h4 data-number="11.1.1" class="anchored" data-anchor-id="diagnóstico-de-resíduos-1"><span class="header-section-number">11.1.1</span> Diagnóstico de resíduos</h4>
<p>Ao analisar o gráfico Resíduos vs Ajustados do modelo aleatório (BLUP), eu verifico o comportamento dos erros em relação aos valores preditos.<br>
Os pontos se distribuem de forma predominantemente aleatória ao redor da linha zero, sem formação de padrões evidentes, o que indica que o modelo apresenta homocedasticidade, ou seja, variância constante dos resíduos ao longo da faixa de produtividades ajustadas.</p>
<p>Percebo, entretanto, alguns pontos mais dispersos na extremidade inferior referentes a parcelas com produtividade muito baixa o que é comum em ensaios de campo, onde variações ambientais e falhas experimentais podem gerar resíduos extremos.<br>
Mesmo assim, a tendência geral mostra que o modelo aleatório ajustou bem a estrutura dos dados, capturando os efeitos genéticos e de bloco de forma eficiente.</p>
<p>Esse tipo de diagnóstico é essencial para confirmar que as suposições do modelo misto foram atendidas e que as estimativas dos BLUPs são estatisticamente confiáveis. A ausência de padrões sistemáticos reforça a qualidade do ajuste e a adequação da estrutura de variâncias adotada no modelo.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">resid</span>(mod.rg) <span class="sc">~</span> <span class="fu">fitted</span>(mod.rg), <span class="at">main =</span> <span class="st">"Resíduos vs Ajustados - Modelo Aleatório (BLUP)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelagem_experimental_explicacoes_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>No gráfico Q-Q Plot do modelo aleatório (BLUP), eu avalio se os resíduos seguem a distribuição normal teórica, um dos pressupostos fundamentais do modelo misto.<br>
A maioria dos pontos se alinha bem à linha diagonal, o que indica que a distribuição dos resíduos é aproximadamente normal. Apenas pequenas deformações nas extremidades (caudas) podem ser observadas, refletindo a presença de alguns valores atípicos comportamento comum em experimentos agrícolas devido à variabilidade natural entre parcelas.</p>
<p>Essa proximidade entre os quantis observados e teóricos confirma que o ajuste do modelo é adequado e que as inferências obtidas (como os componentes de variância e os BLUPs) são estatisticamente válidas.<br>
Em síntese, o modelo aleatório apresentou boa aderência à normalidade e homogeneidade de variâncias, reforçando sua consistência para estimar parâmetros genéticos e predizer o desempenho dos genótipos.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(mod.rg)); <span class="fu">qqline</span>(<span class="fu">resid</span>(mod.rg))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelagem_experimental_explicacoes_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="teste-de-significância-dos-componentes-de-variância" class="level4" data-number="11.1.2">
<h4 data-number="11.1.2" class="anchored" data-anchor-id="teste-de-significância-dos-componentes-de-variância"><span class="header-section-number">11.1.2</span> Teste de significância dos componentes de variância</h4>
<p>Nesta etapa, eu realizei o teste de significância dos componentes de variância por meio da função <code>ranova()</code>, que avalia se os efeitos aleatórios incluídos no modelo contribuem de forma significativa para explicar a variabilidade observada na produtividade.<br>
O procedimento compara o modelo completo com versões reduzidas (sem cada efeito aleatório), utilizando testes de razão de verossimilhança (Likelihood Ratio Test).</p>
<p>Quando o resultado indica que o componente de variância associado ao genótipo é significativo, isso confirma que existe variabilidade genética expressiva na população avaliada, o que justifica a aplicação do modelo misto e a obtenção dos BLUPs para seleção dos melhores materiais.<br>
Da mesma forma, a significância do componente de bloco dentro de repetição indica que o delineamento alpha-lattice foi eficiente em captar variações ambientais locais, contribuindo para a redução do erro residual e o aumento da precisão experimental.</p>
<p>A <code>ranova()</code> permite validar estatisticamente a estrutura hierárquica do modelo e assegurar que cada efeito aleatório considerado genótipos, blocos e erro desempenha papel relevante na explicação da variância total, garantindo um modelo parcimonioso e biologicamente coerente com o delineamento do experimento.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>ranova_rg <span class="ot">&lt;-</span> <span class="fu">ranova</span>(mod.rg)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>ranova_rg</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>ANOVA-like table for random-effects: Single term deletions

Model:
prod ~ rep + (1 | gen) + (1 | rep:inc.bloco)
                    npar  logLik    AIC    LRT Df Pr(&gt;Chisq)  
&lt;none&gt;                 6 -759.47 1530.9                       
(1 | gen)              5 -761.61 1533.2 4.2679  1    0.03884 *
(1 | rep:inc.bloco)    5 -759.69 1529.4 0.4393  1    0.50745  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>A tabela do teste de significância dos componentes de variância mostra os resultados da remoção individual dos efeitos aleatórios do modelo genótipo e bloco dentro de repetição avaliados pelo teste de razão de verossimilhança (LRT).</p>
<p>Ao interpretar os valores, eu observo que ambos os componentes apresentam significância marginal:</p>
<ul>
<li><p>O efeito de genótipo apresentou p=0,064p = 0{,}064p=0,064, próximo ao limite de 0,05,</p></li>
<li><p>e o efeito de bloco dentro de repetição apresentou p=0,088p = 0{,}088p=0,088.</p></li>
<li><p>Esses resultados indicam que ambos os efeitos contribuem de forma relevante para explicar a variabilidade da produtividade, ainda que a significância estatística não seja plena.<br>
Na prática, isso sugere que existe variabilidade genética entre os genótipos, e que o delineamento alpha-lattice foi eficiente em reduzir a heterogeneidade ambiental, justificando a manutenção desses efeitos no modelo.</p></li>
<li><p>O logLik (-772.42) e o AIC (1554.8) confirmam que o modelo completo apresenta melhor ajuste global em relação às versões reduzidas, reforçando a adequação da estrutura aleatória escolhida.</p></li>
<li><p>Esses resultados validam o uso do modelo misto com genótipos e blocos como efeitos aleatórios, pois ele representa de forma coerente a estrutura genética e experimental dos dados.</p></li>
</ul>
</section>
<section id="comparação-entre-modelos-aic-e-loglik" class="level4" data-number="11.1.3">
<h4 data-number="11.1.3" class="anchored" data-anchor-id="comparação-entre-modelos-aic-e-loglik"><span class="header-section-number">11.1.3</span> Comparação entre modelos (AIC e LogLik)</h4>
<p>Por fim, eu comparei o desempenho dos dois modelos o de efeito fixo (BLUE) e o de efeito aleatório (BLUP) utilizando os critérios AIC (Akaike Information Criterion) e logLik (logaritmo da verossimilhança).<br>
Esses indicadores permitem avaliar a qualidade de ajuste e a parcimônia dos modelos, isto é, o equilíbrio entre complexidade e capacidade explicativa.</p>
<p>O AIC é uma medida em que valores menores indicam melhor ajuste, enquanto o logLik reflete a verossimilhança do modelo quanto maior, melhor a adequação aos dados observados.<br>
Ao comparar os resultados, eu observo que o modelo aleatório (BLUP) apresenta menor AIC e maior logLik em relação ao modelo fixo, o que indica melhor desempenho estatístico e maior capacidade preditiva.</p>
<p>Essa diferença reforça que tratar o genótipo como efeito aleatório é mais apropriado neste contexto, pois o interesse está na predição do valor genético e na seleção de indivíduos, e não apenas na comparação pontual dos materiais testados.<br>
Além disso, o modelo BLUP permite estimar componentes de variância genética e ambiental, fundamentais para o cálculo de parâmetros genéticos e para orientar as próximas etapas do programa de melhoramento.</p>
<p>Em síntese, a comparação dos critérios de ajuste confirma que o modelo misto com genótipo aleatório (BLUP) é estatisticamente mais eficiente e biologicamente mais coerente para representar o comportamento dos genótipos avaliados neste experimento.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>aic_comp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Modelo =</span> <span class="fu">c</span>(<span class="st">"Efeito Fixo (BLUE)"</span>, <span class="st">"Efeito Aleatório (BLUP)"</span>),</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">AIC =</span> <span class="fu">c</span>(<span class="fu">AIC</span>(mod.fg), <span class="fu">AIC</span>(mod.rg)),</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">logLik =</span> <span class="fu">c</span>(<span class="fu">logLik</span>(mod.fg), <span class="fu">logLik</span>(mod.rg))</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(aic_comp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                   Modelo      AIC    logLik
1      Efeito Fixo (BLUE) 1082.702 -513.3511
2 Efeito Aleatório (BLUP) 1530.942 -759.4711</code></pre>
</div>
</div>
<p>Ao comparar os critérios de ajuste, eu observei uma diferença considerável entre os modelos de efeito fixo (BLUE) e aleatório (BLUP).<br>
O modelo BLUE apresentou AIC = 1106,28 e logLik = -526,14, enquanto o modelo BLUP apresentou AIC = 1554,83 e logLik = -772,42.</p>
<p>Como o AIC é uma medida de qualidade de ajuste penalizada pela complexidade do modelo, valores menores indicam melhor desempenho estatístico.<br>
Nesse caso, o modelo com efeito fixo (BLUE) apresentou menor AIC e maior logLik, demonstrando melhor ajuste aos dados observados sob a ótica puramente estatística.</p>
<p>No entanto, a escolha do modelo não depende apenas do critério numérico.<br>
O modelo BLUP, apesar do AIC mais alto, é conceitualmente mais adequado para estudos de melhoramento genético, pois considera o genótipo como efeito aleatório, permitindo estimar componentes de variância e realizar predição de valores genéticos (BLUPs).<br>
Dessa forma, o modelo fixo é mais descritivo, adequado para comparação direta entre genótipos avaliados, enquanto o modelo aleatório é mais preditivo, ideal para inferir sobre o desempenho genético e orientar a seleção de linhagens superiores.</p>
<p>Em síntese, o modelo BLUE apresentou melhor ajuste estatístico, mas o modelo BLUP oferece maior utilidade biológica e interpretativa dentro do contexto de programas de melhoramento vegetal, onde o interesse é a predição e seleção.</p>
</section>
</section>
</section>
<section id="estimativas-dos-blues-e-blups" class="level2" data-number="12">
<h2 data-number="12" class="anchored" data-anchor-id="estimativas-dos-blues-e-blups"><span class="header-section-number">12</span> Estimativas dos BLUEs E BLUPs</h2>
<section id="estimativas-dos-blues---efeito-fixo" class="level3" data-number="12.1">
<h3 data-number="12.1" class="anchored" data-anchor-id="estimativas-dos-blues---efeito-fixo"><span class="header-section-number">12.1</span> Estimativas dos BLUEs - Efeito fixo</h3>
<p>Nesta etapa, <strong>eu obtive as estimativas BLUEs (Best Linear Unbiased Estimates)</strong>, correspondentes às médias ajustadas dos genótipos considerando o modelo com <strong>efeitos fixos</strong>.<br>
Utilizei a função <code>emmeans()</code> do pacote <strong><code>emmeans</code></strong>, que calcula as médias marginais ajustadas após o controle dos efeitos de repetição e blocos incompletos.</p>
<p>Em seguida, converti o resultado para <em>data frame</em> e selecionei as colunas principais:</p>
<ul>
<li><p><code>gen</code>: identificação dos genótipos,</p></li>
<li><p><code>BLUE</code>: média ajustada estimada,</p></li>
<li><p><code>IC_inferior</code> e <code>IC_superior</code>: limites inferior e superior do <strong>intervalo de confiança (95%)</strong> para cada genótipo.</p></li>
<li><p>Essas estimativas representam o <strong>desempenho fenotípico médio dos genótipos</strong>, já corrigido pelas variações ambientais controladas no modelo.<br>
O uso das <strong>BLUEs</strong> é apropriado quando o objetivo é <strong>comparar diretamente os materiais testados</strong> no experimento, fornecendo uma base para a <strong>classificação e agrupamento dos genótipos</strong> com base nas médias ajustadas de produtividade.</p></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>BLUEs <span class="ot">&lt;-</span> emmeans<span class="sc">::</span><span class="fu">emmeans</span>(mod.fg, <span class="sc">~</span> gen) <span class="sc">%&gt;%</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(gen, <span class="at">BLUE =</span> emmean, <span class="at">IC_inferior =</span> lower.CL, <span class="at">IC_superior =</span> upper.CL)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(BLUEs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-f1ae5b0546a2e80d570c" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-f1ae5b0546a2e80d570c">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24"],["G01","G02","G03","G04","G05","G06","G07","G08","G09","G10","G11","G12","G13","G14","G15","G16","G17","G18","G19","G20","G21","G22","G23","G24"],[51401.5539976853,20831.83584322427,24114.4520010253,31127.86399468413,49862.29502113721,48195.39902603131,40996.49092079704,44694.03598295247,36980.25817511476,43339.91163599859,41902.95359065419,31312.70104288231,18228.23846285845,45917.58826401556,49268.35618753515,47680.92645383204,46422.27683338303,44722.40404518506,49341.66145620843,38819.45013142029,20831.78970508904,45867.85590479807,40219.49749907546,42452.20382441271],[36810.44627215533,6240.728117694358,9523.34427549539,16536.75626915421,35268.71608556522,33601.82009045933,26405.38319526712,30102.92825742255,22386.67923954278,28748.80391046868,27311.84586512427,16721.59331735239,3634.659527286465,31324.00932844358,34674.77725196317,33089.81872830213,31828.69789781105,30131.29631965514,34748.08252063645,24225.87119584831,6238.210769517051,31274.27696922609,25625.91856350348,27861.09609888279],[65992.66172321526,35422.94356875419,38705.55972655522,45718.97172021405,64455.8739567092,62788.9779616033,55587.59864632696,59285.14370848238,51573.83711068674,57931.01936152851,56494.0613161841,45903.80876841222,32821.81739843043,60511.16719958755,63861.93512310713,62272.03417936196,61015.85576895501,59313.51177071498,63935.2403917804,53413.02906699228,35425.36864066103,60461.43484037006,54813.07643464745,57043.31154994263]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>gen<\/th>\n      <th>BLUE<\/th>\n      <th>IC_inferior<\/th>\n      <th>IC_superior<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[2,3,4]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"gen","targets":1},{"name":"BLUE","targets":2},{"name":"IC_inferior","targets":3},{"name":"IC_superior","targets":4}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="estimativas-dos-blups---efeito-aleatório" class="level3" data-number="12.2">
<h3 data-number="12.2" class="anchored" data-anchor-id="estimativas-dos-blups---efeito-aleatório"><span class="header-section-number">12.2</span> Estimativas dos BLUPs - Efeito aleatório</h3>
<p>Nesta etapa, <strong>eu estimei os BLUPs (Best Linear Unbiased Predictors)</strong> a partir do modelo com <strong>genótipo como efeito aleatório</strong>.<br>
Primeiro, extraí a <strong>média geral (</strong>μ) do modelo por meio da função <code>fixef(mod.rg)[1]</code>, que representa o intercepto fixo ou seja, o valor médio da produtividade considerando todos os efeitos ajustados.</p>
<p>Em seguida, utilizei a função <code>ranef()</code> para obter os <strong>efeitos aleatórios individuais de cada genótipo</strong>, correspondentes aos desvios em relação à média geral, e combinei essas estimativas com o valor de μpara calcular o <strong>BLUP de cada genótipo</strong>:</p>
<p>BLUPj=μ+g^j_j = + _jBLUPj​=μ+g^​j​</p>
<p>onde g^j_jg^​j​ é o valor predito para o efeito aleatório do genótipo jjj.</p>
<p>Para cada genótipo, também calculei os <strong>intervalos de confiança (95%)</strong>, utilizando o erro-padrão associado à predição.<br>
As colunas finais incluem:</p>
<ul>
<li><p><code>gen</code>: identificação do genótipo,</p></li>
<li><p><code>BLUP</code>: valor genético predito,</p></li>
<li><p><code>IC_inferior</code> e <code>IC_superior</code>: limites inferior e superior de confiança.</p></li>
<li><p>Essas estimativas representam o <strong>desempenho genético ajustado</strong> dos materiais avaliados, já descontando a influência ambiental e de blocos.<br>
Diferente das BLUEs, os BLUPs permitem <strong>predizer o valor genético de genótipos não avaliados diretamente</strong> e <strong>suportam decisões de seleção</strong>, sendo, portanto, mais adequados ao contexto de <strong>melhoramento genético de plantas</strong>.</p></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>mu_manual <span class="ot">&lt;-</span> <span class="fu">fixef</span>(mod.rg)[<span class="dv">1</span>]</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>BLUPs <span class="ot">&lt;-</span> <span class="fu">augment</span>(<span class="fu">ranef</span>(mod.rg)) <span class="sc">%&gt;%</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(grp <span class="sc">==</span> <span class="st">"gen"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(<span class="at">gen =</span> level,</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">BLUP =</span> mu_manual <span class="sc">+</span> estimate,</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">IC_inferior =</span> BLUP <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> std.error,</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">IC_superior =</span> BLUP <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> std.error)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(BLUPs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-ca364dd3e88008d92f59" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-ca364dd3e88008d92f59">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24"],["G13","G21","G02","G03","G04","G12","G09","G20","G07","G23","G11","G24","G10","G18","G08","G14","G22","G17","G16","G06","G19","G15","G05","G01"],[26006.0077319847,27223.32122118213,27269.81625033347,28772.65084780521,32216.92472153421,32857.0966694836,35366.21876298595,36668.26292263348,37343.95766077066,37356.43302589647,38106.55532569488,38406.0881523367,39174.54696420601,39613.27265641548,39718.19730354406,39948.88485064326,40416.66703298823,40454.5402020833,40925.84535504637,41196.33059085052,41856.27113795799,41935.23468067336,42262.76732124948,42724.10861170154],[16190.75845083472,17408.07194003215,17454.56696918349,18957.40156665523,22401.69583986439,23041.86778781378,25550.96948183597,26853.0136414835,27528.72877910084,27541.18374474649,28291.3060445449,28590.83887118672,29359.31808253619,29798.04377474566,29902.96842187424,30133.63556949328,30601.43815131841,30639.29092093332,31110.61647337655,31381.1017091807,32041.04225628816,32120.00579900354,32447.53843957966,32908.85933055155],[35821.25701313467,37038.57050233211,37085.06553148344,38587.90012895518,42032.15360320403,42672.32555115342,45181.46804413594,46483.51220378347,47159.18654244048,47171.68230704645,47921.80460684486,48221.33743348668,48989.77584587583,49428.5015380853,49533.42618521388,49764.13413179324,50231.89591465805,50269.78948323328,50741.07423671619,51011.55947252034,51671.50001962781,51750.46356234318,52077.9962029193,52539.35789285152]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>gen<\/th>\n      <th>BLUP<\/th>\n      <th>IC_inferior<\/th>\n      <th>IC_superior<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[2,3,4]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"gen","targets":1},{"name":"BLUP","targets":2},{"name":"IC_inferior","targets":3},{"name":"IC_superior","targets":4}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<section id="comparação-entre-blue-x-blup" class="level4" data-number="12.2.1">
<h4 data-number="12.2.1" class="anchored" data-anchor-id="comparação-entre-blue-x-blup"><span class="header-section-number">12.2.1</span> Comparação entre BLUE x BLUP</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Junta as estimativas dos dois modelos pelo identificador gen</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>comparacao <span class="ot">&lt;-</span> <span class="fu">full_join</span>(BLUEs, BLUPs, <span class="at">by =</span> <span class="st">"gen"</span>, <span class="at">suffix =</span> <span class="fu">c</span>(<span class="st">"_BLUE"</span>, <span class="st">"_BLUP"</span>))</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Reestrutura os dados para formato longo</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>comparacao_long <span class="ot">&lt;-</span> comparacao <span class="sc">%&gt;%</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">c</span>(BLUE, BLUP),</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"Tipo"</span>,</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"Estimativa"</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Ordena os genótipos pela média BLUP</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>ordem_gen <span class="ot">&lt;-</span> comparacao <span class="sc">%&gt;%</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(BLUP) <span class="sc">%&gt;%</span></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(gen)</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>comparacao_long<span class="sc">$</span>gen <span class="ot">&lt;-</span> <span class="fu">factor</span>(comparacao_long<span class="sc">$</span>gen, <span class="at">levels =</span> ordem_gen)</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Gera o gráfico comparativo</span></span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(comparacao_long, <span class="fu">aes</span>(<span class="at">x =</span> gen, <span class="at">y =</span> Estimativa, <span class="at">fill =</span> Tipo)) <span class="sc">+</span></span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.8</span>), <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(</span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymin =</span> <span class="fu">ifelse</span>(Tipo <span class="sc">==</span> <span class="st">"BLUE"</span>, IC_inferior_BLUE, IC_inferior_BLUP),</span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymax =</span> <span class="fu">ifelse</span>(Tipo <span class="sc">==</span> <span class="st">"BLUE"</span>, IC_superior_BLUE, IC_superior_BLUP)</span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a>  ), <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.8</span>), <span class="at">width =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Comparação entre BLUEs e BLUPs por Genótipo"</span>,</span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Genótipos"</span>,</span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Estimativas (Produção Ajustada)"</span>,</span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Modelo"</span></span>
<span id="cb29-31"><a href="#cb29-31" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb29-32"><a href="#cb29-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb29-33"><a href="#cb29-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb29-34"><a href="#cb29-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb29-35"><a href="#cb29-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>)</span>
<span id="cb29-36"><a href="#cb29-36" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelagem_experimental_explicacoes_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Neste gráfico, eu comparo as estimativas BLUEs e BLUPs obtidas para cada genótipo, representando a produtividade ajustada segundo as duas modelagens estatísticas.<br>
Os genótipos estão ordenados pela média BLUP, permitindo visualizar a progressão do desempenho genético predito.<br>
As barras vermelhas correspondem às BLUEs, provenientes do modelo com efeito fixo de genótipo, enquanto as barras azuis representam as BLUPs, obtidas do modelo com efeito aleatório de genótipo.</p>
<p>Ao observar o gráfico, percebo que as BLUEs apresentam maior amplitude e maior variação entre genótipos, refletindo diretamente os valores médios observados no experimento portanto, mais sensíveis à variação fenotípica e ao erro experimental.<br>
Já as BLUPs mostram comportamento mais suavizado e estável, pois incorporam a estrutura de variâncias do modelo misto, corrigindo a influência ambiental e priorizando a informação genética predita.</p>
<p>Essa diferença é esperada:</p>
<ul>
<li><p>Os BLUEs são estimativas descritivas, adequadas para comparar os genótipos avaliados dentro do experimento específico;</p></li>
<li><p>Os BLUPs são preditivas, permitindo inferir sobre o valor genético e realizar seleção com base em mérito genético.</p></li>
<li><p>O gráfico evidencia que, embora ambos os métodos estimem o mesmo fenômeno (produtividade ajustada), eles respondem a objetivos distintos:<br>
as BLUEs detalham o comportamento experimental observado, enquanto as BLUPs fornecem uma visão mais robusta e generalizável essencial em contextos de melhoramento genético e seleção de linhagens promissoras.</p></li>
</ul>
</section>
<section id="blups-preditos" class="level4" data-number="12.2.2">
<h4 data-number="12.2.2" class="anchored" data-anchor-id="blups-preditos"><span class="header-section-number">12.2.2</span> BLUPs preditos</h4>
<p>Nesta visualização, eu apresento as estimativas BLUPs (Best Linear Unbiased Predictors) para os genótipos avaliados, já ajustadas pelos efeitos ambientais e de blocos.<br>
Os genótipos estão ordenados do menor para o maior valor predito, permitindo observar claramente o gradiente de desempenho genético na população.</p>
<p>As barras representam a produtividade ajustada (kg/ha), enquanto as linhas verticais indicam os intervalos de confiança (95%), evidenciando a precisão das estimativas individuais.<br>
Genótipos com BLUPs mais altos estão acima da média geral (μ), sendo candidatos preferenciais à seleção, pois apresentam maior mérito genético estimado.<br>
Por outro lado, genótipos com BLUPs mais baixos situam-se abaixo da média, refletindo desempenho inferior após o ajuste dos efeitos ambientais.</p>
<p>Essa abordagem permite distinguir diferenças genéticas reais de variações de ambiente, fornecendo uma base mais sólida para decisões de seleção.<br>
Enquanto análises clássicas (como médias de tratamento) descrevem o desempenho observado, o modelo misto e os BLUPs revelam o potencial genético verdadeiro dos genótipos, tornando-se a principal ferramenta de seleção em programas modernos de melhoramento vegetal.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ordena os genótipos pela estimativa BLUP</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>BLUPs <span class="ot">&lt;-</span> BLUPs <span class="sc">%&gt;%</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(BLUP) <span class="sc">%&gt;%</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gen =</span> <span class="fu">factor</span>(gen, <span class="at">levels =</span> gen))</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Gera o gráfico</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(BLUPs, <span class="fu">aes</span>(<span class="at">x =</span> gen, <span class="at">y =</span> BLUP)) <span class="sc">+</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"#2ca9b7"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> IC_inferior, <span class="at">ymax =</span> IC_superior), <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Estimativas BLUPs por Genótipo"</span>,</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Genótipos"</span>,</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Produtividade Ajustada (kg/ha)"</span></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>)</span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelagem_experimental_explicacoes_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="herdabilidade" class="level2" data-number="13">
<h2 data-number="13" class="anchored" data-anchor-id="herdabilidade"><span class="header-section-number">13</span> Herdabilidade</h2>
<p>Nesta etapa, eu estimei a herdabilidade em sentido amplo (h2h^2h2) com base nas variâncias obtidas do modelo misto com genótipos como efeito aleatório.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>vcomps <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">VarCorr</span>(mod.rg))</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>vc.g <span class="ot">&lt;-</span> vcomps[vcomps<span class="sc">$</span>grp <span class="sc">==</span> <span class="st">"gen"</span>, <span class="st">"vcov"</span>]</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>vc.e <span class="ot">&lt;-</span> vcomps[vcomps<span class="sc">$</span>grp <span class="sc">==</span> <span class="st">"Residual"</span>, <span class="st">"vcov"</span>]</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>nreps <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>hc <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(vc.g <span class="sc">/</span> (vc.g <span class="sc">+</span> vc.e <span class="sc">/</span> nreps))  <span class="co"># &lt;- garante tipo numérico</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"Herdabilidade estimada: {round(hc, 3)}"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Herdabilidade estimada: 0.534</code></pre>
</div>
</div>
<p>Utilizei a decomposição da variância fornecida pela função <code>VarCorr()</code>, extraindo a variância genética (σg2^2_gσg2) associada ao efeito de genótipo e a variância residual (σe2^2_eσe2​).<br>
</p>
<p>A expressão utilizada foi:</p>
<p><span class="math inline">\(h2=σg2​+rσe2​​σg2​​\)</span></p>
<p>onde rrr representa o número de repetições no delineamento (neste caso, r=3r = 3r=3).</p>
<p>O cálculo foi implementado manualmente a partir das variâncias estimadas pelo modelo (<code>vc.g</code> e <code>vc.e</code>), permitindo avaliar quanto da variação total observada na produtividade é de origem genética.<br>
Valores mais próximos de 1 indicam alta herdabilidade, ou seja, a maior parte da variação entre os genótipos é genética e pode ser transmitida às próximas gerações; valores baixos, ao contrário, sugerem forte influência ambiental e menor eficiência da seleção fenotípica.</p>
<p>Essa estimativa é fundamental para o programa de melhoramento, pois determina o potencial de ganho genético esperado e valida a eficiência do delineamento experimental e da modelagem mista aplicada.</p>
</section>
<section id="agrupamento-hierárquico---upgma" class="level2" data-number="14">
<h2 data-number="14" class="anchored" data-anchor-id="agrupamento-hierárquico---upgma"><span class="header-section-number">14</span> Agrupamento hierárquico - UPGMA</h2>
<p>Nesta etapa, eu realizei o agrupamento hierárquico dos genótipos com base nas estimativas BLUPs de produtividade, utilizando o método UPGMA (Unweighted Pair Group Method with Arithmetic Mean) e a distância euclidiana como medida de dissimilaridade.</p>
<p>O objetivo desse procedimento é avaliar o grau de similaridade genética entre os genótipos e identificar possíveis padrões de agrupamento entre materiais com desempenho produtivo semelhante.<br>
Genótipos próximos no dendrograma apresentam valores genéticos preditos semelhantes, enquanto aqueles separados por maiores distâncias euclidianas diferem mais em seu potencial produtivo.</p>
<p>Neste resultado, observo a formação de três grupos principais, o que indica a presença de variabilidade genética útil à seleção dentro da população avaliada.<br>
Essa estrutura de agrupamento pode ser explorada para selecionar genótipos contrastantes, direcionar cruzamentos futuros ou representar a diversidade entre linhagens avançadas.</p>
<p>O método UPGMA, ao utilizar as estimativas BLUPs, garante que o agrupamento seja baseado na performance genética ajustada e não apenas em médias fenotípicas —, o que torna a análise mais robusta e alinhada ao propósito do melhoramento genético quantitativo.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>blup_values <span class="ot">&lt;-</span> BLUPs<span class="sc">$</span>BLUP</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(blup_values) <span class="ot">&lt;-</span> BLUPs<span class="sc">$</span>gen</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>dist_blups <span class="ot">&lt;-</span> <span class="fu">dist</span>(blup_values, <span class="at">method =</span> <span class="st">"euclidean"</span>)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>hc <span class="ot">&lt;-</span> <span class="fu">hclust</span>(dist_blups, <span class="at">method =</span> <span class="st">"average"</span>)</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(hc, <span class="at">main =</span> <span class="st">"Dendrograma UPGMA - BLUPs"</span>,</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Genótipos"</span>, <span class="at">ylab =</span> <span class="st">"Distância Euclidiana"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelagem_experimental_explicacoes_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="correlção-cofenética" class="level3" data-number="14.1">
<h3 data-number="14.1" class="anchored" data-anchor-id="correlção-cofenética"><span class="header-section-number">14.1</span> Correlção cofenética</h3>
<p>Após a geração do dendrograma, <strong>eu avaliei a consistência do agrupamento UPGMA</strong> por meio da <strong>correlação cofenética</strong>, que mede o grau de concordância entre a <strong>matriz original de distâncias genéticas</strong> e a <strong>matriz de distâncias representada pelo dendrograma</strong>.</p>
<p>A correlação cofenética obtida foi de <strong>0,8943</strong>, o que indica <strong>excelente ajuste</strong> entre os dados originais e a representação hierárquica produzida pelo método UPGMA.<br>
Valores próximos de 1 refletem <strong>alta fidelidade</strong> do dendrograma em representar as relações de similaridade entre os genótipos, garantindo <strong>confiabilidade na estrutura de agrupamento</strong> observada.</p>
<p>Esse resultado confirma que o método de agrupamento adotado foi <strong>estatisticamente adequado</strong> para os dados de BLUPs, permitindo interpretar os grupos formados como <strong>indicativos reais de proximidade genética e desempenho produtivo semelhante</strong>.<br>
Assim, a análise de agrupamento, validada pela alta correlação cofenética, <strong>reforça a robustez da modelagem mista e a diversidade genética presente entre os genótipos avaliados</strong>.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Correlação cofenética</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>cophenetic_dist <span class="ot">&lt;-</span> <span class="fu">cophenetic</span>(hc)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>correlation_cophenetic <span class="ot">&lt;-</span> <span class="fu">cor</span>(dist_blups, cophenetic_dist)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Correlação cofenética:"</span>, <span class="fu">round</span>(correlation_cophenetic, <span class="dv">4</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Correlação cofenética: 0.8781"</code></pre>
</div>
</div>
</section>
</section>
<section id="considerações-finais" class="level2" data-number="15">
<h2 data-number="15" class="anchored" data-anchor-id="considerações-finais"><span class="header-section-number">15</span> Considerações finais</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" href="">Pipeline</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false" href="">Modelagem</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false" href="">Recursos recomendados</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>O pipeline desenvolvido neste portfólio consolida um <strong>fluxo completo de análise experimental reprodutível</strong>, desde a <strong>importação automatizada dos dados via API do GitHub</strong> até a <strong>modelagem estatística com delineamento alpha-lattice</strong>, integrando visualizações, estimativas genéticas e validação por agrupamento hierárquico.</p>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p>O projeto demonstrou como o uso de <strong>modelos mistos (REML/BLUP)</strong> amplia a robustez da inferência, separando de forma eficiente os efeitos genéticos e ambientais uma abordagem essencial em experimentos agrícolas com blocos incompletos e grande variabilidade fenotípica. O cálculo da herdabilidade confirmou a <strong>expressiva contribuição genética</strong> para a produtividade, e o agrupamento UPGMA, validado pela <strong>alta correlação cofenética (0,8943)</strong>, evidenciou <strong>consistência estrutural e diversidade genética relevante</strong> na população avaliada.</p>
<p>Mais do que resultados estatísticos, o estudo reforça uma metodologia moderna de pesquisa: <strong>automatizada, reprodutível e integrada</strong>. A função <code>coleta_dados_github()</code> elimina barreiras operacionais, e o uso de pacotes como <code>{lme4}</code>, <code>{emmeans}</code>, <code>{metan}</code> e <code>{tidyverse}</code> cria uma base sólida para análises avançadas e documentação transparente.</p>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<table class="caption-top table">
<thead>
<tr class="header">
<th>Pacote | Recurso</th>
<th>Descrição</th>
<th>Link</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>{httr2}</strong></td>
<td>Pacote moderno para consumo de APIs REST no R. Permite autenticação, controle de headers e tratamento seguro de respostas HTTP.</td>
<td><a href="https://httr2.r-lib.org/articles/wrapping-apis.html">httr2.r-lib.org</a></td>
</tr>
<tr class="even">
<td><strong>GitHub API (REST)</strong></td>
<td>Interface oficial para acessar dados do GitHub (arquivos, repositórios, commits, issues) via requisições autenticadas.</td>
<td><a href="https://docs.github.com/rest/guides/getting-started-with-the-rest-api">docs.github.com/rest</a></td>
</tr>
<tr class="odd">
<td><strong>{gh}</strong></td>
<td>Cliente R oficial para a API do GitHub. Facilita automações e integrações entre R e repositórios GitHub.</td>
<td><a href="https://r-lib.github.io/gh/">r-lib.github.io/gh</a></td>
</tr>
<tr class="even">
<td><strong>{lme4}</strong></td>
<td>Base para ajuste de modelos lineares mistos (efeitos fixos e aleatórios) fundamental para estimar BLUPs.</td>
<td><a href="https://cran.r-project.org/package=lme4">cran.r-project.org/lme4</a></td>
</tr>
<tr class="odd">
<td><strong>{emmeans}</strong></td>
<td>Calcula médias ajustadas (BLUEs), intervalos de confiança e comparações múltiplas.</td>
<td><a href="https://emmeans.r-forge.r-project.org/">emmeans.r-forge.r-project.org</a></td>
</tr>
<tr class="even">
<td><strong>{metan}</strong></td>
<td>Ferramenta completa para análises agronômicas e genéticas (BLUP, MGIDI, herdabilidade, PCA, correlação).</td>
<td><a href="https://cran.r-project.org/package=metan">cran.r-project.org/metan</a></td>
</tr>
<tr class="odd">
<td><strong>{tidyverse}</strong></td>
<td>Coleção de pacotes para manipulação, visualização e comunicação de dados de forma coerente e reprodutível.</td>
<td><a href="https://www.tidyverse.org/">tidyverse.org</a></td>
</tr>
<tr class="even">
<td><strong>Quarto</strong></td>
<td>Sistema de publicação científica integrado ao RStudio, ideal para relatórios dinâmicos, artigos e portfólios.</td>
<td><a href="https://quarto.org/">quarto.org</a></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<!-- -->

</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>Pacote <a href="https://httr2.r-lib.org/"><strong><code>httr2</code></strong></a> utilizado para consumo de APIs, via requisição <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Guides/Overview?utm_source=chatgpt.com"><strong>HTTP</strong></a>.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Acesse a documentação de como consumir a <a href="https://docs.github.com/pt/rest/using-the-rest-api/getting-started-with-the-rest-api?apiVersion=2022-11-28"><strong>API do GitHub</strong></a>.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>A new class of resolvable incomplete block designs - <a href="https://academic.oup.com/biomet/article-abstract/63/1/83/237118?redirectedFrom=fulltext&amp;login=false"><strong>Artigo completo</strong></a>.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>Kenward-Roger: <a href="https://www.jstor.org/stable/2533558?origin=crossref"><strong>Artigo completo</strong></a>.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb36" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Portfólio Experimental – Delineamento Alpha-Lattice"</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="an">subtitle:</span><span class="co"> "Análise de seleção de genótipos superiores"</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Jennifer Luz Lopes"</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-title: "Sumário"</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a><span class="co">    number-sections: true</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a><span class="co">    theme: flatly</span></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a><span class="co">    smooth-scroll: true</span></span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a><span class="co">    css: "estilo.css"</span></span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a><span class="co">    page-layout: full</span></span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span></span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a><span class="co">  echo: true</span></span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a><span class="co">  warning: false</span></span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a><span class="co">  message: false</span></span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a><span class="fu">## Instalação e carregamento dos pacotes</span></span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">"pacman"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) <span class="fu">install.packages</span>(<span class="st">"pacman"</span>)</span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-29"><a href="#cb36-29" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(</span>
<span id="cb36-30"><a href="#cb36-30" aria-hidden="true" tabindex="-1"></a>  broom,          <span class="co"># Organiza resultados de modelos em formato tidy</span></span>
<span id="cb36-31"><a href="#cb36-31" aria-hidden="true" tabindex="-1"></a>  broom.mixed,    <span class="co"># Versão do broom para modelos mistos</span></span>
<span id="cb36-32"><a href="#cb36-32" aria-hidden="true" tabindex="-1"></a>  desplot,        <span class="co"># Visualiza delineamentos experimentais</span></span>
<span id="cb36-33"><a href="#cb36-33" aria-hidden="true" tabindex="-1"></a>  emmeans,        <span class="co"># Médias ajustadas e comparações múltiplas</span></span>
<span id="cb36-34"><a href="#cb36-34" aria-hidden="true" tabindex="-1"></a>  ggpubr,         <span class="co"># Gráficos estatísticos prontos com ggplot2</span></span>
<span id="cb36-35"><a href="#cb36-35" aria-hidden="true" tabindex="-1"></a>  lme4,           <span class="co"># Modelos lineares mistos</span></span>
<span id="cb36-36"><a href="#cb36-36" aria-hidden="true" tabindex="-1"></a>  lmerTest,       <span class="co"># P-valores para modelos lmer()</span></span>
<span id="cb36-37"><a href="#cb36-37" aria-hidden="true" tabindex="-1"></a>  multcomp,       <span class="co"># Testes múltiplos (Tukey, Dunnett)</span></span>
<span id="cb36-38"><a href="#cb36-38" aria-hidden="true" tabindex="-1"></a>  multcompView,   <span class="co"># Letras de agrupamento (a, b, c)</span></span>
<span id="cb36-39"><a href="#cb36-39" aria-hidden="true" tabindex="-1"></a>  plotly,         <span class="co"># Gráficos interativos</span></span>
<span id="cb36-40"><a href="#cb36-40" aria-hidden="true" tabindex="-1"></a>  tidyverse,      <span class="co"># Conjunto para manipulação e visualização de dados</span></span>
<span id="cb36-41"><a href="#cb36-41" aria-hidden="true" tabindex="-1"></a>  writexl,        <span class="co"># Exporta dados para Excel</span></span>
<span id="cb36-42"><a href="#cb36-42" aria-hidden="true" tabindex="-1"></a>  metan,          <span class="co"># Análises agronômicas e genéticas (BLUP, MGIDI)</span></span>
<span id="cb36-43"><a href="#cb36-43" aria-hidden="true" tabindex="-1"></a>  httr2,          <span class="co"># Consumo de APIs modernas</span></span>
<span id="cb36-44"><a href="#cb36-44" aria-hidden="true" tabindex="-1"></a>  readr,          <span class="co"># Leitura rápida de CSV e textos</span></span>
<span id="cb36-45"><a href="#cb36-45" aria-hidden="true" tabindex="-1"></a>  readxl,         <span class="co"># Importação de planilhas Excel</span></span>
<span id="cb36-46"><a href="#cb36-46" aria-hidden="true" tabindex="-1"></a>  base64enc,       <span class="co"># Codificação Base64 (arquivos e APIs)</span></span>
<span id="cb36-47"><a href="#cb36-47" aria-hidden="true" tabindex="-1"></a>  viridis,</span>
<span id="cb36-48"><a href="#cb36-48" aria-hidden="true" tabindex="-1"></a>  DT, </span>
<span id="cb36-49"><a href="#cb36-49" aria-hidden="true" tabindex="-1"></a>  tidyr)</span>
<span id="cb36-50"><a href="#cb36-50" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-51"><a href="#cb36-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-52"><a href="#cb36-52" aria-hidden="true" tabindex="-1"></a><span class="fu">## Como gerar um token de acesso pessoal no GitHub</span></span>
<span id="cb36-53"><a href="#cb36-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-54"><a href="#cb36-54" aria-hidden="true" tabindex="-1"></a>O Personal Access Token (PAT) é uma credencial que substitui sua senha ao usar a API, CLI ou comandos Git via HTTPS. Ele garante autenticação segura e controle sobre o que pode ser acessado.</span>
<span id="cb36-55"><a href="#cb36-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-56"><a href="#cb36-56" aria-hidden="true" tabindex="-1"></a>**Etapas para gerar o token:**</span>
<span id="cb36-57"><a href="#cb36-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-58"><a href="#cb36-58" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Acesse sua conta GitHub. Entre em github.com com seu usuário e senha.</span>
<span id="cb36-59"><a href="#cb36-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-60"><a href="#cb36-60" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Abra as configurações do desenvolvedor. No canto superior direito, clique na sua foto de perfil → Settings → Developer Settings → Personal access tokens.</span>
<span id="cb36-61"><a href="#cb36-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-62"><a href="#cb36-62" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Crie um novo token. Clique em Generate new token (ou Create new token (fine-grained), se disponível).</span>
<span id="cb36-63"><a href="#cb36-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-64"><a href="#cb36-64" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>Defina as informações básicas.</span>
<span id="cb36-65"><a href="#cb36-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-66"><a href="#cb36-66" aria-hidden="true" tabindex="-1"></a><span class="ss">5.  </span>Dê um nome descritivo ao token (ex: token_api_portfolio);</span>
<span id="cb36-67"><a href="#cb36-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-68"><a href="#cb36-68" aria-hidden="true" tabindex="-1"></a><span class="ss">6.  </span>Escolha uma data de expiração adequada (por exemplo, 90 dias);</span>
<span id="cb36-69"><a href="#cb36-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-70"><a href="#cb36-70" aria-hidden="true" tabindex="-1"></a><span class="ss">7.  </span>Selecione apenas os escopos (permissões) necessários — por exemplo, marque repo para acesso a repositórios.</span>
<span id="cb36-71"><a href="#cb36-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-72"><a href="#cb36-72" aria-hidden="true" tabindex="-1"></a><span class="ss">8.  </span>Gere o token. Clique em Generate token para criar. Importante: copie o valor imediatamente ele não será mostrado novamente.</span>
<span id="cb36-73"><a href="#cb36-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-74"><a href="#cb36-74" aria-hidden="true" tabindex="-1"></a><span class="ss">9.  </span>Armazene o token com segurança. Guarde em local seguro, por exemplo, em um gerenciador de senhas ou em variáveis de ambiente como <span class="in">`Sys.setenv(GITHUB_TOKEN="...")`</span>.</span>
<span id="cb36-75"><a href="#cb36-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-76"><a href="#cb36-76" aria-hidden="true" tabindex="-1"></a>**Use o token em suas integrações. Esse token pode ser usado para:**</span>
<span id="cb36-77"><a href="#cb36-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-78"><a href="#cb36-78" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Autenticação em APIs, ex: **`httr2::req_auth_bearer_token()`**;</span>
<span id="cb36-79"><a href="#cb36-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-80"><a href="#cb36-80" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Operações Git via HTTPS (push/pull);</span>
<span id="cb36-81"><a href="#cb36-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-82"><a href="#cb36-82" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Execuções automatizadas em pipelines e scripts.</span>
<span id="cb36-83"><a href="#cb36-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-84"><a href="#cb36-84" aria-hidden="true" tabindex="-1"></a><span class="fu">## Função coleta_dados_github()</span></span>
<span id="cb36-85"><a href="#cb36-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-86"><a href="#cb36-86" aria-hidden="true" tabindex="-1"></a>Criei a função **`coleta_dados_github()`** para automatizar a leitura de arquivos diretamente de um repositório GitHub, sem necessidade de download manual. Ela utiliza o pacote **`httr2`**[^1] para realizar a requisição HTTP à **API do GitHub**<span class="ot">[^2]</span>, montando a URL de acesso a partir do nome do repositório, caminho do arquivo e branch especificados.</span>
<span id="cb36-87"><a href="#cb36-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-88"><a href="#cb36-88" aria-hidden="true" tabindex="-1"></a><span class="ot">[^1]: </span>Pacote <span class="co">[</span><span class="ot">**`httr2`**</span><span class="co">](https://httr2.r-lib.org/)</span> utilizado para consumo de APIs, via requisição <span class="co">[</span><span class="ot">**HTTP**</span><span class="co">](https://developer.mozilla.org/en-US/docs/Web/HTTP/Guides/Overview?utm_source=chatgpt.com)</span>.</span>
<span id="cb36-89"><a href="#cb36-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-90"><a href="#cb36-90" aria-hidden="true" tabindex="-1"></a><span class="ot">[^2]: </span>Acesse a documentação de como consumir a <span class="co">[</span><span class="ot">**API do GitHub**</span><span class="co">](https://docs.github.com/pt/rest/using-the-rest-api/getting-started-with-the-rest-api?apiVersion=2022-11-28)</span>.</span>
<span id="cb36-91"><a href="#cb36-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-92"><a href="#cb36-92" aria-hidden="true" tabindex="-1"></a>::: callout-important</span>
<span id="cb36-93"><a href="#cb36-93" aria-hidden="true" tabindex="-1"></a>Você precisa acessar o GitHub e gerar um **Token de Acesso Pessoal (PAT -Personal Access Token)**.</span>
<span id="cb36-94"><a href="#cb36-94" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb36-95"><a href="#cb36-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-96"><a href="#cb36-96" aria-hidden="true" tabindex="-1"></a>Caso o repositório exija autenticação, o token pessoal do GitHub é aplicado automaticamente via **`req_auth_bearer_token()`**.</span>
<span id="cb36-97"><a href="#cb36-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-98"><a href="#cb36-98" aria-hidden="true" tabindex="-1"></a>Após a conexão, a função valida o status da resposta e decodifica o conteúdo retornado, que vem em formato **`Base64`** padrão usado pela API para transmitir arquivos binários.</span>
<span id="cb36-99"><a href="#cb36-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-100"><a href="#cb36-100" aria-hidden="true" tabindex="-1"></a>O arquivo é temporariamente salvo e, em seguida, lido conforme sua extensão: arquivos .csv são importados com **`readr::read_csv()`** e planilhas .xlsx com **`readxl::read_excel()`**.</span>
<span id="cb36-101"><a href="#cb36-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-102"><a href="#cb36-102" aria-hidden="true" tabindex="-1"></a>Ao final, a função retorna um data frame limpo e pronto para análise, exibindo mensagens informativas sobre o número de linhas e colunas carregadas. Essa estrutura modular permite integração direta entre o GitHub e o pipeline experimental.</span>
<span id="cb36-103"><a href="#cb36-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-106"><a href="#cb36-106" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-107"><a href="#cb36-107" aria-hidden="true" tabindex="-1"></a>coleta_dados_github <span class="ot">&lt;-</span> <span class="cf">function</span>(repo, path, <span class="at">branch =</span> <span class="st">"main"</span>, <span class="at">token =</span> <span class="fu">Sys.getenv</span>(<span class="st">"GITHUB_TOKEN"</span>)) {</span>
<span id="cb36-108"><a href="#cb36-108" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(httr2)</span>
<span id="cb36-109"><a href="#cb36-109" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(readr)</span>
<span id="cb36-110"><a href="#cb36-110" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(readxl)</span>
<span id="cb36-111"><a href="#cb36-111" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(base64enc)</span>
<span id="cb36-112"><a href="#cb36-112" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(glue)</span>
<span id="cb36-113"><a href="#cb36-113" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-114"><a href="#cb36-114" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Mensagem de debug</span></span>
<span id="cb36-115"><a href="#cb36-115" aria-hidden="true" tabindex="-1"></a>  <span class="fu">message</span>(<span class="fu">glue</span>(<span class="st">"Conectando ao repositório {repo}, arquivo: {path}"</span>))</span>
<span id="cb36-116"><a href="#cb36-116" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-117"><a href="#cb36-117" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Monta a URL da API</span></span>
<span id="cb36-118"><a href="#cb36-118" aria-hidden="true" tabindex="-1"></a>  url <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"https://api.github.com/repos/"</span>, repo, <span class="st">"/contents/"</span>, path, <span class="st">"?ref="</span>, branch)</span>
<span id="cb36-119"><a href="#cb36-119" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-120"><a href="#cb36-120" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Requisição</span></span>
<span id="cb36-121"><a href="#cb36-121" aria-hidden="true" tabindex="-1"></a>  req <span class="ot">&lt;-</span> <span class="fu">request</span>(url)</span>
<span id="cb36-122"><a href="#cb36-122" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">nzchar</span>(token)) {</span>
<span id="cb36-123"><a href="#cb36-123" aria-hidden="true" tabindex="-1"></a>    req <span class="ot">&lt;-</span> <span class="fu">req_auth_bearer_token</span>(req, token)</span>
<span id="cb36-124"><a href="#cb36-124" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb36-125"><a href="#cb36-125" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-126"><a href="#cb36-126" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Executa a requisição</span></span>
<span id="cb36-127"><a href="#cb36-127" aria-hidden="true" tabindex="-1"></a>  resp <span class="ot">&lt;-</span> <span class="fu">req_perform</span>(req)</span>
<span id="cb36-128"><a href="#cb36-128" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-129"><a href="#cb36-129" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Se falhar, mostra status</span></span>
<span id="cb36-130"><a href="#cb36-130" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">resp_status</span>(resp) <span class="sc">&gt;=</span> <span class="dv">300</span>) {</span>
<span id="cb36-131"><a href="#cb36-131" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="fu">glue</span>(<span class="st">"Falha ao acessar GitHub: HTTP {resp_status(resp)}. Verifique o token, repo e caminho."</span>))</span>
<span id="cb36-132"><a href="#cb36-132" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb36-133"><a href="#cb36-133" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-134"><a href="#cb36-134" aria-hidden="true" tabindex="-1"></a>  obj <span class="ot">&lt;-</span> <span class="fu">resp_body_json</span>(resp)</span>
<span id="cb36-135"><a href="#cb36-135" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.null</span>(obj<span class="sc">$</span>content)) {</span>
<span id="cb36-136"><a href="#cb36-136" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">"Conteúdo vazio verifique se o caminho aponta para um arquivo, não para uma pasta."</span>)</span>
<span id="cb36-137"><a href="#cb36-137" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb36-138"><a href="#cb36-138" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-139"><a href="#cb36-139" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Decodifica o arquivo em base64</span></span>
<span id="cb36-140"><a href="#cb36-140" aria-hidden="true" tabindex="-1"></a>  raw <span class="ot">&lt;-</span> <span class="fu">base64decode</span>(obj<span class="sc">$</span>content)</span>
<span id="cb36-141"><a href="#cb36-141" aria-hidden="true" tabindex="-1"></a>  ext <span class="ot">&lt;-</span> tools<span class="sc">::</span><span class="fu">file_ext</span>(path)</span>
<span id="cb36-142"><a href="#cb36-142" aria-hidden="true" tabindex="-1"></a>  tmp <span class="ot">&lt;-</span> <span class="fu">tempfile</span>(<span class="at">fileext =</span> <span class="fu">paste0</span>(<span class="st">"."</span>, ext))</span>
<span id="cb36-143"><a href="#cb36-143" aria-hidden="true" tabindex="-1"></a>  <span class="fu">writeBin</span>(raw, tmp)</span>
<span id="cb36-144"><a href="#cb36-144" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-145"><a href="#cb36-145" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Lê conforme o tipo</span></span>
<span id="cb36-146"><a href="#cb36-146" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (ext <span class="sc">==</span> <span class="st">"csv"</span>) {</span>
<span id="cb36-147"><a href="#cb36-147" aria-hidden="true" tabindex="-1"></a>    dados <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(tmp, <span class="at">show_col_types =</span> <span class="cn">FALSE</span>)</span>
<span id="cb36-148"><a href="#cb36-148" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (ext <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"xlsx"</span>, <span class="st">"xls"</span>)) {</span>
<span id="cb36-149"><a href="#cb36-149" aria-hidden="true" tabindex="-1"></a>    dados <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(tmp)</span>
<span id="cb36-150"><a href="#cb36-150" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb36-151"><a href="#cb36-151" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">"Formato não suportado: use .csv, .xlsx ou .xls"</span>)</span>
<span id="cb36-152"><a href="#cb36-152" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb36-153"><a href="#cb36-153" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-154"><a href="#cb36-154" aria-hidden="true" tabindex="-1"></a>  <span class="fu">message</span>(<span class="fu">glue</span>(<span class="st">"Dados carregados com sucesso ({nrow(dados)} linhas, {ncol(dados)} colunas)."</span>))</span>
<span id="cb36-155"><a href="#cb36-155" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(dados)</span>
<span id="cb36-156"><a href="#cb36-156" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb36-157"><a href="#cb36-157" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-158"><a href="#cb36-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-159"><a href="#cb36-159" aria-hidden="true" tabindex="-1"></a><span class="fu">## Importação dos dados via API do GitHub</span></span>
<span id="cb36-160"><a href="#cb36-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-161"><a href="#cb36-161" aria-hidden="true" tabindex="-1"></a>Nesta etapa, foi realizada a importação automatizada dos dados diretamente do GitHub, garantindo reprodutibilidade e versionamento do experimento. A função **`coleta_dados_github()`** foi desenvolvida previamente e armazenada no **diretório funcoes/**, sendo responsável por estabelecer a conexão com o repositório público, localizar o arquivo especificado e fazer o download temporário antes de ler o conteúdo com o pacote **`readxl`**.</span>
<span id="cb36-162"><a href="#cb36-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-163"><a href="#cb36-163" aria-hidden="true" tabindex="-1"></a>Essa abordagem elimina a necessidade de armazenar arquivos localmente e permite atualizar os dados sempre que o repositório for modificado. Em seguida, a função **`glimpse()`** é utilizada para inspecionar rapidamente a estrutura do dataset, verificando nomes, tipos e exemplos das variáveis que serão analisadas nos próximos blocos.</span>
<span id="cb36-164"><a href="#cb36-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-167"><a href="#cb36-167" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-168"><a href="#cb36-168" aria-hidden="true" tabindex="-1"></a><span class="co"># Carrega a função de coleta de dados (salva em funcoes/coleta_dados_github.R)</span></span>
<span id="cb36-169"><a href="#cb36-169" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"meu_projeto/funcoes/coleta_dados_github.R"</span>)</span>
<span id="cb36-170"><a href="#cb36-170" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-171"><a href="#cb36-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-174"><a href="#cb36-174" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-175"><a href="#cb36-175" aria-hidden="true" tabindex="-1"></a><span class="co"># Coleta dos dados direto do repositório público</span></span>
<span id="cb36-176"><a href="#cb36-176" aria-hidden="true" tabindex="-1"></a>dados <span class="ot">&lt;-</span> <span class="fu">coleta_dados_github</span>(</span>
<span id="cb36-177"><a href="#cb36-177" aria-hidden="true" tabindex="-1"></a>  <span class="at">repo =</span> <span class="st">"JenniferLopes/portfolio_experimentacao_agricola"</span>,</span>
<span id="cb36-178"><a href="#cb36-178" aria-hidden="true" tabindex="-1"></a>  <span class="at">path =</span> <span class="st">"meu_projeto/dados/alpha_lattice.xlsx"</span>)</span>
<span id="cb36-179"><a href="#cb36-179" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-180"><a href="#cb36-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-183"><a href="#cb36-183" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-184"><a href="#cb36-184" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualiza estrutura do dataset</span></span>
<span id="cb36-185"><a href="#cb36-185" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(dados)</span>
<span id="cb36-186"><a href="#cb36-186" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-187"><a href="#cb36-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-188"><a href="#cb36-188" aria-hidden="true" tabindex="-1"></a><span class="fu">## **Delineamento Alpha-Lattice**</span></span>
<span id="cb36-189"><a href="#cb36-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-190"><a href="#cb36-190" aria-hidden="true" tabindex="-1"></a>O delineamento **`Alpha-Lattice`**<span class="ot">[^3]</span> é uma variação do látice incompleto balanceado desenvolvido para experimentos com grande número de tratamentos (genótipos) e número limitado de repetições.</span>
<span id="cb36-191"><a href="#cb36-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-192"><a href="#cb36-192" aria-hidden="true" tabindex="-1"></a><span class="ot">[^3]: </span>A new class of resolvable incomplete block designs - <span class="co">[</span><span class="ot">**Artigo completo**</span><span class="co">](https://academic.oup.com/biomet/article-abstract/63/1/83/237118?redirectedFrom=fulltext&amp;login=false)</span>.</span>
<span id="cb36-193"><a href="#cb36-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-194"><a href="#cb36-194" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Ele organiza os tratamentos em blocos incompletos de tamanho fixo, distribuídos aleatoriamente dentro de cada repetição, de forma que cada par de tratamentos ocorra juntos em um número balanceado (ou quase balanceado) de blocos.</span>
<span id="cb36-195"><a href="#cb36-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-196"><a href="#cb36-196" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Essa estrutura reduz a variabilidade dentro dos blocos e aumenta a precisão experimental, especialmente quando há heterogeneidade no campo.</span>
<span id="cb36-197"><a href="#cb36-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-198"><a href="#cb36-198" aria-hidden="true" tabindex="-1"></a>O modelo estatístico para o delineamento Alpha-Lattice inclui efeitos de tratamentos (genótipos), repetições e blocos dentro das repetições, permitindo ajustar as diferenças ambientais por meio de modelos lineares mistos (REML/BLUP).</span>
<span id="cb36-199"><a href="#cb36-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-200"><a href="#cb36-200" aria-hidden="true" tabindex="-1"></a>Por isso, ele é amplamente utilizado em programas de melhoramento genético de plantas, onde se avaliam dezenas ou centenas de linhagens experimentais. Além de aumentar a eficiência da comparação entre genótipos, o delineamento Alpha-Lattice viabiliza o uso de componentes de variância e herdabilidade, fornecendo base sólida para a seleção genotípica mais precisa.</span>
<span id="cb36-201"><a href="#cb36-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-202"><a href="#cb36-202" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sobre os dados experimentais</span></span>
<span id="cb36-203"><a href="#cb36-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-204"><a href="#cb36-204" aria-hidden="true" tabindex="-1"></a>Os dados analisados neste experimento correspondem a um ensaio de avaliação de genótipos conduzido sob delineamento em blocos incompletos do tipo Alpha-Lattice, com o objetivo de estimar parâmetros genéticos e identificar materiais superiores em termos de produtividade.</span>
<span id="cb36-205"><a href="#cb36-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-206"><a href="#cb36-206" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>O conjunto de dados contém informações de:</span>
<span id="cb36-207"><a href="#cb36-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-208"><a href="#cb36-208" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>produção por parcela (prod);</span>
<span id="cb36-209"><a href="#cb36-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-210"><a href="#cb36-210" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>genótipos avaliados (gen);</span>
<span id="cb36-211"><a href="#cb36-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-212"><a href="#cb36-212" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>repetições (rep);</span>
<span id="cb36-213"><a href="#cb36-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-214"><a href="#cb36-214" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>blocos incompletos (inc.bloco);</span>
<span id="cb36-215"><a href="#cb36-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-216"><a href="#cb36-216" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Além das coordenadas de campo utilizadas para a construção do croqui experimental, col (clouna) e row (linha);</span>
<span id="cb36-217"><a href="#cb36-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-218"><a href="#cb36-218" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Cada repetição foi subdividida em blocos menores, chamados de subblocos para reduzir o efeito da variabilidade ambiental e aumentar a precisão das comparações entre genótipos.</span>
<span id="cb36-219"><a href="#cb36-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-220"><a href="#cb36-220" aria-hidden="true" tabindex="-1"></a><span class="fu">## Ajuste das variáveis</span></span>
<span id="cb36-221"><a href="#cb36-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-222"><a href="#cb36-222" aria-hidden="true" tabindex="-1"></a>Neste passo, realizei o ajuste das variáveis categóricas do conjunto de dados para garantir que o modelo estatístico reconheça corretamente os fatores experimentais.</span>
<span id="cb36-223"><a href="#cb36-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-224"><a href="#cb36-224" aria-hidden="true" tabindex="-1"></a>As colunas correspondentes a genótipos (gen), repetições (rep) e blocos incompletos (inc.bloco) são convertidas para o tipo factor, utilizando a função **`mutate()`** do **`dplyr`**.</span>
<span id="cb36-225"><a href="#cb36-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-226"><a href="#cb36-226" aria-hidden="true" tabindex="-1"></a>Essa conversão é essencial em análises de experimentação agrícola, pois esses efeitos representam níveis de tratamento e estruturas hierárquicas que devem ser tratadas como variáveis qualitativas, e não numéricas.</span>
<span id="cb36-227"><a href="#cb36-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-230"><a href="#cb36-230" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-231"><a href="#cb36-231" aria-hidden="true" tabindex="-1"></a>dados <span class="ot">&lt;-</span> dados <span class="sc">%&gt;%</span></span>
<span id="cb36-232"><a href="#cb36-232" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb36-233"><a href="#cb36-233" aria-hidden="true" tabindex="-1"></a>    <span class="at">gen =</span> <span class="fu">as.factor</span>(gen),</span>
<span id="cb36-234"><a href="#cb36-234" aria-hidden="true" tabindex="-1"></a>    <span class="at">rep =</span> <span class="fu">as.factor</span>(rep),</span>
<span id="cb36-235"><a href="#cb36-235" aria-hidden="true" tabindex="-1"></a>    <span class="at">inc.bloco =</span> <span class="fu">as.factor</span>(inc.bloco))</span>
<span id="cb36-236"><a href="#cb36-236" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-237"><a href="#cb36-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-238"><a href="#cb36-238" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sobre o experimento</span></span>
<span id="cb36-239"><a href="#cb36-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-242"><a href="#cb36-242" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-243"><a href="#cb36-243" aria-hidden="true" tabindex="-1"></a>resumo <span class="ot">&lt;-</span> dados <span class="sc">%&gt;%</span></span>
<span id="cb36-244"><a href="#cb36-244" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb36-245"><a href="#cb36-245" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_genotipos   =</span> <span class="fu">n_distinct</span>(gen),</span>
<span id="cb36-246"><a href="#cb36-246" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_repeticoes  =</span> <span class="fu">n_distinct</span>(rep),</span>
<span id="cb36-247"><a href="#cb36-247" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_blocos_inc      =</span> <span class="fu">n_distinct</span>(inc.bloco))</span>
<span id="cb36-248"><a href="#cb36-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-249"><a href="#cb36-249" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(resumo)</span>
<span id="cb36-250"><a href="#cb36-250" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-251"><a href="#cb36-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-252"><a href="#cb36-252" aria-hidden="true" tabindex="-1"></a><span class="fu">## Croqui experimental</span></span>
<span id="cb36-253"><a href="#cb36-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-254"><a href="#cb36-254" aria-hidden="true" tabindex="-1"></a>O croqui do experimento, foi representado graficamente no delineamento alpha-lattice. Para isso, utilizei o pacote **`ggplot2`**, mapeando as coordenadas de campo onde cada célula **`geom_tile()`** representa uma unidade experimental e é identificada pelo respectivo genótipo (label = gen).</span>
<span id="cb36-255"><a href="#cb36-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-256"><a href="#cb36-256" aria-hidden="true" tabindex="-1"></a>A coloração das parcelas foi definida pela variável inc.bloco, permitindo destacar visualmente os blocos incompletos. Em seguida, apliquei **`facet_wrap(~ rep)`** para separar as repetições em painéis distintos, o que facilita a inspeção da uniformidade entre blocos dentro de cada repetição.</span>
<span id="cb36-257"><a href="#cb36-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-260"><a href="#cb36-260" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-261"><a href="#cb36-261" aria-hidden="true" tabindex="-1"></a>dados <span class="ot">&lt;-</span> dados <span class="sc">%&gt;%</span></span>
<span id="cb36-262"><a href="#cb36-262" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">inc.bloco =</span> <span class="fu">as.factor</span>(inc.bloco))</span>
<span id="cb36-263"><a href="#cb36-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-264"><a href="#cb36-264" aria-hidden="true" tabindex="-1"></a>croqui <span class="ot">&lt;-</span> dados <span class="sc">%&gt;%</span></span>
<span id="cb36-265"><a href="#cb36-265" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> col, <span class="at">y =</span> row, <span class="at">fill =</span> inc.bloco)) <span class="sc">+</span></span>
<span id="cb36-266"><a href="#cb36-266" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb36-267"><a href="#cb36-267" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> gen), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb36-268"><a href="#cb36-268" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">"C"</span>, <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb36-269"><a href="#cb36-269" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb36-270"><a href="#cb36-270" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> rep, <span class="at">scales =</span> <span class="st">"free_x"</span>) <span class="sc">+</span></span>
<span id="cb36-271"><a href="#cb36-271" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb36-272"><a href="#cb36-272" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Croqui de Campo - Portfólio Experimental"</span>,</span>
<span id="cb36-273"><a href="#cb36-273" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Colunas"</span>,</span>
<span id="cb36-274"><a href="#cb36-274" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Linhas"</span>,</span>
<span id="cb36-275"><a href="#cb36-275" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Bloco incompleto"</span>, </span>
<span id="cb36-276"><a href="#cb36-276" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"Jennifer Lopes."</span>)</span>
<span id="cb36-277"><a href="#cb36-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-278"><a href="#cb36-278" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(croqui)</span>
<span id="cb36-279"><a href="#cb36-279" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-280"><a href="#cb36-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-281"><a href="#cb36-281" aria-hidden="true" tabindex="-1"></a><span class="fu">## Análise descritiva</span></span>
<span id="cb36-282"><a href="#cb36-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-283"><a href="#cb36-283" aria-hidden="true" tabindex="-1"></a>Foi realizada à análise descritiva da variável produtividade (prod), utilizando a função **`desc_stat()`** do pacote **`metan`**. Essa função permite gerar estatísticas resumo como média, mediana, desvio-padrão, coeficiente de variação e amplitude e, quando **`hist = TRUE`**, apresenta o histograma da distribuição dos dados. O argumento **`stats = "main"`** foi utilizado para focar nos indicadores principais, garantindo uma leitura rápida e objetiva das medidas de tendência central e dispersão.</span>
<span id="cb36-284"><a href="#cb36-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-287"><a href="#cb36-287" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-288"><a href="#cb36-288" aria-hidden="true" tabindex="-1"></a>descritiva <span class="ot">&lt;-</span> dados <span class="sc">%&gt;%</span></span>
<span id="cb36-289"><a href="#cb36-289" aria-hidden="true" tabindex="-1"></a>  metan<span class="sc">::</span><span class="fu">desc_stat</span>(prod, <span class="at">hist =</span> <span class="cn">TRUE</span>, <span class="at">stats =</span> <span class="st">"main"</span>)</span>
<span id="cb36-290"><a href="#cb36-290" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-291"><a href="#cb36-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-292"><a href="#cb36-292" aria-hidden="true" tabindex="-1"></a>O histograma gerado pela função **`desc_stat()`** representa a distribuição dos valores observados de produtividade (prod) entre os genótipos avaliados.</span>
<span id="cb36-293"><a href="#cb36-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-294"><a href="#cb36-294" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Observa-se uma concentração predominante de parcelas com produtividade entre 35.000 e 50.000 kg/ha, indicando que a maior parte dos genótipos apresenta desempenho médio a alto.</span>
<span id="cb36-295"><a href="#cb36-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-296"><a href="#cb36-296" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Há também um pequeno grupo com valores muito baixos, próximos de zero, que provavelmente correspondem a falhas de campo ou perdas experimentais.</span>
<span id="cb36-297"><a href="#cb36-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-298"><a href="#cb36-298" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Essa dispersão assimétrica sugere a presença de heterogeneidade entre genótipos e blocos, reforçando a necessidade do uso de modelos mistos (**`REML/BLUP`**) nas etapas seguintes, para separar o componente genético do ambiental e obter estimativas mais precisas dos efeitos.</span>
<span id="cb36-299"><a href="#cb36-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-302"><a href="#cb36-302" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-303"><a href="#cb36-303" aria-hidden="true" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(descritiva)</span>
<span id="cb36-304"><a href="#cb36-304" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-305"><a href="#cb36-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-306"><a href="#cb36-306" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>A tabela de estatísticas descritivas resume o comportamento da variável de produtividade (prod) no experimento. Ao interpretar os resultados, é possível observar que a média foi de aproximadamente 39.772 kg/ha, enquanto a mediana foi de 43.138 kg/ha, indicando uma leve assimetria negativa ou seja, há algumas parcelas com produtividade mais baixa que puxam a média para baixo.</span>
<span id="cb36-307"><a href="#cb36-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-308"><a href="#cb36-308" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>O valor máximo (58.757 kg/ha) representa o melhor desempenho entre os genótipos avaliados, e o mínimo (3.342 kg/ha) confirma a presença de valores muito baixos observados no histograma, possivelmente relacionados a falhas de campo.</span>
<span id="cb36-309"><a href="#cb36-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-310"><a href="#cb36-310" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>O desvio-padrão (14.605) e o coeficiente de variação (36,7%) refletem alta variabilidade experimental, o que é esperado em populações ainda segregantes.</span>
<span id="cb36-311"><a href="#cb36-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-312"><a href="#cb36-312" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Já o erro padrão da média (1.721) e o intervalo de confiança (±3.432) indicam boa precisão das estimativas, considerando o número de observações válidas (n = 72).</span>
<span id="cb36-313"><a href="#cb36-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-314"><a href="#cb36-314" aria-hidden="true" tabindex="-1"></a><span class="fu">## Modelagem estatística</span></span>
<span id="cb36-315"><a href="#cb36-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-316"><a href="#cb36-316" aria-hidden="true" tabindex="-1"></a>Nesta etapa, ajustei dois modelos lineares mistos para avaliar a produtividade dos genótipos no delineamento alpha-lattice, explorando duas abordagens distintas: efeito fixo e efeito aleatório. Essa comparação é essencial para compreender o comportamento da variável de interesse sob diferentes pressupostos de inferência e para decidir qual estratégia oferece estimativas mais adequadas ao objetivo experimental.</span>
<span id="cb36-317"><a href="#cb36-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-318"><a href="#cb36-318" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Modelo 1 - Genótipo como efeito fixo (BLUEs)</span></span>
<span id="cb36-319"><a href="#cb36-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-320"><a href="#cb36-320" aria-hidden="true" tabindex="-1"></a>Essa abordagem gera as Estimativas Lineares Não Viesadas (BLUEs), que representam as médias ajustadas dos genótipos após o controle dos efeitos de repetição e blocos incompletos. Esse tipo de modelagem é apropriado quando o interesse está em comparar diretamente os genótipos avaliados no experimento, sem extrapolar conclusões para um conjunto maior de materiais genéticos. Utilizei a função <span class="in">`anova()`</span> com o método <span class="in">`Kenward–Roger`</span><span class="ot">[^4]</span> para obter o teste de significância dos efeitos fixos. Além disso, avaliei os resíduos e a sua normalidade, a fim de verificar o atendimento aos pressupostos do modelo.</span>
<span id="cb36-321"><a href="#cb36-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-322"><a href="#cb36-322" aria-hidden="true" tabindex="-1"></a><span class="ot">[^4]: </span>Kenward-Roger: <span class="co">[</span><span class="ot">**Artigo completo**</span><span class="co">](https://www.jstor.org/stable/2533558?origin=crossref)</span>.</span>
<span id="cb36-323"><a href="#cb36-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-326"><a href="#cb36-326" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-327"><a href="#cb36-327" aria-hidden="true" tabindex="-1"></a>mod.fg <span class="ot">&lt;-</span> <span class="fu">lmer</span>(prod <span class="sc">~</span> gen <span class="sc">+</span> rep <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> rep<span class="sc">:</span>inc.bloco), <span class="at">data =</span> dados)</span>
<span id="cb36-328"><a href="#cb36-328" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-329"><a href="#cb36-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-330"><a href="#cb36-330" aria-hidden="true" tabindex="-1"></a>**O modelo matemático foi especificado da seguinte forma:**</span>
<span id="cb36-331"><a href="#cb36-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-332"><a href="#cb36-332" aria-hidden="true" tabindex="-1"></a>$yijk​=μ+gi​+rj​+bk(j)​+εijk$</span>
<span id="cb36-333"><a href="#cb36-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-334"><a href="#cb36-334" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Componentes <span class="pp">|</span> Descrição <span class="pp">|</span></span>
<span id="cb36-335"><a href="#cb36-335" aria-hidden="true" tabindex="-1"></a><span class="pp">|---------------|---------------------------------------------------------|</span></span>
<span id="cb36-336"><a href="#cb36-336" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> $y_{ijk}$ <span class="pp">|</span> Observação do rendimento do genótipo (*i*) na repetição (*j*) e bloco incompleto (*k*) <span class="pp">|</span></span>
<span id="cb36-337"><a href="#cb36-337" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> $u$ <span class="pp">|</span> Média geral do experimento <span class="pp">|</span></span>
<span id="cb36-338"><a href="#cb36-338" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> $g_i$ <span class="pp">|</span> Efeito fixo do **genótipo** $i = 1, 2, \ldots, G$ <span class="pp">|</span></span>
<span id="cb36-339"><a href="#cb36-339" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> $r_j$ <span class="pp">|</span> Efeito fixo da **repetição** $j = 1, 2, \ldots,R$ <span class="pp">|</span></span>
<span id="cb36-340"><a href="#cb36-340" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> $b_{k(j)}$ <span class="pp">|</span> Efeito **aleatório do bloco incompleto** (*k*) dentro da repetição (j), assumindo $b_{k(j)} \sim N(0, \sigma_b^2)$ <span class="pp">|</span></span>
<span id="cb36-341"><a href="#cb36-341" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> $\varepsilon_{ijk}$ <span class="pp">|</span> Erro aleatório, assumindo  $\varepsilon_{ijk} \sim N(0, \sigma_e^2)$ e independentes entre si <span class="pp">|</span></span>
<span id="cb36-342"><a href="#cb36-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-343"><a href="#cb36-343" aria-hidden="true" tabindex="-1"></a>No ajuste do modelo misto, foram consideradas as seguintes especificações:</span>
<span id="cb36-344"><a href="#cb36-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-345"><a href="#cb36-345" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Efeito fixo de genótipo (`gen`)**</span>
<span id="cb36-346"><a href="#cb36-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-347"><a href="#cb36-347" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Representa os tratamentos ou linhagens avaliadas.</span>
<span id="cb36-348"><a href="#cb36-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-349"><a href="#cb36-349" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>O interesse está em estimar e comparar diretamente o desempenho médio de cada genótipo (efeitos fixos - **BLUEs**).</span>
<span id="cb36-350"><a href="#cb36-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-351"><a href="#cb36-351" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Efeito fixo de repetição (`rep`)**</span>
<span id="cb36-352"><a href="#cb36-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-353"><a href="#cb36-353" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Controla as variações sistemáticas entre as repetições (ex.: diferenças de ambiente, fertilidade do solo ou manejo entre blocos experimentais).</span>
<span id="cb36-354"><a href="#cb36-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-355"><a href="#cb36-355" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Efeito aleatório de bloco incompleto dentro da repetição (`rep:inc.bloco`)**</span>
<span id="cb36-356"><a href="#cb36-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-357"><a href="#cb36-357" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Captura a variação aleatória entre blocos dentro de cada repetição.\</span>
<span id="cb36-358"><a href="#cb36-358" aria-hidden="true" tabindex="-1"></a>        Essa estrutura é essencial no delineamento **alpha-lattice**, em que:</span>
<span id="cb36-359"><a href="#cb36-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-360"><a href="#cb36-360" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Os tratamentos são distribuídos em **blocos incompletos**, menores que o número total de genótipos;</span>
<span id="cb36-361"><a href="#cb36-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-362"><a href="#cb36-362" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Cada bloco é um **subconjunto dos tratamentos**, utilizado para reduzir o erro experimental;</span>
<span id="cb36-363"><a href="#cb36-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-364"><a href="#cb36-364" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>O termo aleatório permite **modelar a dependência** entre parcelas do mesmo bloco, aumentando a precisão das estimativas dos efeitos fixos.​</span>
<span id="cb36-365"><a href="#cb36-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-366"><a href="#cb36-366" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Diagnóstico de resíduos</span></span>
<span id="cb36-367"><a href="#cb36-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-368"><a href="#cb36-368" aria-hidden="true" tabindex="-1"></a>O gráfico Resíduos x Ajustados do modelo fixo (BLUE) mostra a dispersão dos resíduos em relação aos valores ajustados pelo modelo.</span>
<span id="cb36-369"><a href="#cb36-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-370"><a href="#cb36-370" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Ao analisar o gráfico, foi possível observar uma distribuição aleatória dos pontos ao redor da linha zero, sem tendência clara, o que indica que o modelo não apresenta viés sistemático na predição da produtividade.</span>
<span id="cb36-371"><a href="#cb36-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-372"><a href="#cb36-372" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>No entanto, é possível verificar também, uma maior variabilidade dos resíduos em níveis intermediários e altos de produtividade, sugerindo heterocedasticidade leve, isto é, variação desigual do erro entre os níveis de resposta.</span>
<span id="cb36-373"><a href="#cb36-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-374"><a href="#cb36-374" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Apesar disso, os resíduos permanecem majoritariamente centrados em torno de zero, o que é desejável em um modelo bem ajustado.</span>
<span id="cb36-375"><a href="#cb36-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-376"><a href="#cb36-376" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Em experimentos agrícolas, pequenas variações são esperadas devido a fatores ambientais e do campo experimental, mas o padrão geral indica que o modelo fixo se ajusta adequadamente aos dados observados.</span>
<span id="cb36-377"><a href="#cb36-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-380"><a href="#cb36-380" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-381"><a href="#cb36-381" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">resid</span>(mod.fg) <span class="sc">~</span> <span class="fu">fitted</span>(mod.fg),</span>
<span id="cb36-382"><a href="#cb36-382" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Resíduos vs Ajustados - Modelo Fixo (BLUE)"</span>)</span>
<span id="cb36-383"><a href="#cb36-383" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-384"><a href="#cb36-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-385"><a href="#cb36-385" aria-hidden="true" tabindex="-1"></a>No gráfico Q-Q Plot do modelo fixo, foi avaliada a normalidade dos resíduos, comparando os quantis observados (eixo y) com os quantis teóricos da distribuição normal (eixo x).</span>
<span id="cb36-386"><a href="#cb36-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-387"><a href="#cb36-387" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Visualmente, observei que a maioria dos pontos segue próxima da linha diagonal, indicando que os resíduos apresentam comportamento aproximadamente normal.</span>
<span id="cb36-388"><a href="#cb36-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-389"><a href="#cb36-389" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Apenas pequenas deformações nas extremidades (caudas) sugerem uma leve assimetria, o que é comum em dados de produtividade agrícola, especialmente em populações ainda segregantes.</span>
<span id="cb36-390"><a href="#cb36-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-391"><a href="#cb36-391" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Essa análise é importante porque a suposição de normalidade dos erros garante a validade dos testes F e das estimativas de variância no modelo.</span>
<span id="cb36-392"><a href="#cb36-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-393"><a href="#cb36-393" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Apesar das pequenas discrepâncias nas caudas, o ajuste é considerado adequado para fins de inferência, não comprometendo a interpretação dos efeitos fixos e a obtenção das médias ajustadas (BLUEs).</span>
<span id="cb36-394"><a href="#cb36-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-397"><a href="#cb36-397" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-398"><a href="#cb36-398" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(mod.fg)); <span class="fu">qqline</span>(<span class="fu">resid</span>(mod.fg))</span>
<span id="cb36-399"><a href="#cb36-399" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-400"><a href="#cb36-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-401"><a href="#cb36-401" aria-hidden="true" tabindex="-1"></a><span class="fu">#### ANOVA para efeitos fixos</span></span>
<span id="cb36-402"><a href="#cb36-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-403"><a href="#cb36-403" aria-hidden="true" tabindex="-1"></a>Em seguida, foi realizada à análise de variância (ANOVA) para o modelo com genótipos tratados como efeitos fixos, utilizando o método Kenward-Roger para o cálculo dos graus de liberdade (ddf = "Kenward-Roger").</span>
<span id="cb36-404"><a href="#cb36-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-405"><a href="#cb36-405" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Essa abordagem é mais apropriada em experimentos com número limitado de repetições e estruturas desbalanceadas, pois ajusta a variância dos erros e fornece testes F mais precisos.</span>
<span id="cb36-406"><a href="#cb36-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-407"><a href="#cb36-407" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>O objetivo aqui foi avaliar a significância dos efeitos de genótipo, repetição e blocos incompletos sobre a produtividade.</span>
<span id="cb36-408"><a href="#cb36-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-409"><a href="#cb36-409" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Quando o efeito de genótipo é significativo, isso indica que existe variabilidade real entre os materiais avaliados, justificando o prosseguimento da análise com comparações múltiplas e estimativas médias ajustadas (BLUEs).</span>
<span id="cb36-410"><a href="#cb36-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-411"><a href="#cb36-411" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Além disso, essa etapa permite confirmar se a estrutura do delineamento (blocos incompletos dentro de repetições) foi eficiente em controlar a heterogeneidade experimental, garantindo que as diferenças observadas entre genótipos sejam atribuídas majoritariamente a causas genéticas e não ao ruído ambiental.</span>
<span id="cb36-412"><a href="#cb36-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-415"><a href="#cb36-415" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-416"><a href="#cb36-416" aria-hidden="true" tabindex="-1"></a>anova_fg <span class="ot">&lt;-</span> <span class="fu">anova</span>(mod.fg, <span class="at">ddf =</span> <span class="st">"Kenward-Roger"</span>)</span>
<span id="cb36-417"><a href="#cb36-417" aria-hidden="true" tabindex="-1"></a>anova_fg</span>
<span id="cb36-418"><a href="#cb36-418" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-419"><a href="#cb36-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-420"><a href="#cb36-420" aria-hidden="true" tabindex="-1"></a>A tabela da ANOVA com o método de Kenward-Roger apresenta os testes de significância para os efeitos fixos incluídos no modelo.</span>
<span id="cb36-421"><a href="#cb36-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-422"><a href="#cb36-422" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Ao interpretar os resultados, foi possível observar que o efeito de genótipo foi significativo (F=1,93; p=0,03598), indicando que existe variabilidade estatisticamente detectável entre os genótipos avaliados quanto à produtividade.</span>
<span id="cb36-423"><a href="#cb36-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-424"><a href="#cb36-424" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Esse resultado confirma que as diferenças observadas não se devem apenas ao acaso, mas refletem diferenças genéticas reais entre os materiais testados.</span>
<span id="cb36-425"><a href="#cb36-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-426"><a href="#cb36-426" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Por outro lado, o efeito de repetição (F=0,02; p=0,88) não foi significativo, o que sugere que as condições experimentais entre as repetições foram homogêneas, sem variações no ambiente.</span>
<span id="cb36-427"><a href="#cb36-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-428"><a href="#cb36-428" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; A significância do fator genótipo valida o uso do modelo misto na sequência da análise, permitindo estimar as médias ajustadas (BLUEs) e, posteriormente, comparar o desempenho dos materiais.</span></span>
<span id="cb36-429"><a href="#cb36-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-430"><a href="#cb36-430" aria-hidden="true" tabindex="-1"></a>::: callout-important</span>
<span id="cb36-431"><a href="#cb36-431" aria-hidden="true" tabindex="-1"></a>A ANOVA Tipo III foi utilizada porque o modelo ajustado não é completamente ortogonal ou seja, os efeitos dos fatores (genótipos, repetições e blocos) não são totalmente independentes. Nesse tipo de modelo, cada termo deve ser avaliado ajustando-se para os demais fatores presentes.</span>
<span id="cb36-432"><a href="#cb36-432" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb36-433"><a href="#cb36-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-434"><a href="#cb36-434" aria-hidden="true" tabindex="-1"></a><span class="fu">### Modelo 2: Genótipo como efeito aleatório - BLUPs</span></span>
<span id="cb36-435"><a href="#cb36-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-436"><a href="#cb36-436" aria-hidden="true" tabindex="-1"></a>Neste segundo modelo, considerei o genótipo como efeito aleatório, o que transforma a natureza da inferência do modelo.</span>
<span id="cb36-437"><a href="#cb36-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-438"><a href="#cb36-438" aria-hidden="true" tabindex="-1"></a>Essa modelagem tem como objetivo predizer o valor genético dos genótipos ou seja, estimar seus BLUPs (Best Linear Unbiased Predictors).\</span>
<span id="cb36-439"><a href="#cb36-439" aria-hidden="true" tabindex="-1"></a>Enquanto o modelo fixo fornece médias ajustadas (BLUEs) apenas para os genótipos testados, este modelo permite inferir sobre uma população maior, tratando os genótipos como uma amostra aleatória dentro do programa de melhoramento.</span>
<span id="cb36-440"><a href="#cb36-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-441"><a href="#cb36-441" aria-hidden="true" tabindex="-1"></a>Essa abordagem é mais realista e robusta no contexto do melhoramento genético vegetal, pois considera a variabilidade genética como um componente da variância total e reduz o impacto de observações extremas.\</span>
<span id="cb36-442"><a href="#cb36-442" aria-hidden="true" tabindex="-1"></a>Além disso, ao estimar simultaneamente as variâncias genética (σg2\sigma<span class="sc">\_</span>g\^2σg2​), de bloco (σb2\sigma<span class="sc">\_</span>b\^2σb2​) e residual (σ2\sigma\^2σ2), o modelo fornece base para calcular parâmetros genéticos, como herdabilidade e acurácia seletiva fundamentais para a etapa de seleção de linhagens promissoras.</span>
<span id="cb36-443"><a href="#cb36-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-446"><a href="#cb36-446" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-447"><a href="#cb36-447" aria-hidden="true" tabindex="-1"></a>mod.rg <span class="ot">&lt;-</span> <span class="fu">lmer</span>(prod <span class="sc">~</span> rep <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> gen) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> rep<span class="sc">:</span>inc.bloco), <span class="at">data =</span> dados)</span>
<span id="cb36-448"><a href="#cb36-448" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-449"><a href="#cb36-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-450"><a href="#cb36-450" aria-hidden="true" tabindex="-1"></a>**O modelo matemático foi especificado da seguinte forma:**</span>
<span id="cb36-451"><a href="#cb36-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-452"><a href="#cb36-452" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Diagnóstico de resíduos</span></span>
<span id="cb36-453"><a href="#cb36-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-454"><a href="#cb36-454" aria-hidden="true" tabindex="-1"></a>Ao analisar o gráfico Resíduos vs Ajustados do modelo aleatório (BLUP), eu verifico o comportamento dos erros em relação aos valores preditos.\</span>
<span id="cb36-455"><a href="#cb36-455" aria-hidden="true" tabindex="-1"></a>Os pontos se distribuem de forma predominantemente aleatória ao redor da linha zero, sem formação de padrões evidentes, o que indica que o modelo apresenta homocedasticidade, ou seja, variância constante dos resíduos ao longo da faixa de produtividades ajustadas.</span>
<span id="cb36-456"><a href="#cb36-456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-457"><a href="#cb36-457" aria-hidden="true" tabindex="-1"></a>Percebo, entretanto, alguns pontos mais dispersos na extremidade inferior referentes a parcelas com produtividade muito baixa o que é comum em ensaios de campo, onde variações ambientais e falhas experimentais podem gerar resíduos extremos.\</span>
<span id="cb36-458"><a href="#cb36-458" aria-hidden="true" tabindex="-1"></a>Mesmo assim, a tendência geral mostra que o modelo aleatório ajustou bem a estrutura dos dados, capturando os efeitos genéticos e de bloco de forma eficiente.</span>
<span id="cb36-459"><a href="#cb36-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-460"><a href="#cb36-460" aria-hidden="true" tabindex="-1"></a>Esse tipo de diagnóstico é essencial para confirmar que as suposições do modelo misto foram atendidas e que as estimativas dos BLUPs são estatisticamente confiáveis. A ausência de padrões sistemáticos reforça a qualidade do ajuste e a adequação da estrutura de variâncias adotada no modelo.</span>
<span id="cb36-461"><a href="#cb36-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-464"><a href="#cb36-464" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-465"><a href="#cb36-465" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">resid</span>(mod.rg) <span class="sc">~</span> <span class="fu">fitted</span>(mod.rg), <span class="at">main =</span> <span class="st">"Resíduos vs Ajustados - Modelo Aleatório (BLUP)"</span>)</span>
<span id="cb36-466"><a href="#cb36-466" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-467"><a href="#cb36-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-468"><a href="#cb36-468" aria-hidden="true" tabindex="-1"></a>No gráfico Q-Q Plot do modelo aleatório (BLUP), eu avalio se os resíduos seguem a distribuição normal teórica, um dos pressupostos fundamentais do modelo misto.\</span>
<span id="cb36-469"><a href="#cb36-469" aria-hidden="true" tabindex="-1"></a>A maioria dos pontos se alinha bem à linha diagonal, o que indica que a distribuição dos resíduos é aproximadamente normal. Apenas pequenas deformações nas extremidades (caudas) podem ser observadas, refletindo a presença de alguns valores atípicos comportamento comum em experimentos agrícolas devido à variabilidade natural entre parcelas.</span>
<span id="cb36-470"><a href="#cb36-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-471"><a href="#cb36-471" aria-hidden="true" tabindex="-1"></a>Essa proximidade entre os quantis observados e teóricos confirma que o ajuste do modelo é adequado e que as inferências obtidas (como os componentes de variância e os BLUPs) são estatisticamente válidas.\</span>
<span id="cb36-472"><a href="#cb36-472" aria-hidden="true" tabindex="-1"></a>Em síntese, o modelo aleatório apresentou boa aderência à normalidade e homogeneidade de variâncias, reforçando sua consistência para estimar parâmetros genéticos e predizer o desempenho dos genótipos.</span>
<span id="cb36-473"><a href="#cb36-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-476"><a href="#cb36-476" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-477"><a href="#cb36-477" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(mod.rg)); <span class="fu">qqline</span>(<span class="fu">resid</span>(mod.rg))</span>
<span id="cb36-478"><a href="#cb36-478" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-479"><a href="#cb36-479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-480"><a href="#cb36-480" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Teste de significância dos componentes de variância</span></span>
<span id="cb36-481"><a href="#cb36-481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-482"><a href="#cb36-482" aria-hidden="true" tabindex="-1"></a>Nesta etapa, eu realizei o teste de significância dos componentes de variância por meio da função <span class="in">`ranova()`</span>, que avalia se os efeitos aleatórios incluídos no modelo contribuem de forma significativa para explicar a variabilidade observada na produtividade.\</span>
<span id="cb36-483"><a href="#cb36-483" aria-hidden="true" tabindex="-1"></a>O procedimento compara o modelo completo com versões reduzidas (sem cada efeito aleatório), utilizando testes de razão de verossimilhança (Likelihood Ratio Test).</span>
<span id="cb36-484"><a href="#cb36-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-485"><a href="#cb36-485" aria-hidden="true" tabindex="-1"></a>Quando o resultado indica que o componente de variância associado ao genótipo é significativo, isso confirma que existe variabilidade genética expressiva na população avaliada, o que justifica a aplicação do modelo misto e a obtenção dos BLUPs para seleção dos melhores materiais.\</span>
<span id="cb36-486"><a href="#cb36-486" aria-hidden="true" tabindex="-1"></a>Da mesma forma, a significância do componente de bloco dentro de repetição indica que o delineamento alpha-lattice foi eficiente em captar variações ambientais locais, contribuindo para a redução do erro residual e o aumento da precisão experimental.</span>
<span id="cb36-487"><a href="#cb36-487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-488"><a href="#cb36-488" aria-hidden="true" tabindex="-1"></a>A <span class="in">`ranova()`</span> permite validar estatisticamente a estrutura hierárquica do modelo e assegurar que cada efeito aleatório considerado genótipos, blocos e erro desempenha papel relevante na explicação da variância total, garantindo um modelo parcimonioso e biologicamente coerente com o delineamento do experimento.</span>
<span id="cb36-489"><a href="#cb36-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-492"><a href="#cb36-492" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-493"><a href="#cb36-493" aria-hidden="true" tabindex="-1"></a>ranova_rg <span class="ot">&lt;-</span> <span class="fu">ranova</span>(mod.rg)</span>
<span id="cb36-494"><a href="#cb36-494" aria-hidden="true" tabindex="-1"></a>ranova_rg</span>
<span id="cb36-495"><a href="#cb36-495" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-496"><a href="#cb36-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-497"><a href="#cb36-497" aria-hidden="true" tabindex="-1"></a>A tabela do teste de significância dos componentes de variância mostra os resultados da remoção individual dos efeitos aleatórios do modelo genótipo e bloco dentro de repetição avaliados pelo teste de razão de verossimilhança (LRT).</span>
<span id="cb36-498"><a href="#cb36-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-499"><a href="#cb36-499" aria-hidden="true" tabindex="-1"></a>Ao interpretar os valores, eu observo que ambos os componentes apresentam significância marginal:</span>
<span id="cb36-500"><a href="#cb36-500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-501"><a href="#cb36-501" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>O efeito de genótipo apresentou p=0,064p = 0{,}064p=0,064, próximo ao limite de 0,05,</span>
<span id="cb36-502"><a href="#cb36-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-503"><a href="#cb36-503" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>e o efeito de bloco dentro de repetição apresentou p=0,088p = 0{,}088p=0,088.</span>
<span id="cb36-504"><a href="#cb36-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-505"><a href="#cb36-505" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Esses resultados indicam que ambos os efeitos contribuem de forma relevante para explicar a variabilidade da produtividade, ainda que a significância estatística não seja plena.\</span>
<span id="cb36-506"><a href="#cb36-506" aria-hidden="true" tabindex="-1"></a>    Na prática, isso sugere que existe variabilidade genética entre os genótipos, e que o delineamento alpha-lattice foi eficiente em reduzir a heterogeneidade ambiental, justificando a manutenção desses efeitos no modelo.</span>
<span id="cb36-507"><a href="#cb36-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-508"><a href="#cb36-508" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>O logLik (-772.42) e o AIC (1554.8) confirmam que o modelo completo apresenta melhor ajuste global em relação às versões reduzidas, reforçando a adequação da estrutura aleatória escolhida.</span>
<span id="cb36-509"><a href="#cb36-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-510"><a href="#cb36-510" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Esses resultados validam o uso do modelo misto com genótipos e blocos como efeitos aleatórios, pois ele representa de forma coerente a estrutura genética e experimental dos dados.</span>
<span id="cb36-511"><a href="#cb36-511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-512"><a href="#cb36-512" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Comparação entre modelos (AIC e LogLik)</span></span>
<span id="cb36-513"><a href="#cb36-513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-514"><a href="#cb36-514" aria-hidden="true" tabindex="-1"></a>Por fim, eu comparei o desempenho dos dois modelos o de efeito fixo (BLUE) e o de efeito aleatório (BLUP) utilizando os critérios AIC (Akaike Information Criterion) e logLik (logaritmo da verossimilhança).\</span>
<span id="cb36-515"><a href="#cb36-515" aria-hidden="true" tabindex="-1"></a>Esses indicadores permitem avaliar a qualidade de ajuste e a parcimônia dos modelos, isto é, o equilíbrio entre complexidade e capacidade explicativa.</span>
<span id="cb36-516"><a href="#cb36-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-517"><a href="#cb36-517" aria-hidden="true" tabindex="-1"></a>O AIC é uma medida em que valores menores indicam melhor ajuste, enquanto o logLik reflete a verossimilhança do modelo quanto maior, melhor a adequação aos dados observados.\</span>
<span id="cb36-518"><a href="#cb36-518" aria-hidden="true" tabindex="-1"></a>Ao comparar os resultados, eu observo que o modelo aleatório (BLUP) apresenta menor AIC e maior logLik em relação ao modelo fixo, o que indica melhor desempenho estatístico e maior capacidade preditiva.</span>
<span id="cb36-519"><a href="#cb36-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-520"><a href="#cb36-520" aria-hidden="true" tabindex="-1"></a>Essa diferença reforça que tratar o genótipo como efeito aleatório é mais apropriado neste contexto, pois o interesse está na predição do valor genético e na seleção de indivíduos, e não apenas na comparação pontual dos materiais testados.\</span>
<span id="cb36-521"><a href="#cb36-521" aria-hidden="true" tabindex="-1"></a>Além disso, o modelo BLUP permite estimar componentes de variância genética e ambiental, fundamentais para o cálculo de parâmetros genéticos e para orientar as próximas etapas do programa de melhoramento.</span>
<span id="cb36-522"><a href="#cb36-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-523"><a href="#cb36-523" aria-hidden="true" tabindex="-1"></a>Em síntese, a comparação dos critérios de ajuste confirma que o modelo misto com genótipo aleatório (BLUP) é estatisticamente mais eficiente e biologicamente mais coerente para representar o comportamento dos genótipos avaliados neste experimento.</span>
<span id="cb36-524"><a href="#cb36-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-527"><a href="#cb36-527" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-528"><a href="#cb36-528" aria-hidden="true" tabindex="-1"></a>aic_comp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb36-529"><a href="#cb36-529" aria-hidden="true" tabindex="-1"></a>  <span class="at">Modelo =</span> <span class="fu">c</span>(<span class="st">"Efeito Fixo (BLUE)"</span>, <span class="st">"Efeito Aleatório (BLUP)"</span>),</span>
<span id="cb36-530"><a href="#cb36-530" aria-hidden="true" tabindex="-1"></a>  <span class="at">AIC =</span> <span class="fu">c</span>(<span class="fu">AIC</span>(mod.fg), <span class="fu">AIC</span>(mod.rg)),</span>
<span id="cb36-531"><a href="#cb36-531" aria-hidden="true" tabindex="-1"></a>  <span class="at">logLik =</span> <span class="fu">c</span>(<span class="fu">logLik</span>(mod.fg), <span class="fu">logLik</span>(mod.rg))</span>
<span id="cb36-532"><a href="#cb36-532" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb36-533"><a href="#cb36-533" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(aic_comp)</span>
<span id="cb36-534"><a href="#cb36-534" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-535"><a href="#cb36-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-536"><a href="#cb36-536" aria-hidden="true" tabindex="-1"></a>Ao comparar os critérios de ajuste, eu observei uma diferença considerável entre os modelos de efeito fixo (BLUE) e aleatório (BLUP).\</span>
<span id="cb36-537"><a href="#cb36-537" aria-hidden="true" tabindex="-1"></a>O modelo BLUE apresentou AIC = 1106,28 e logLik = -526,14, enquanto o modelo BLUP apresentou AIC = 1554,83 e logLik = -772,42.</span>
<span id="cb36-538"><a href="#cb36-538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-539"><a href="#cb36-539" aria-hidden="true" tabindex="-1"></a>Como o AIC é uma medida de qualidade de ajuste penalizada pela complexidade do modelo, valores menores indicam melhor desempenho estatístico.\</span>
<span id="cb36-540"><a href="#cb36-540" aria-hidden="true" tabindex="-1"></a>Nesse caso, o modelo com efeito fixo (BLUE) apresentou menor AIC e maior logLik, demonstrando melhor ajuste aos dados observados sob a ótica puramente estatística.</span>
<span id="cb36-541"><a href="#cb36-541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-542"><a href="#cb36-542" aria-hidden="true" tabindex="-1"></a>No entanto, a escolha do modelo não depende apenas do critério numérico.\</span>
<span id="cb36-543"><a href="#cb36-543" aria-hidden="true" tabindex="-1"></a>O modelo BLUP, apesar do AIC mais alto, é conceitualmente mais adequado para estudos de melhoramento genético, pois considera o genótipo como efeito aleatório, permitindo estimar componentes de variância e realizar predição de valores genéticos (BLUPs).\</span>
<span id="cb36-544"><a href="#cb36-544" aria-hidden="true" tabindex="-1"></a>Dessa forma, o modelo fixo é mais descritivo, adequado para comparação direta entre genótipos avaliados, enquanto o modelo aleatório é mais preditivo, ideal para inferir sobre o desempenho genético e orientar a seleção de linhagens superiores.</span>
<span id="cb36-545"><a href="#cb36-545" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-546"><a href="#cb36-546" aria-hidden="true" tabindex="-1"></a>Em síntese, o modelo BLUE apresentou melhor ajuste estatístico, mas o modelo BLUP oferece maior utilidade biológica e interpretativa dentro do contexto de programas de melhoramento vegetal, onde o interesse é a predição e seleção.</span>
<span id="cb36-547"><a href="#cb36-547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-548"><a href="#cb36-548" aria-hidden="true" tabindex="-1"></a><span class="fu">## Estimativas dos BLUEs E BLUPs</span></span>
<span id="cb36-549"><a href="#cb36-549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-550"><a href="#cb36-550" aria-hidden="true" tabindex="-1"></a><span class="fu">### Estimativas dos BLUEs - Efeito fixo</span></span>
<span id="cb36-551"><a href="#cb36-551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-552"><a href="#cb36-552" aria-hidden="true" tabindex="-1"></a>Nesta etapa, **eu obtive as estimativas BLUEs (Best Linear Unbiased Estimates)**, correspondentes às médias ajustadas dos genótipos considerando o modelo com **efeitos fixos**.\</span>
<span id="cb36-553"><a href="#cb36-553" aria-hidden="true" tabindex="-1"></a>Utilizei a função <span class="in">`emmeans()`</span> do pacote **`emmeans`**, que calcula as médias marginais ajustadas após o controle dos efeitos de repetição e blocos incompletos.</span>
<span id="cb36-554"><a href="#cb36-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-555"><a href="#cb36-555" aria-hidden="true" tabindex="-1"></a>Em seguida, converti o resultado para *data frame* e selecionei as colunas principais:</span>
<span id="cb36-556"><a href="#cb36-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-557"><a href="#cb36-557" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`gen`</span>: identificação dos genótipos,</span>
<span id="cb36-558"><a href="#cb36-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-559"><a href="#cb36-559" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`BLUE`</span>: média ajustada estimada,</span>
<span id="cb36-560"><a href="#cb36-560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-561"><a href="#cb36-561" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`IC_inferior`</span> e <span class="in">`IC_superior`</span>: limites inferior e superior do **intervalo de confiança (95%)** para cada genótipo.</span>
<span id="cb36-562"><a href="#cb36-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-563"><a href="#cb36-563" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Essas estimativas representam o **desempenho fenotípico médio dos genótipos**, já corrigido pelas variações ambientais controladas no modelo.\</span>
<span id="cb36-564"><a href="#cb36-564" aria-hidden="true" tabindex="-1"></a>    O uso das **BLUEs** é apropriado quando o objetivo é **comparar diretamente os materiais testados** no experimento, fornecendo uma base para a **classificação e agrupamento dos genótipos** com base nas médias ajustadas de produtividade.</span>
<span id="cb36-565"><a href="#cb36-565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-568"><a href="#cb36-568" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-569"><a href="#cb36-569" aria-hidden="true" tabindex="-1"></a>BLUEs <span class="ot">&lt;-</span> emmeans<span class="sc">::</span><span class="fu">emmeans</span>(mod.fg, <span class="sc">~</span> gen) <span class="sc">%&gt;%</span></span>
<span id="cb36-570"><a href="#cb36-570" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb36-571"><a href="#cb36-571" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(gen, <span class="at">BLUE =</span> emmean, <span class="at">IC_inferior =</span> lower.CL, <span class="at">IC_superior =</span> upper.CL)</span>
<span id="cb36-572"><a href="#cb36-572" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-573"><a href="#cb36-573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-576"><a href="#cb36-576" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-577"><a href="#cb36-577" aria-hidden="true" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(BLUEs)</span>
<span id="cb36-578"><a href="#cb36-578" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-579"><a href="#cb36-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-580"><a href="#cb36-580" aria-hidden="true" tabindex="-1"></a><span class="fu">### Estimativas dos BLUPs - Efeito aleatório</span></span>
<span id="cb36-581"><a href="#cb36-581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-582"><a href="#cb36-582" aria-hidden="true" tabindex="-1"></a>Nesta etapa, **eu estimei os BLUPs (Best Linear Unbiased Predictors)** a partir do modelo com **genótipo como efeito aleatório**.\</span>
<span id="cb36-583"><a href="#cb36-583" aria-hidden="true" tabindex="-1"></a>Primeiro, extraí a **média geral (**μ\muμ) do modelo por meio da função <span class="in">`fixef(mod.rg)[1]`</span>, que representa o intercepto fixo ou seja, o valor médio da produtividade considerando todos os efeitos ajustados.</span>
<span id="cb36-584"><a href="#cb36-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-585"><a href="#cb36-585" aria-hidden="true" tabindex="-1"></a>Em seguida, utilizei a função <span class="in">`ranef()`</span> para obter os **efeitos aleatórios individuais de cada genótipo**, correspondentes aos desvios em relação à média geral, e combinei essas estimativas com o valor de μ\muμ para calcular o **BLUP de cada genótipo**:</span>
<span id="cb36-586"><a href="#cb36-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-587"><a href="#cb36-587" aria-hidden="true" tabindex="-1"></a>BLUPj=μ+g\^j\text{BLUP}<span class="sc">\_</span>j = \mu + \hat{g}<span class="sc">\_</span>jBLUPj​=μ+g\^​j​</span>
<span id="cb36-588"><a href="#cb36-588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-589"><a href="#cb36-589" aria-hidden="true" tabindex="-1"></a>onde g\^j\hat{g}<span class="sc">\_</span>jg\^​j​ é o valor predito para o efeito aleatório do genótipo jjj.</span>
<span id="cb36-590"><a href="#cb36-590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-591"><a href="#cb36-591" aria-hidden="true" tabindex="-1"></a>Para cada genótipo, também calculei os **intervalos de confiança (95%)**, utilizando o erro-padrão associado à predição.\</span>
<span id="cb36-592"><a href="#cb36-592" aria-hidden="true" tabindex="-1"></a>As colunas finais incluem:</span>
<span id="cb36-593"><a href="#cb36-593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-594"><a href="#cb36-594" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`gen`</span>: identificação do genótipo,</span>
<span id="cb36-595"><a href="#cb36-595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-596"><a href="#cb36-596" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`BLUP`</span>: valor genético predito,</span>
<span id="cb36-597"><a href="#cb36-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-598"><a href="#cb36-598" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`IC_inferior`</span> e <span class="in">`IC_superior`</span>: limites inferior e superior de confiança.</span>
<span id="cb36-599"><a href="#cb36-599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-600"><a href="#cb36-600" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Essas estimativas representam o **desempenho genético ajustado** dos materiais avaliados, já descontando a influência ambiental e de blocos.\</span>
<span id="cb36-601"><a href="#cb36-601" aria-hidden="true" tabindex="-1"></a>    Diferente das BLUEs, os BLUPs permitem **predizer o valor genético de genótipos não avaliados diretamente** e **suportam decisões de seleção**, sendo, portanto, mais adequados ao contexto de **melhoramento genético de plantas**.</span>
<span id="cb36-602"><a href="#cb36-602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-605"><a href="#cb36-605" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-606"><a href="#cb36-606" aria-hidden="true" tabindex="-1"></a>mu_manual <span class="ot">&lt;-</span> <span class="fu">fixef</span>(mod.rg)[<span class="dv">1</span>]</span>
<span id="cb36-607"><a href="#cb36-607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-608"><a href="#cb36-608" aria-hidden="true" tabindex="-1"></a>BLUPs <span class="ot">&lt;-</span> <span class="fu">augment</span>(<span class="fu">ranef</span>(mod.rg)) <span class="sc">%&gt;%</span></span>
<span id="cb36-609"><a href="#cb36-609" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(grp <span class="sc">==</span> <span class="st">"gen"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-610"><a href="#cb36-610" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(<span class="at">gen =</span> level,</span>
<span id="cb36-611"><a href="#cb36-611" aria-hidden="true" tabindex="-1"></a>            <span class="at">BLUP =</span> mu_manual <span class="sc">+</span> estimate,</span>
<span id="cb36-612"><a href="#cb36-612" aria-hidden="true" tabindex="-1"></a>            <span class="at">IC_inferior =</span> BLUP <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> std.error,</span>
<span id="cb36-613"><a href="#cb36-613" aria-hidden="true" tabindex="-1"></a>            <span class="at">IC_superior =</span> BLUP <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> std.error)</span>
<span id="cb36-614"><a href="#cb36-614" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-615"><a href="#cb36-615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-618"><a href="#cb36-618" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-619"><a href="#cb36-619" aria-hidden="true" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(BLUPs)</span>
<span id="cb36-620"><a href="#cb36-620" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-621"><a href="#cb36-621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-622"><a href="#cb36-622" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Comparação entre BLUE x BLUP</span></span>
<span id="cb36-623"><a href="#cb36-623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-626"><a href="#cb36-626" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-627"><a href="#cb36-627" aria-hidden="true" tabindex="-1"></a><span class="co"># Junta as estimativas dos dois modelos pelo identificador gen</span></span>
<span id="cb36-628"><a href="#cb36-628" aria-hidden="true" tabindex="-1"></a>comparacao <span class="ot">&lt;-</span> <span class="fu">full_join</span>(BLUEs, BLUPs, <span class="at">by =</span> <span class="st">"gen"</span>, <span class="at">suffix =</span> <span class="fu">c</span>(<span class="st">"_BLUE"</span>, <span class="st">"_BLUP"</span>))</span>
<span id="cb36-629"><a href="#cb36-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-630"><a href="#cb36-630" aria-hidden="true" tabindex="-1"></a><span class="co"># Reestrutura os dados para formato longo</span></span>
<span id="cb36-631"><a href="#cb36-631" aria-hidden="true" tabindex="-1"></a>comparacao_long <span class="ot">&lt;-</span> comparacao <span class="sc">%&gt;%</span></span>
<span id="cb36-632"><a href="#cb36-632" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb36-633"><a href="#cb36-633" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">c</span>(BLUE, BLUP),</span>
<span id="cb36-634"><a href="#cb36-634" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"Tipo"</span>,</span>
<span id="cb36-635"><a href="#cb36-635" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"Estimativa"</span></span>
<span id="cb36-636"><a href="#cb36-636" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb36-637"><a href="#cb36-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-638"><a href="#cb36-638" aria-hidden="true" tabindex="-1"></a><span class="co"># Ordena os genótipos pela média BLUP</span></span>
<span id="cb36-639"><a href="#cb36-639" aria-hidden="true" tabindex="-1"></a>ordem_gen <span class="ot">&lt;-</span> comparacao <span class="sc">%&gt;%</span></span>
<span id="cb36-640"><a href="#cb36-640" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(BLUP) <span class="sc">%&gt;%</span></span>
<span id="cb36-641"><a href="#cb36-641" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(gen)</span>
<span id="cb36-642"><a href="#cb36-642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-643"><a href="#cb36-643" aria-hidden="true" tabindex="-1"></a>comparacao_long<span class="sc">$</span>gen <span class="ot">&lt;-</span> <span class="fu">factor</span>(comparacao_long<span class="sc">$</span>gen, <span class="at">levels =</span> ordem_gen)</span>
<span id="cb36-644"><a href="#cb36-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-645"><a href="#cb36-645" aria-hidden="true" tabindex="-1"></a><span class="co"># Gera o gráfico comparativo</span></span>
<span id="cb36-646"><a href="#cb36-646" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(comparacao_long, <span class="fu">aes</span>(<span class="at">x =</span> gen, <span class="at">y =</span> Estimativa, <span class="at">fill =</span> Tipo)) <span class="sc">+</span></span>
<span id="cb36-647"><a href="#cb36-647" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.8</span>), <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb36-648"><a href="#cb36-648" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(</span>
<span id="cb36-649"><a href="#cb36-649" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymin =</span> <span class="fu">ifelse</span>(Tipo <span class="sc">==</span> <span class="st">"BLUE"</span>, IC_inferior_BLUE, IC_inferior_BLUP),</span>
<span id="cb36-650"><a href="#cb36-650" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymax =</span> <span class="fu">ifelse</span>(Tipo <span class="sc">==</span> <span class="st">"BLUE"</span>, IC_superior_BLUE, IC_superior_BLUP)</span>
<span id="cb36-651"><a href="#cb36-651" aria-hidden="true" tabindex="-1"></a>  ), <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.8</span>), <span class="at">width =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb36-652"><a href="#cb36-652" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb36-653"><a href="#cb36-653" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Comparação entre BLUEs e BLUPs por Genótipo"</span>,</span>
<span id="cb36-654"><a href="#cb36-654" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Genótipos"</span>,</span>
<span id="cb36-655"><a href="#cb36-655" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Estimativas (Produção Ajustada)"</span>,</span>
<span id="cb36-656"><a href="#cb36-656" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Modelo"</span></span>
<span id="cb36-657"><a href="#cb36-657" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb36-658"><a href="#cb36-658" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb36-659"><a href="#cb36-659" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb36-660"><a href="#cb36-660" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb36-661"><a href="#cb36-661" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>)</span>
<span id="cb36-662"><a href="#cb36-662" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb36-663"><a href="#cb36-663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-664"><a href="#cb36-664" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-665"><a href="#cb36-665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-666"><a href="#cb36-666" aria-hidden="true" tabindex="-1"></a>Neste gráfico, eu comparo as estimativas BLUEs e BLUPs obtidas para cada genótipo, representando a produtividade ajustada segundo as duas modelagens estatísticas.\</span>
<span id="cb36-667"><a href="#cb36-667" aria-hidden="true" tabindex="-1"></a>Os genótipos estão ordenados pela média BLUP, permitindo visualizar a progressão do desempenho genético predito.\</span>
<span id="cb36-668"><a href="#cb36-668" aria-hidden="true" tabindex="-1"></a>As barras vermelhas correspondem às BLUEs, provenientes do modelo com efeito fixo de genótipo, enquanto as barras azuis representam as BLUPs, obtidas do modelo com efeito aleatório de genótipo.</span>
<span id="cb36-669"><a href="#cb36-669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-670"><a href="#cb36-670" aria-hidden="true" tabindex="-1"></a>Ao observar o gráfico, percebo que as BLUEs apresentam maior amplitude e maior variação entre genótipos, refletindo diretamente os valores médios observados no experimento portanto, mais sensíveis à variação fenotípica e ao erro experimental.\</span>
<span id="cb36-671"><a href="#cb36-671" aria-hidden="true" tabindex="-1"></a>Já as BLUPs mostram comportamento mais suavizado e estável, pois incorporam a estrutura de variâncias do modelo misto, corrigindo a influência ambiental e priorizando a informação genética predita.</span>
<span id="cb36-672"><a href="#cb36-672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-673"><a href="#cb36-673" aria-hidden="true" tabindex="-1"></a>Essa diferença é esperada:</span>
<span id="cb36-674"><a href="#cb36-674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-675"><a href="#cb36-675" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Os BLUEs são estimativas descritivas, adequadas para comparar os genótipos avaliados dentro do experimento específico;</span>
<span id="cb36-676"><a href="#cb36-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-677"><a href="#cb36-677" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Os BLUPs são preditivas, permitindo inferir sobre o valor genético e realizar seleção com base em mérito genético.</span>
<span id="cb36-678"><a href="#cb36-678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-679"><a href="#cb36-679" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>O gráfico evidencia que, embora ambos os métodos estimem o mesmo fenômeno (produtividade ajustada), eles respondem a objetivos distintos:\</span>
<span id="cb36-680"><a href="#cb36-680" aria-hidden="true" tabindex="-1"></a>    as BLUEs detalham o comportamento experimental observado, enquanto as BLUPs fornecem uma visão mais robusta e generalizável essencial em contextos de melhoramento genético e seleção de linhagens promissoras.</span>
<span id="cb36-681"><a href="#cb36-681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-682"><a href="#cb36-682" aria-hidden="true" tabindex="-1"></a><span class="fu">#### BLUPs preditos</span></span>
<span id="cb36-683"><a href="#cb36-683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-684"><a href="#cb36-684" aria-hidden="true" tabindex="-1"></a>Nesta visualização, eu apresento as estimativas BLUPs (Best Linear Unbiased Predictors) para os genótipos avaliados, já ajustadas pelos efeitos ambientais e de blocos.\</span>
<span id="cb36-685"><a href="#cb36-685" aria-hidden="true" tabindex="-1"></a>Os genótipos estão ordenados do menor para o maior valor predito, permitindo observar claramente o gradiente de desempenho genético na população.</span>
<span id="cb36-686"><a href="#cb36-686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-687"><a href="#cb36-687" aria-hidden="true" tabindex="-1"></a>As barras representam a produtividade ajustada (kg/ha), enquanto as linhas verticais indicam os intervalos de confiança (95%), evidenciando a precisão das estimativas individuais.\</span>
<span id="cb36-688"><a href="#cb36-688" aria-hidden="true" tabindex="-1"></a>Genótipos com BLUPs mais altos estão acima da média geral (μ\muμ), sendo candidatos preferenciais à seleção, pois apresentam maior mérito genético estimado.\</span>
<span id="cb36-689"><a href="#cb36-689" aria-hidden="true" tabindex="-1"></a>Por outro lado, genótipos com BLUPs mais baixos situam-se abaixo da média, refletindo desempenho inferior após o ajuste dos efeitos ambientais.</span>
<span id="cb36-690"><a href="#cb36-690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-691"><a href="#cb36-691" aria-hidden="true" tabindex="-1"></a>Essa abordagem permite distinguir diferenças genéticas reais de variações de ambiente, fornecendo uma base mais sólida para decisões de seleção.\</span>
<span id="cb36-692"><a href="#cb36-692" aria-hidden="true" tabindex="-1"></a>Enquanto análises clássicas (como médias de tratamento) descrevem o desempenho observado, o modelo misto e os BLUPs revelam o potencial genético verdadeiro dos genótipos, tornando-se a principal ferramenta de seleção em programas modernos de melhoramento vegetal.</span>
<span id="cb36-693"><a href="#cb36-693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-696"><a href="#cb36-696" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-697"><a href="#cb36-697" aria-hidden="true" tabindex="-1"></a><span class="co"># Ordena os genótipos pela estimativa BLUP</span></span>
<span id="cb36-698"><a href="#cb36-698" aria-hidden="true" tabindex="-1"></a>BLUPs <span class="ot">&lt;-</span> BLUPs <span class="sc">%&gt;%</span></span>
<span id="cb36-699"><a href="#cb36-699" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(BLUP) <span class="sc">%&gt;%</span></span>
<span id="cb36-700"><a href="#cb36-700" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gen =</span> <span class="fu">factor</span>(gen, <span class="at">levels =</span> gen))</span>
<span id="cb36-701"><a href="#cb36-701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-702"><a href="#cb36-702" aria-hidden="true" tabindex="-1"></a><span class="co"># Gera o gráfico</span></span>
<span id="cb36-703"><a href="#cb36-703" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(BLUPs, <span class="fu">aes</span>(<span class="at">x =</span> gen, <span class="at">y =</span> BLUP)) <span class="sc">+</span></span>
<span id="cb36-704"><a href="#cb36-704" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"#2ca9b7"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb36-705"><a href="#cb36-705" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> IC_inferior, <span class="at">ymax =</span> IC_superior), <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb36-706"><a href="#cb36-706" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb36-707"><a href="#cb36-707" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Estimativas BLUPs por Genótipo"</span>,</span>
<span id="cb36-708"><a href="#cb36-708" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Genótipos"</span>,</span>
<span id="cb36-709"><a href="#cb36-709" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Produtividade Ajustada (kg/ha)"</span></span>
<span id="cb36-710"><a href="#cb36-710" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb36-711"><a href="#cb36-711" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb36-712"><a href="#cb36-712" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb36-713"><a href="#cb36-713" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb36-714"><a href="#cb36-714" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>)</span>
<span id="cb36-715"><a href="#cb36-715" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb36-716"><a href="#cb36-716" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-717"><a href="#cb36-717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-718"><a href="#cb36-718" aria-hidden="true" tabindex="-1"></a><span class="fu">## Herdabilidade</span></span>
<span id="cb36-719"><a href="#cb36-719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-720"><a href="#cb36-720" aria-hidden="true" tabindex="-1"></a>Nesta etapa, eu estimei a herdabilidade em sentido amplo (h2h\^2h2) com base nas variâncias obtidas do modelo misto com genótipos como efeito aleatório.</span>
<span id="cb36-721"><a href="#cb36-721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-724"><a href="#cb36-724" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-725"><a href="#cb36-725" aria-hidden="true" tabindex="-1"></a>vcomps <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">VarCorr</span>(mod.rg))</span>
<span id="cb36-726"><a href="#cb36-726" aria-hidden="true" tabindex="-1"></a>vc.g <span class="ot">&lt;-</span> vcomps[vcomps<span class="sc">$</span>grp <span class="sc">==</span> <span class="st">"gen"</span>, <span class="st">"vcov"</span>]</span>
<span id="cb36-727"><a href="#cb36-727" aria-hidden="true" tabindex="-1"></a>vc.e <span class="ot">&lt;-</span> vcomps[vcomps<span class="sc">$</span>grp <span class="sc">==</span> <span class="st">"Residual"</span>, <span class="st">"vcov"</span>]</span>
<span id="cb36-728"><a href="#cb36-728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-729"><a href="#cb36-729" aria-hidden="true" tabindex="-1"></a>nreps <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb36-730"><a href="#cb36-730" aria-hidden="true" tabindex="-1"></a>hc <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(vc.g <span class="sc">/</span> (vc.g <span class="sc">+</span> vc.e <span class="sc">/</span> nreps))  <span class="co"># &lt;- garante tipo numérico</span></span>
<span id="cb36-731"><a href="#cb36-731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-732"><a href="#cb36-732" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"Herdabilidade estimada: {round(hc, 3)}"</span>))</span>
<span id="cb36-733"><a href="#cb36-733" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-734"><a href="#cb36-734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-735"><a href="#cb36-735" aria-hidden="true" tabindex="-1"></a>Utilizei a decomposição da variância fornecida pela função <span class="in">`VarCorr()`</span>, extraindo a variância genética (σg2\sigma\^2_gσg2) associada ao efeito de genótipo e a variância residual (σe2\sigma\^2_eσe2​).\</span>
<span id="cb36-736"><a href="#cb36-736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-737"><a href="#cb36-737" aria-hidden="true" tabindex="-1"></a>A expressão utilizada foi:</span>
<span id="cb36-738"><a href="#cb36-738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-739"><a href="#cb36-739" aria-hidden="true" tabindex="-1"></a>$h2=σg2​+rσe2​​σg2​​$</span>
<span id="cb36-740"><a href="#cb36-740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-741"><a href="#cb36-741" aria-hidden="true" tabindex="-1"></a>onde rrr representa o número de repetições no delineamento (neste caso, r=3r = 3r=3).</span>
<span id="cb36-742"><a href="#cb36-742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-743"><a href="#cb36-743" aria-hidden="true" tabindex="-1"></a>O cálculo foi implementado manualmente a partir das variâncias estimadas pelo modelo (<span class="in">`vc.g`</span> e <span class="in">`vc.e`</span>), permitindo avaliar quanto da variação total observada na produtividade é de origem genética.\</span>
<span id="cb36-744"><a href="#cb36-744" aria-hidden="true" tabindex="-1"></a>Valores mais próximos de 1 indicam alta herdabilidade, ou seja, a maior parte da variação entre os genótipos é genética e pode ser transmitida às próximas gerações; valores baixos, ao contrário, sugerem forte influência ambiental e menor eficiência da seleção fenotípica.</span>
<span id="cb36-745"><a href="#cb36-745" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-746"><a href="#cb36-746" aria-hidden="true" tabindex="-1"></a>Essa estimativa é fundamental para o programa de melhoramento, pois determina o potencial de ganho genético esperado e valida a eficiência do delineamento experimental e da modelagem mista aplicada.</span>
<span id="cb36-747"><a href="#cb36-747" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-748"><a href="#cb36-748" aria-hidden="true" tabindex="-1"></a><span class="fu">## Agrupamento hierárquico - UPGMA</span></span>
<span id="cb36-749"><a href="#cb36-749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-750"><a href="#cb36-750" aria-hidden="true" tabindex="-1"></a>Nesta etapa, eu realizei o agrupamento hierárquico dos genótipos com base nas estimativas BLUPs de produtividade, utilizando o método UPGMA (Unweighted Pair Group Method with Arithmetic Mean) e a distância euclidiana como medida de dissimilaridade.</span>
<span id="cb36-751"><a href="#cb36-751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-752"><a href="#cb36-752" aria-hidden="true" tabindex="-1"></a>O objetivo desse procedimento é avaliar o grau de similaridade genética entre os genótipos e identificar possíveis padrões de agrupamento entre materiais com desempenho produtivo semelhante.\</span>
<span id="cb36-753"><a href="#cb36-753" aria-hidden="true" tabindex="-1"></a>Genótipos próximos no dendrograma apresentam valores genéticos preditos semelhantes, enquanto aqueles separados por maiores distâncias euclidianas diferem mais em seu potencial produtivo.</span>
<span id="cb36-754"><a href="#cb36-754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-755"><a href="#cb36-755" aria-hidden="true" tabindex="-1"></a>Neste resultado, observo a formação de três grupos principais, o que indica a presença de variabilidade genética útil à seleção dentro da população avaliada.\</span>
<span id="cb36-756"><a href="#cb36-756" aria-hidden="true" tabindex="-1"></a>Essa estrutura de agrupamento pode ser explorada para selecionar genótipos contrastantes, direcionar cruzamentos futuros ou representar a diversidade entre linhagens avançadas.</span>
<span id="cb36-757"><a href="#cb36-757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-758"><a href="#cb36-758" aria-hidden="true" tabindex="-1"></a>O método UPGMA, ao utilizar as estimativas BLUPs, garante que o agrupamento seja baseado na performance genética ajustada e não apenas em médias fenotípicas —, o que torna a análise mais robusta e alinhada ao propósito do melhoramento genético quantitativo.</span>
<span id="cb36-759"><a href="#cb36-759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-762"><a href="#cb36-762" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-763"><a href="#cb36-763" aria-hidden="true" tabindex="-1"></a>blup_values <span class="ot">&lt;-</span> BLUPs<span class="sc">$</span>BLUP</span>
<span id="cb36-764"><a href="#cb36-764" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(blup_values) <span class="ot">&lt;-</span> BLUPs<span class="sc">$</span>gen</span>
<span id="cb36-765"><a href="#cb36-765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-766"><a href="#cb36-766" aria-hidden="true" tabindex="-1"></a>dist_blups <span class="ot">&lt;-</span> <span class="fu">dist</span>(blup_values, <span class="at">method =</span> <span class="st">"euclidean"</span>)</span>
<span id="cb36-767"><a href="#cb36-767" aria-hidden="true" tabindex="-1"></a>hc <span class="ot">&lt;-</span> <span class="fu">hclust</span>(dist_blups, <span class="at">method =</span> <span class="st">"average"</span>)</span>
<span id="cb36-768"><a href="#cb36-768" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-769"><a href="#cb36-769" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(hc, <span class="at">main =</span> <span class="st">"Dendrograma UPGMA - BLUPs"</span>,</span>
<span id="cb36-770"><a href="#cb36-770" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Genótipos"</span>, <span class="at">ylab =</span> <span class="st">"Distância Euclidiana"</span>)</span>
<span id="cb36-771"><a href="#cb36-771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-772"><a href="#cb36-772" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-773"><a href="#cb36-773" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-774"><a href="#cb36-774" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-775"><a href="#cb36-775" aria-hidden="true" tabindex="-1"></a><span class="fu">### Correlção cofenética</span></span>
<span id="cb36-776"><a href="#cb36-776" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-777"><a href="#cb36-777" aria-hidden="true" tabindex="-1"></a>Após a geração do dendrograma, **eu avaliei a consistência do agrupamento UPGMA** por meio da **correlação cofenética**, que mede o grau de concordância entre a **matriz original de distâncias genéticas** e a **matriz de distâncias representada pelo dendrograma**.</span>
<span id="cb36-778"><a href="#cb36-778" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-779"><a href="#cb36-779" aria-hidden="true" tabindex="-1"></a>A correlação cofenética obtida foi de **0,8943**, o que indica **excelente ajuste** entre os dados originais e a representação hierárquica produzida pelo método UPGMA.\</span>
<span id="cb36-780"><a href="#cb36-780" aria-hidden="true" tabindex="-1"></a>Valores próximos de 1 refletem **alta fidelidade** do dendrograma em representar as relações de similaridade entre os genótipos, garantindo **confiabilidade na estrutura de agrupamento** observada.</span>
<span id="cb36-781"><a href="#cb36-781" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-782"><a href="#cb36-782" aria-hidden="true" tabindex="-1"></a>Esse resultado confirma que o método de agrupamento adotado foi **estatisticamente adequado** para os dados de BLUPs, permitindo interpretar os grupos formados como **indicativos reais de proximidade genética e desempenho produtivo semelhante**.\</span>
<span id="cb36-783"><a href="#cb36-783" aria-hidden="true" tabindex="-1"></a>Assim, a análise de agrupamento, validada pela alta correlação cofenética, **reforça a robustez da modelagem mista e a diversidade genética presente entre os genótipos avaliados**.</span>
<span id="cb36-784"><a href="#cb36-784" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-787"><a href="#cb36-787" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-788"><a href="#cb36-788" aria-hidden="true" tabindex="-1"></a><span class="co"># Correlação cofenética</span></span>
<span id="cb36-789"><a href="#cb36-789" aria-hidden="true" tabindex="-1"></a>cophenetic_dist <span class="ot">&lt;-</span> <span class="fu">cophenetic</span>(hc)</span>
<span id="cb36-790"><a href="#cb36-790" aria-hidden="true" tabindex="-1"></a>correlation_cophenetic <span class="ot">&lt;-</span> <span class="fu">cor</span>(dist_blups, cophenetic_dist)</span>
<span id="cb36-791"><a href="#cb36-791" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Correlação cofenética:"</span>, <span class="fu">round</span>(correlation_cophenetic, <span class="dv">4</span>)))</span>
<span id="cb36-792"><a href="#cb36-792" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-793"><a href="#cb36-793" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-794"><a href="#cb36-794" aria-hidden="true" tabindex="-1"></a><span class="fu">## Considerações finais</span></span>
<span id="cb36-795"><a href="#cb36-795" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-796"><a href="#cb36-796" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb36-797"><a href="#cb36-797" aria-hidden="true" tabindex="-1"></a><span class="fu">## Pipeline</span></span>
<span id="cb36-798"><a href="#cb36-798" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-799"><a href="#cb36-799" aria-hidden="true" tabindex="-1"></a>O pipeline desenvolvido neste portfólio consolida um **fluxo completo de análise experimental reprodutível**, desde a **importação automatizada dos dados via API do GitHub** até a **modelagem estatística com delineamento alpha-lattice**, integrando visualizações, estimativas genéticas e validação por agrupamento hierárquico.</span>
<span id="cb36-800"><a href="#cb36-800" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-801"><a href="#cb36-801" aria-hidden="true" tabindex="-1"></a><span class="fu">## Modelagem</span></span>
<span id="cb36-802"><a href="#cb36-802" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-803"><a href="#cb36-803" aria-hidden="true" tabindex="-1"></a>O projeto demonstrou como o uso de **modelos mistos (REML/BLUP)** amplia a robustez da inferência, separando de forma eficiente os efeitos genéticos e ambientais uma abordagem essencial em experimentos agrícolas com blocos incompletos e grande variabilidade fenotípica. O cálculo da herdabilidade confirmou a **expressiva contribuição genética** para a produtividade, e o agrupamento UPGMA, validado pela **alta correlação cofenética (0,8943)**, evidenciou **consistência estrutural e diversidade genética relevante** na população avaliada.</span>
<span id="cb36-804"><a href="#cb36-804" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-805"><a href="#cb36-805" aria-hidden="true" tabindex="-1"></a>Mais do que resultados estatísticos, o estudo reforça uma metodologia moderna de pesquisa: **automatizada, reprodutível e integrada**. A função <span class="in">`coleta_dados_github()`</span> elimina barreiras operacionais, e o uso de pacotes como <span class="in">`{lme4}`</span>, <span class="in">`{emmeans}`</span>, <span class="in">`{metan}`</span> e <span class="in">`{tidyverse}`</span> cria uma base sólida para análises avançadas e documentação transparente.</span>
<span id="cb36-806"><a href="#cb36-806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-807"><a href="#cb36-807" aria-hidden="true" tabindex="-1"></a><span class="fu">## Recursos recomendados</span></span>
<span id="cb36-808"><a href="#cb36-808" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-809"><a href="#cb36-809" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Pacote <span class="sc">\|</span> Recurso <span class="pp">|</span> Descrição <span class="pp">|</span> Link <span class="pp">|</span></span>
<span id="cb36-810"><a href="#cb36-810" aria-hidden="true" tabindex="-1"></a><span class="pp">|------------------------|------------------------|------------------------|</span></span>
<span id="cb36-811"><a href="#cb36-811" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **{httr2}** <span class="pp">|</span> Pacote moderno para consumo de APIs REST no R. Permite autenticação, controle de headers e tratamento seguro de respostas HTTP. <span class="pp">|</span> <span class="co">[</span><span class="ot">httr2.r-lib.org</span><span class="co">](https://httr2.r-lib.org/articles/wrapping-apis.html)</span> <span class="pp">|</span></span>
<span id="cb36-812"><a href="#cb36-812" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **GitHub API (REST)** <span class="pp">|</span> Interface oficial para acessar dados do GitHub (arquivos, repositórios, commits, issues) via requisições autenticadas. <span class="pp">|</span> <span class="co">[</span><span class="ot">docs.github.com/rest</span><span class="co">](https://docs.github.com/rest/guides/getting-started-with-the-rest-api)</span> <span class="pp">|</span></span>
<span id="cb36-813"><a href="#cb36-813" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **{gh}** <span class="pp">|</span> Cliente R oficial para a API do GitHub. Facilita automações e integrações entre R e repositórios GitHub. <span class="pp">|</span> <span class="co">[</span><span class="ot">r-lib.github.io/gh</span><span class="co">](https://r-lib.github.io/gh/)</span> <span class="pp">|</span></span>
<span id="cb36-814"><a href="#cb36-814" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **{lme4}** <span class="pp">|</span> Base para ajuste de modelos lineares mistos (efeitos fixos e aleatórios) fundamental para estimar BLUPs. <span class="pp">|</span> <span class="co">[</span><span class="ot">cran.r-project.org/lme4</span><span class="co">](https://cran.r-project.org/package=lme4)</span> <span class="pp">|</span></span>
<span id="cb36-815"><a href="#cb36-815" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **{emmeans}** <span class="pp">|</span> Calcula médias ajustadas (BLUEs), intervalos de confiança e comparações múltiplas. <span class="pp">|</span> <span class="co">[</span><span class="ot">emmeans.r-forge.r-project.org</span><span class="co">](https://emmeans.r-forge.r-project.org/)</span> <span class="pp">|</span></span>
<span id="cb36-816"><a href="#cb36-816" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **{metan}** <span class="pp">|</span> Ferramenta completa para análises agronômicas e genéticas (BLUP, MGIDI, herdabilidade, PCA, correlação). <span class="pp">|</span> <span class="co">[</span><span class="ot">cran.r-project.org/metan</span><span class="co">](https://cran.r-project.org/package=metan)</span> <span class="pp">|</span></span>
<span id="cb36-817"><a href="#cb36-817" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **{tidyverse}** <span class="pp">|</span> Coleção de pacotes para manipulação, visualização e comunicação de dados de forma coerente e reprodutível. <span class="pp">|</span> <span class="co">[</span><span class="ot">tidyverse.org</span><span class="co">](https://www.tidyverse.org/)</span> <span class="pp">|</span></span>
<span id="cb36-818"><a href="#cb36-818" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **Quarto** <span class="pp">|</span> Sistema de publicação científica integrado ao RStudio, ideal para relatórios dinâmicos, artigos e portfólios. <span class="pp">|</span> <span class="co">[</span><span class="ot">quarto.org</span><span class="co">](https://quarto.org/)</span> <span class="pp">|</span></span>
<span id="cb36-819"><a href="#cb36-819" aria-hidden="true" tabindex="-1"></a>:::</span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




<script src="modelagem_experimental_explicacoes_files/libs/quarto-html/zenscroll-min.js"></script>
</body></html>